<analysis>
The trajectory documents a highly interactive, German-language development process for the ShiftMatch application. The user provides explicit, often code-level instructions for UI/UX enhancements, major refactoring, and bug fixes. The work spans the full stack: a FastAPI/MongoDB backend and a React Native/Expo frontend.

Key development threads include:
1.  **UI/UX Overhaul**: Multiple screens were iteratively redesigned based on specific user prompts. This includes  and , where the layout was changed from simple lists to modern, two-column grids or single-column cards to achieve a more luftig (airy) and techy aesthetic.
2.  **Taxonomy Migration**: A significant, complex migration of the core data model was performed. The taxonomy structure, which defines job categories, subcategories, and qualifications, was completely refactored. This involved changing the data structure in , updating all related frontend components (wizards, profile editor), and modifying backend models, validation logic (), and the core matching algorithm (). This migration involved several debugging cycles to handle mismatches between frontend and backend data formats (e.g.,  vs. ,  vs. ).
3.  **Live Debugging**: Several critical issues were diagnosed and resolved in real-time. This included a login failure caused by a stopped backend service and an incorrect password, and multiple  errors during profile saves, which were traced back to validation failures from the taxonomy migration.
4.  **New Feature Implementation**: The most recent work involves adding a new feature: displaying an unread message count on chat buttons within the Matches screen.

The user's primary language is German. All future responses MUST be in German.
</analysis>

<product_requirements>
The ShiftMatch application is a German-language, two-sided job marketplace connecting Employers (Auftraggeber) and Workers (Auftragnehmer).

**Core Functionality:**
*   **Worker Profiling**: Workers create a profile by selecting their job categories (e.g., Sicherheit, Gastronomie), specific activities/subcategories (e.g., Doorman, Kellner), and optional qualifications (e.g., Sachkunde 34a). Workers can select multiple categories.
*   **Job Creation**: Employers post jobs, specifying a single category, a single subcategory, and a list of required qualifications.
*   **Matching**: The backend matches workers to jobs based on matching category, the worker having the job's required subcategory, the worker possessing all of the job's required qualifications, and being within a specified geographic radius. A fallback allows old jobs without subcategories to still be matched.
*   **Chat**: Once a match is established, employers and workers can communicate via an in-app chat.
*   **Unread Message Notifications**: A new feature is being implemented to display a count of unread messages for each specific chat on the user's Matches list, enhancing user engagement by signaling new activity.
</product_requirements>

<key_technical_concepts>
- **Backend**: FastAPI (Python), MongoDB database. Logic is primarily in  with a dedicated .
- **Frontend**: React Native with Expo, using  for file-based routing.
- **Data Modeling**: Pydantic models for API validation on the backend. A central  file (with different structures for frontend and backend) defines job roles.
- **State Management**: React Context () for the multi-step profile creation wizard.
- **Chat Implementation**: Chat messages are stored in MongoDB with a  flag to track seen status.
</key_technical_concepts>

<code_architecture>
The project is a monorepo with a  (Expo/React Native) and  (FastAPI/MongoDB).



-   ****: The main backend file containing most API endpoints, Pydantic models, and database interactions. It was modified to add new models for  and , update validation logic to be less strict to resolve  errors, and add a new endpoint . Alias logic was also added to handle discrepancies between frontend (English) and backend (German) category keys.

-   ****: Contains the core job-matching algorithm. It was significantly updated to implement the new matching rules: must match , , and all . A fallback was added to ensure backward compatibility with old jobs that lack  or  fields.

-   ** & **: These files define the app's job categories, subcategories, and qualifications. They were the center of a major refactoring and debugging effort. The final state is that the frontend uses a version with English keys and  arrays (), while the backend uses a version with German keys and  arrays. This discrepancy caused validation errors that were later resolved.

-   ****: A large component for workers to edit their entire profile. It was heavily modified multiple times: first for UI redesigns (implementing a 2-column grid for categories), then for the major taxonomy migration (changing state from single to multiple categories, updating save logic), and finally for debugging save failures.

-   ****: The files in this directory (, , ) were all rewritten to accommodate the new taxonomy logic.  now handles selecting one or more categories and their subcategories.  handles selecting qualifications based on the chosen categories.  sends the new data structure to the backend.

-   ****: The React context for the profile wizard. It was updated to store the new data structure: , , .

-   ****: The employer's job creation form. It was updated to allow employers to select a  and  after choosing a category, matching the new job model.

-   ****: The screen where workers see their active job matches. It is currently being modified to display a count of unread chat messages. A state  and a function  have been added to fetch data from the new backend endpoint.

-   ****: A component used by employers to view a worker's profile. It was updated to display the worker's selected  (TÃ¤tigkeiten) and . An incorrect  import was also fixed.
</code_architecture>

<pending_tasks>
- Complete the UI implementation for the unread chat message count on .
- Replicate the unread chat message count feature on the employer side ().
- Address an old, unresolved bug regarding incorrect geocoding of Poststr. 7.
</pending_tasks>

<current_work>
The immediate task is the implementation of a feature to show the number of unread messages for each chat on the Matches screen.

**Work Completed So Far:**
1.  **Backend**: A new endpoint, , was created in . It queries the  collection in MongoDB and returns the count of messages where  is  and the sender is the other party in the chat.
2.  **Frontend (Worker Side)**: In , the following logic was added:
    *   A new state variable was created to hold the unread counts for each application ID:
        
    *   A function, , was implemented to iterate through the loaded matches, call the new backend endpoint for each application ID, and populate the  state.
    *   The  function is now called immediately after the  function successfully fetches the match data.

The backend work is complete, and the frontend logic for fetching the data is in place. The next step is to use this data in the UI.
</current_work>

<optional_next_step>
Modify the JSX in  to display the unread message count from the  state on the Zum Chat button for each match.
</optional_next_step>
