{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../config","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":36,"index":185}}],"key":"pHqFJJBAh3HI9ZCkK8fFRwPv3x0=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _config = require(_dependencyMap[2], \"../config\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)({\n    user: null,\n    token: null,\n    loading: true,\n    login: async () => false,\n    signUp: async () => false,\n    signOut: async () => {}\n  });\n  function AuthProvider({\n    children\n  }) {\n    const [token, setToken] = (0, _react.useState)(null);\n    const [user, setUser] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    async function loadSession() {\n      const storedToken = await AsyncStorage.default.getItem(\"token\");\n      if (storedToken) {\n        setToken(storedToken);\n        const me = await fetch(`${_config.API_URL}/auth/me`, {\n          headers: {\n            Authorization: `Bearer ${storedToken}`\n          }\n        });\n        const data = await me.json();\n        // Backend gibt userId zurück, aber Frontend erwartet id\n        const user = {\n          ...data,\n          id: data.userId\n        };\n        setUser(user);\n      }\n      setLoading(false);\n    }\n    (0, _react.useEffect)(() => {\n      loadSession();\n    }, []);\n    async function login(email, password) {\n      const res = await fetch(`${_config.API_URL}/auth/login`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          email,\n          password\n        })\n      });\n      if (!res.ok) return false;\n      const data = await res.json();\n      await AsyncStorage.default.setItem(\"token\", data.token);\n      setToken(data.token);\n      const me = await fetch(`${_config.API_URL}/auth/me`, {\n        headers: {\n          Authorization: `Bearer ${data.token}`\n        }\n      });\n      const userData = await me.json();\n\n      // Backend gibt userId zurück, aber Frontend erwartet id\n      const user = {\n        ...userData,\n        id: userData.userId\n      };\n      setUser(user);\n      return true;\n    }\n    async function signUp(email, password, role) {\n      const res = await fetch(`${_config.API_URL}/auth/signup`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          email,\n          password,\n          role\n        })\n      });\n      if (!res.ok) {\n        const error = await res.json();\n        throw new Error(error.detail || \"Registrierung fehlgeschlagen\");\n      }\n      const data = await res.json();\n      await AsyncStorage.default.setItem(\"token\", data.token);\n      setToken(data.token);\n      const me = await fetch(`${_config.API_URL}/auth/me`, {\n        headers: {\n          Authorization: `Bearer ${data.token}`\n        }\n      });\n      const userData = await me.json();\n\n      // Backend gibt userId zurück, aber Frontend erwartet id\n      const user = {\n        ...userData,\n        id: userData.userId\n      };\n      setUser(user);\n      return true;\n    }\n    async function signOut() {\n      await AsyncStorage.default.removeItem(\"token\");\n      setUser(null);\n      setToken(null);\n    }\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        token,\n        loading,\n        login,\n        signUp,\n        signOut\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 5\n    }, this);\n  }\n  function useAuth() {\n    return (0, _react.useContext)(AuthContext);\n  }\n});","lineCount":144,"map":[[13,2,23,0,"exports"],[13,9,23,0],[13,10,23,0,"AuthProvider"],[13,22,23,0],[13,25,23,0,"AuthProvider"],[13,37,23,0],[14,2,113,0,"exports"],[14,9,113,0],[14,10,113,0,"useAuth"],[14,17,113,0],[14,20,113,0,"useAuth"],[14,27,113,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,3,0],[18,6,3,0,"_config"],[18,13,3,0],[18,16,3,0,"require"],[18,23,3,0],[18,24,3,0,"_dependencyMap"],[18,38,3,0],[19,2,3,36],[19,6,3,36,"_reactJsxDevRuntime"],[19,25,3,36],[19,28,3,36,"require"],[19,35,3,36],[19,36,3,36,"_dependencyMap"],[19,50,3,36],[20,2,14,0],[20,8,14,6,"AuthContext"],[20,19,14,17],[20,35,14,20],[20,39,14,20,"createContext"],[20,45,14,33],[20,46,14,33,"createContext"],[20,59,14,33],[20,61,14,52],[21,4,15,2,"user"],[21,8,15,6],[21,10,15,8],[21,14,15,12],[22,4,16,2,"token"],[22,9,16,7],[22,11,16,9],[22,15,16,13],[23,4,17,2,"loading"],[23,11,17,9],[23,13,17,11],[23,17,17,15],[24,4,18,2,"login"],[24,9,18,7],[24,11,18,9],[24,17,18,9,"login"],[24,18,18,9],[24,23,18,21],[24,28,18,26],[25,4,19,2,"signUp"],[25,10,19,8],[25,12,19,10],[25,18,19,10,"signUp"],[25,19,19,10],[25,24,19,22],[25,29,19,27],[26,4,20,2,"signOut"],[26,11,20,9],[26,13,20,11],[26,19,20,11,"signOut"],[26,20,20,11],[26,25,20,23],[26,26,20,24],[27,2,21,0],[27,3,21,1],[27,4,21,2],[28,2,23,7],[28,11,23,16,"AuthProvider"],[28,23,23,28,"AuthProvider"],[28,24,23,29],[29,4,23,31,"children"],[30,2,23,40],[30,3,23,41],[30,5,23,43],[31,4,24,2],[31,10,24,8],[31,11,24,9,"token"],[31,16,24,14],[31,18,24,16,"setToken"],[31,26,24,24],[31,27,24,25],[31,30,24,28],[31,34,24,28,"useState"],[31,40,24,36],[31,41,24,36,"useState"],[31,49,24,36],[31,51,24,52],[31,55,24,56],[31,56,24,57],[32,4,25,2],[32,10,25,8],[32,11,25,9,"user"],[32,15,25,13],[32,17,25,15,"setUser"],[32,24,25,22],[32,25,25,23],[32,28,25,26],[32,32,25,26,"useState"],[32,38,25,34],[32,39,25,34,"useState"],[32,47,25,34],[32,49,25,40],[32,53,25,44],[32,54,25,45],[33,4,26,2],[33,10,26,8],[33,11,26,9,"loading"],[33,18,26,16],[33,20,26,18,"setLoading"],[33,30,26,28],[33,31,26,29],[33,34,26,32],[33,38,26,32,"useState"],[33,44,26,40],[33,45,26,40,"useState"],[33,53,26,40],[33,55,26,41],[33,59,26,45],[33,60,26,46],[34,4,28,2],[34,19,28,17,"loadSession"],[34,30,28,28,"loadSession"],[34,31,28,28],[34,33,28,31],[35,6,29,4],[35,12,29,10,"storedToken"],[35,23,29,21],[35,26,29,24],[35,32,29,30,"AsyncStorage"],[35,44,29,42],[35,45,29,42,"default"],[35,52,29,42],[35,53,29,43,"getItem"],[35,60,29,50],[35,61,29,51],[35,68,29,58],[35,69,29,59],[36,6,31,4],[36,10,31,8,"storedToken"],[36,21,31,19],[36,23,31,21],[37,8,32,6,"setToken"],[37,16,32,14],[37,17,32,15,"storedToken"],[37,28,32,26],[37,29,32,27],[38,8,33,6],[38,14,33,12,"me"],[38,16,33,14],[38,19,33,17],[38,25,33,23,"fetch"],[38,30,33,28],[38,31,33,29],[38,34,33,32,"API_URL"],[38,41,33,39],[38,42,33,39,"API_URL"],[38,49,33,39],[38,59,33,49],[38,61,33,51],[39,10,34,8,"headers"],[39,17,34,15],[39,19,34,17],[40,12,34,19,"Authorization"],[40,25,34,32],[40,27,34,34],[40,37,34,44,"storedToken"],[40,48,34,55],[41,10,34,58],[42,8,35,6],[42,9,35,7],[42,10,35,8],[43,8,36,6],[43,14,36,12,"data"],[43,18,36,16],[43,21,36,19],[43,27,36,25,"me"],[43,29,36,27],[43,30,36,28,"json"],[43,34,36,32],[43,35,36,33],[43,36,36,34],[44,8,37,6],[45,8,38,6],[45,14,38,12,"user"],[45,18,38,16],[45,21,38,19],[46,10,38,21],[46,13,38,24,"data"],[46,17,38,28],[47,10,38,30,"id"],[47,12,38,32],[47,14,38,34,"data"],[47,18,38,38],[47,19,38,39,"userId"],[48,8,38,46],[48,9,38,47],[49,8,39,6,"setUser"],[49,15,39,13],[49,16,39,14,"user"],[49,20,39,18],[49,21,39,19],[50,6,40,4],[51,6,42,4,"setLoading"],[51,16,42,14],[51,17,42,15],[51,22,42,20],[51,23,42,21],[52,4,43,2],[53,4,45,2],[53,8,45,2,"useEffect"],[53,14,45,11],[53,15,45,11,"useEffect"],[53,24,45,11],[53,26,45,12],[53,32,45,18],[54,6,46,4,"loadSession"],[54,17,46,15],[54,18,46,16],[54,19,46,17],[55,4,47,2],[55,5,47,3],[55,7,47,5],[55,9,47,7],[55,10,47,8],[56,4,49,2],[56,19,49,17,"login"],[56,24,49,22,"login"],[56,25,49,23,"email"],[56,30,49,36],[56,32,49,38,"password"],[56,40,49,54],[56,42,49,56],[57,6,50,4],[57,12,50,10,"res"],[57,15,50,13],[57,18,50,16],[57,24,50,22,"fetch"],[57,29,50,27],[57,30,50,28],[57,33,50,31,"API_URL"],[57,40,50,38],[57,41,50,38,"API_URL"],[57,48,50,38],[57,61,50,51],[57,63,50,53],[58,8,51,6,"method"],[58,14,51,12],[58,16,51,14],[58,22,51,20],[59,8,52,6,"headers"],[59,15,52,13],[59,17,52,15],[60,10,52,17],[60,24,52,31],[60,26,52,33],[61,8,52,52],[61,9,52,53],[62,8,53,6,"body"],[62,12,53,10],[62,14,53,12,"JSON"],[62,18,53,16],[62,19,53,17,"stringify"],[62,28,53,26],[62,29,53,27],[63,10,53,29,"email"],[63,15,53,34],[64,10,53,36,"password"],[65,8,53,45],[65,9,53,46],[66,6,54,4],[66,7,54,5],[66,8,54,6],[67,6,56,4],[67,10,56,8],[67,11,56,9,"res"],[67,14,56,12],[67,15,56,13,"ok"],[67,17,56,15],[67,19,56,17],[67,26,56,24],[67,31,56,29],[68,6,58,4],[68,12,58,10,"data"],[68,16,58,14],[68,19,58,17],[68,25,58,23,"res"],[68,28,58,26],[68,29,58,27,"json"],[68,33,58,31],[68,34,58,32],[68,35,58,33],[69,6,59,4],[69,12,59,10,"AsyncStorage"],[69,24,59,22],[69,25,59,22,"default"],[69,32,59,22],[69,33,59,23,"setItem"],[69,40,59,30],[69,41,59,31],[69,48,59,38],[69,50,59,40,"data"],[69,54,59,44],[69,55,59,45,"token"],[69,60,59,50],[69,61,59,51],[70,6,60,4,"setToken"],[70,14,60,12],[70,15,60,13,"data"],[70,19,60,17],[70,20,60,18,"token"],[70,25,60,23],[70,26,60,24],[71,6,62,4],[71,12,62,10,"me"],[71,14,62,12],[71,17,62,15],[71,23,62,21,"fetch"],[71,28,62,26],[71,29,62,27],[71,32,62,30,"API_URL"],[71,39,62,37],[71,40,62,37,"API_URL"],[71,47,62,37],[71,57,62,47],[71,59,62,49],[72,8,63,6,"headers"],[72,15,63,13],[72,17,63,15],[73,10,63,17,"Authorization"],[73,23,63,30],[73,25,63,32],[73,35,63,42,"data"],[73,39,63,46],[73,40,63,47,"token"],[73,45,63,52],[74,8,63,55],[75,6,64,4],[75,7,64,5],[75,8,64,6],[76,6,65,4],[76,12,65,10,"userData"],[76,20,65,18],[76,23,65,21],[76,29,65,27,"me"],[76,31,65,29],[76,32,65,30,"json"],[76,36,65,34],[76,37,65,35],[76,38,65,36],[78,6,67,4],[79,6,68,4],[79,12,68,10,"user"],[79,16,68,14],[79,19,68,17],[80,8,68,19],[80,11,68,22,"userData"],[80,19,68,30],[81,8,68,32,"id"],[81,10,68,34],[81,12,68,36,"userData"],[81,20,68,44],[81,21,68,45,"userId"],[82,6,68,52],[82,7,68,53],[83,6,69,4,"setUser"],[83,13,69,11],[83,14,69,12,"user"],[83,18,69,16],[83,19,69,17],[84,6,70,4],[84,13,70,11],[84,17,70,15],[85,4,71,2],[86,4,73,2],[86,19,73,17,"signUp"],[86,25,73,23,"signUp"],[86,26,73,24,"email"],[86,31,73,37],[86,33,73,39,"password"],[86,41,73,55],[86,43,73,57,"role"],[86,47,73,69],[86,49,73,71],[87,6,74,4],[87,12,74,10,"res"],[87,15,74,13],[87,18,74,16],[87,24,74,22,"fetch"],[87,29,74,27],[87,30,74,28],[87,33,74,31,"API_URL"],[87,40,74,38],[87,41,74,38,"API_URL"],[87,48,74,38],[87,62,74,52],[87,64,74,54],[88,8,75,6,"method"],[88,14,75,12],[88,16,75,14],[88,22,75,20],[89,8,76,6,"headers"],[89,15,76,13],[89,17,76,15],[90,10,76,17],[90,24,76,31],[90,26,76,33],[91,8,76,52],[91,9,76,53],[92,8,77,6,"body"],[92,12,77,10],[92,14,77,12,"JSON"],[92,18,77,16],[92,19,77,17,"stringify"],[92,28,77,26],[92,29,77,27],[93,10,77,29,"email"],[93,15,77,34],[94,10,77,36,"password"],[94,18,77,44],[95,10,77,46,"role"],[96,8,77,51],[96,9,77,52],[97,6,78,4],[97,7,78,5],[97,8,78,6],[98,6,80,4],[98,10,80,8],[98,11,80,9,"res"],[98,14,80,12],[98,15,80,13,"ok"],[98,17,80,15],[98,19,80,17],[99,8,81,6],[99,14,81,12,"error"],[99,19,81,17],[99,22,81,20],[99,28,81,26,"res"],[99,31,81,29],[99,32,81,30,"json"],[99,36,81,34],[99,37,81,35],[99,38,81,36],[100,8,82,6],[100,14,82,12],[100,18,82,16,"Error"],[100,23,82,21],[100,24,82,22,"error"],[100,29,82,27],[100,30,82,28,"detail"],[100,36,82,34],[100,40,82,38],[100,70,82,68],[100,71,82,69],[101,6,83,4],[102,6,85,4],[102,12,85,10,"data"],[102,16,85,14],[102,19,85,17],[102,25,85,23,"res"],[102,28,85,26],[102,29,85,27,"json"],[102,33,85,31],[102,34,85,32],[102,35,85,33],[103,6,86,4],[103,12,86,10,"AsyncStorage"],[103,24,86,22],[103,25,86,22,"default"],[103,32,86,22],[103,33,86,23,"setItem"],[103,40,86,30],[103,41,86,31],[103,48,86,38],[103,50,86,40,"data"],[103,54,86,44],[103,55,86,45,"token"],[103,60,86,50],[103,61,86,51],[104,6,87,4,"setToken"],[104,14,87,12],[104,15,87,13,"data"],[104,19,87,17],[104,20,87,18,"token"],[104,25,87,23],[104,26,87,24],[105,6,89,4],[105,12,89,10,"me"],[105,14,89,12],[105,17,89,15],[105,23,89,21,"fetch"],[105,28,89,26],[105,29,89,27],[105,32,89,30,"API_URL"],[105,39,89,37],[105,40,89,37,"API_URL"],[105,47,89,37],[105,57,89,47],[105,59,89,49],[106,8,90,6,"headers"],[106,15,90,13],[106,17,90,15],[107,10,90,17,"Authorization"],[107,23,90,30],[107,25,90,32],[107,35,90,42,"data"],[107,39,90,46],[107,40,90,47,"token"],[107,45,90,52],[108,8,90,55],[109,6,91,4],[109,7,91,5],[109,8,91,6],[110,6,92,4],[110,12,92,10,"userData"],[110,20,92,18],[110,23,92,21],[110,29,92,27,"me"],[110,31,92,29],[110,32,92,30,"json"],[110,36,92,34],[110,37,92,35],[110,38,92,36],[112,6,94,4],[113,6,95,4],[113,12,95,10,"user"],[113,16,95,14],[113,19,95,17],[114,8,95,19],[114,11,95,22,"userData"],[114,19,95,30],[115,8,95,32,"id"],[115,10,95,34],[115,12,95,36,"userData"],[115,20,95,44],[115,21,95,45,"userId"],[116,6,95,52],[116,7,95,53],[117,6,96,4,"setUser"],[117,13,96,11],[117,14,96,12,"user"],[117,18,96,16],[117,19,96,17],[118,6,97,4],[118,13,97,11],[118,17,97,15],[119,4,98,2],[120,4,100,2],[120,19,100,17,"signOut"],[120,26,100,24,"signOut"],[120,27,100,24],[120,29,100,27],[121,6,101,4],[121,12,101,10,"AsyncStorage"],[121,24,101,22],[121,25,101,22,"default"],[121,32,101,22],[121,33,101,23,"removeItem"],[121,43,101,33],[121,44,101,34],[121,51,101,41],[121,52,101,42],[122,6,102,4,"setUser"],[122,13,102,11],[122,14,102,12],[122,18,102,16],[122,19,102,17],[123,6,103,4,"setToken"],[123,14,103,12],[123,15,103,13],[123,19,103,17],[123,20,103,18],[124,4,104,2],[125,4,106,2],[125,24,107,4],[125,28,107,4,"_reactJsxDevRuntime"],[125,47,107,4],[125,48,107,4,"jsxDEV"],[125,54,107,4],[125,56,107,5,"AuthContext"],[125,67,107,16],[125,68,107,17,"Provider"],[125,76,107,25],[126,6,107,26,"value"],[126,11,107,31],[126,13,107,33],[127,8,107,35,"user"],[127,12,107,39],[128,8,107,41,"token"],[128,13,107,46],[129,8,107,48,"loading"],[129,15,107,55],[130,8,107,57,"login"],[130,13,107,62],[131,8,107,64,"signUp"],[131,14,107,70],[132,8,107,72,"signOut"],[133,6,107,80],[133,7,107,82],[134,6,107,82,"children"],[134,14,107,82],[134,16,108,7,"children"],[135,4,108,15],[136,6,108,15,"fileName"],[136,14,108,15],[136,16,108,15,"_jsxFileName"],[136,28,108,15],[137,6,108,15,"lineNumber"],[137,16,108,15],[138,6,108,15,"columnNumber"],[138,18,108,15],[139,4,108,15],[139,11,109,26],[139,12,109,27],[140,2,111,0],[141,2,113,7],[141,11,113,16,"useAuth"],[141,18,113,23,"useAuth"],[141,19,113,23],[141,21,113,26],[142,4,114,2],[142,11,114,9],[142,15,114,9,"useContext"],[142,21,114,19],[142,22,114,19,"useContext"],[142,32,114,19],[142,34,114,20,"AuthContext"],[142,45,114,31],[142,46,114,32],[143,2,115,0],[144,0,115,1],[144,3]],"functionMap":{"names":["<global>","createContext$argument_0.login","createContext$argument_0.signUp","createContext$argument_0.signOut","AuthProvider","loadSession","useEffect$argument_0","login","signUp","signOut","useAuth"],"mappings":"AAA;SCiB,iBD;UEC,iBF;WGC,cH;OIG;ECK;GDe;YEE;GFE;EGE;GHsB;EIE;GJyB;EKE;GLI;CJO;OUE;CVE"},"hasCjsExports":false},"type":"js/module"}]}