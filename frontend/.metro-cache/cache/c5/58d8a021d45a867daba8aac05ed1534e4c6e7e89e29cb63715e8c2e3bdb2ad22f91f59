{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":242,"column":0,"index":5994}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":19},"end":{"line":2,"column":69,"index":88}}],"key":"6eZFbfKht0uO2NEVT/d8+i8B0s8="}},{"name":"expo-constants","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":89},"end":{"line":3,"column":39,"index":128}}],"key":"2TquPknmjb1g5OMuvQ0eTuioYjU="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.applyForJob = applyForJob;\n  exports.getApplicationsForJob = getApplicationsForJob;\n  exports.getJobById = getJobById;\n  exports.getMyApplications = getMyApplications;\n  exports.getWorkerProfile = getWorkerProfile;\n  exports.getWorkerProfileById = getWorkerProfileById;\n  exports.selectWorker = selectWorker;\n  exports.updateWorkerProfile = updateWorkerProfile;\n  exports.uploadProfilePhoto = uploadProfilePhoto;\n  var _asyncStorage = _interopRequireDefault(require(_dependencyMap[1], \"@react-native-async-storage/async-storage\"));\n  var _expoConstants = _interopRequireDefault(require(_dependencyMap[2], \"expo-constants\"));\n  // services/api.ts\n\n  // Get API base URL from environment\n  // In Kubernetes, all /api/* requests are automatically routed to backend (port 8001)\n  // So we use an empty base URL (relative paths)\n  const API_BASE_URL = _expoConstants.default.expoConfig?.extra?.backendUrl || '';\n\n  /**\n   * Get auth token from AsyncStorage\n   */\n  async function getAuthToken() {\n    try {\n      const token = await _asyncStorage.default.getItem('@backup:token');\n      return token;\n    } catch (error) {\n      console.error('Error getting auth token:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Make authenticated API request\n   */\n  async function apiRequest(endpoint, options = {}) {\n    const token = await getAuthToken();\n    const headers = {\n      'Content-Type': 'application/json',\n      ...options.headers\n    };\n    if (token) {\n      headers['Authorization'] = `Bearer ${token}`;\n    }\n    const url = `${API_BASE_URL}${endpoint}`;\n    try {\n      const response = await fetch(url, {\n        ...options,\n        headers\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({\n          detail: 'Unknown error'\n        }));\n        throw new Error(errorData.detail || `HTTP ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error(`API Error [${endpoint}]:`, error);\n      throw error;\n    }\n  }\n\n  // ============================================\n  // APPLICATIONS API\n  // ============================================\n\n  /**\n   * Worker bewirbt sich auf einen Job\n   */\n  async function applyForJob(jobId) {\n    return apiRequest('/api/applications', {\n      method: 'POST',\n      body: JSON.stringify({\n        job_id: jobId\n      })\n    });\n  }\n\n  /**\n   * Worker lädt eigene Bewerbungen\n   */\n  async function getMyApplications() {\n    return apiRequest('/api/applications/me');\n  }\n\n  /**\n   * Employer lädt Bewerbungen für einen Job\n   */\n  async function getApplicationsForJob(jobId) {\n    return apiRequest(`/api/applications/job/${jobId}`);\n  }\n\n  // ============================================\n  // MATCHES API\n  // ============================================\n\n  /**\n   * Employer wählt einen Worker aus\n   */\n  async function selectWorker(applicationId) {\n    return apiRequest(`/api/matches/select/${applicationId}`, {\n      method: 'POST'\n    });\n  }\n\n  // ============================================\n  // JOBS API\n  // ============================================\n\n  /**\n   * Get job by ID\n   */\n  async function getJobById(jobId) {\n    return apiRequest(`/api/jobs/${jobId}`);\n  }\n\n  // ============================================\n  // PROFILES API\n  // ============================================\n\n  /**\n   * Worker Profile laden (eigenes)\n   */\n  async function getWorkerProfile() {\n    return apiRequest('/api/profiles/worker/me');\n  }\n\n  /**\n   * Worker Profile laden (by ID, für Employers)\n   */\n  async function getWorkerProfileById(userId) {\n    return apiRequest(`/api/profiles/worker/${userId}`);\n  }\n\n  /**\n   * Worker Profile aktualisieren\n   */\n  async function updateWorkerProfile(data) {\n    return apiRequest('/api/profiles/worker/me', {\n      method: 'PATCH',\n      body: JSON.stringify(data)\n    });\n  }\n\n  // ============================================\n  // UPLOAD API\n  // ============================================\n\n  /**\n   * Upload profile photo\n   */\n  async function uploadProfilePhoto(uri) {\n    const token = await getAuthToken();\n\n    // Create form data\n    const formData = new FormData();\n    const filename = uri.split('/').pop() || 'photo.jpg';\n    const fileType = filename.split('.').pop() || 'jpg';\n\n    // @ts-ignore - React Native FormData accepts this format\n    formData.append('file', {\n      uri,\n      name: filename,\n      type: `image/${fileType}`\n    });\n    const url = `${API_BASE_URL}/api/upload/profile-photo`;\n    try {\n      const response = await fetch(url, {\n        method: 'POST',\n        headers: {\n          'Authorization': token ? `Bearer ${token}` : ''\n        },\n        body: formData\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({\n          detail: 'Upload failed'\n        }));\n        throw new Error(errorData.detail || `HTTP ${response.status}`);\n      }\n      const result = await response.json();\n      // Backend returns { photo_url, message }, map to { url, message }\n      return {\n        url: result.photo_url,\n        message: result.message\n      };\n    } catch (error) {\n      console.error('Photo upload error:', error);\n      throw error;\n    }\n  }\n});","lineCount":197,"map":[[15,2,2,0],[15,6,2,0,"_asyncStorage"],[15,19,2,0],[15,22,2,0,"_interopRequireDefault"],[15,44,2,0],[15,45,2,0,"require"],[15,52,2,0],[15,53,2,0,"_dependencyMap"],[15,67,2,0],[16,2,3,0],[16,6,3,0,"_expoConstants"],[16,20,3,0],[16,23,3,0,"_interopRequireDefault"],[16,45,3,0],[16,46,3,0,"require"],[16,53,3,0],[16,54,3,0,"_dependencyMap"],[16,68,3,0],[17,2,1,0],[19,2,5,0],[20,2,6,0],[21,2,7,0],[22,2,8,0],[22,8,8,6,"API_BASE_URL"],[22,20,8,18],[22,23,8,21,"Constants"],[22,45,8,30],[22,46,8,31,"expoConfig"],[22,56,8,41],[22,58,8,43,"extra"],[22,63,8,48],[22,65,8,50,"backendUrl"],[22,75,8,60],[22,79,8,64],[22,81,8,66],[24,2,10,0],[25,0,11,0],[26,0,12,0],[27,2,13,0],[27,17,13,15,"getAuthToken"],[27,29,13,27,"getAuthToken"],[27,30,13,27],[27,32,13,54],[28,4,14,2],[28,8,14,6],[29,6,15,4],[29,12,15,10,"token"],[29,17,15,15],[29,20,15,18],[29,26,15,24,"AsyncStorage"],[29,47,15,36],[29,48,15,37,"getItem"],[29,55,15,44],[29,56,15,45],[29,71,15,60],[29,72,15,61],[30,6,16,4],[30,13,16,11,"token"],[30,18,16,16],[31,4,17,2],[31,5,17,3],[31,6,17,4],[31,13,17,11,"error"],[31,18,17,16],[31,20,17,18],[32,6,18,4,"console"],[32,13,18,11],[32,14,18,12,"error"],[32,19,18,17],[32,20,18,18],[32,47,18,45],[32,49,18,47,"error"],[32,54,18,52],[32,55,18,53],[33,6,19,4],[33,13,19,11],[33,17,19,15],[34,4,20,2],[35,2,21,0],[37,2,23,0],[38,0,24,0],[39,0,25,0],[40,2,26,0],[40,17,26,15,"apiRequest"],[40,27,26,25,"apiRequest"],[40,28,27,2,"endpoint"],[40,36,27,18],[40,38,28,2,"options"],[40,45,28,22],[40,48,28,25],[40,49,28,26],[40,50,28,27],[40,52,29,14],[41,4,30,2],[41,10,30,8,"token"],[41,15,30,13],[41,18,30,16],[41,24,30,22,"getAuthToken"],[41,36,30,34],[41,37,30,35],[41,38,30,36],[42,4,32,2],[42,10,32,8,"headers"],[42,17,32,28],[42,20,32,31],[43,6,33,4],[43,20,33,18],[43,22,33,20],[43,40,33,38],[44,6,34,4],[44,9,34,7,"options"],[44,16,34,14],[44,17,34,15,"headers"],[45,4,35,2],[45,5,35,3],[46,4,37,2],[46,8,37,6,"token"],[46,13,37,11],[46,15,37,13],[47,6,38,4,"headers"],[47,13,38,11],[47,14,38,12],[47,29,38,27],[47,30,38,28],[47,33,38,31],[47,43,38,41,"token"],[47,48,38,46],[47,50,38,48],[48,4,39,2],[49,4,41,2],[49,10,41,8,"url"],[49,13,41,11],[49,16,41,14],[49,19,41,17,"API_BASE_URL"],[49,31,41,29],[49,34,41,32,"endpoint"],[49,42,41,40],[49,44,41,42],[50,4,43,2],[50,8,43,6],[51,6,44,4],[51,12,44,10,"response"],[51,20,44,18],[51,23,44,21],[51,29,44,27,"fetch"],[51,34,44,32],[51,35,44,33,"url"],[51,38,44,36],[51,40,44,38],[52,8,45,6],[52,11,45,9,"options"],[52,18,45,16],[53,8,46,6,"headers"],[54,6,47,4],[54,7,47,5],[54,8,47,6],[55,6,49,4],[55,10,49,8],[55,11,49,9,"response"],[55,19,49,17],[55,20,49,18,"ok"],[55,22,49,20],[55,24,49,22],[56,8,50,6],[56,14,50,12,"errorData"],[56,23,50,21],[56,26,50,24],[56,32,50,30,"response"],[56,40,50,38],[56,41,50,39,"json"],[56,45,50,43],[56,46,50,44],[56,47,50,45],[56,48,50,46,"catch"],[56,53,50,51],[56,54,50,52],[56,61,50,59],[57,10,50,61,"detail"],[57,16,50,67],[57,18,50,69],[58,8,50,85],[58,9,50,86],[58,10,50,87],[58,11,50,88],[59,8,51,6],[59,14,51,12],[59,18,51,16,"Error"],[59,23,51,21],[59,24,51,22,"errorData"],[59,33,51,31],[59,34,51,32,"detail"],[59,40,51,38],[59,44,51,42],[59,52,51,50,"response"],[59,60,51,58],[59,61,51,59,"status"],[59,67,51,65],[59,69,51,67],[59,70,51,68],[60,6,52,4],[61,6,54,4],[61,13,54,11],[61,19,54,17,"response"],[61,27,54,25],[61,28,54,26,"json"],[61,32,54,30],[61,33,54,31],[61,34,54,32],[62,4,55,2],[62,5,55,3],[62,6,55,4],[62,13,55,11,"error"],[62,18,55,16],[62,20,55,18],[63,6,56,4,"console"],[63,13,56,11],[63,14,56,12,"error"],[63,19,56,17],[63,20,56,18],[63,34,56,32,"endpoint"],[63,42,56,40],[63,46,56,44],[63,48,56,46,"error"],[63,53,56,51],[63,54,56,52],[64,6,57,4],[64,12,57,10,"error"],[64,17,57,15],[65,4,58,2],[66,2,59,0],[68,2,61,0],[69,2,62,0],[70,2,63,0],[72,2,73,0],[73,0,74,0],[74,0,75,0],[75,2,76,7],[75,17,76,22,"applyForJob"],[75,28,76,33,"applyForJob"],[75,29,76,34,"jobId"],[75,34,76,47],[75,36,76,71],[76,4,77,2],[76,11,77,9,"apiRequest"],[76,21,77,19],[76,22,77,33],[76,41,77,52],[76,43,77,54],[77,6,78,4,"method"],[77,12,78,10],[77,14,78,12],[77,20,78,18],[78,6,79,4,"body"],[78,10,79,8],[78,12,79,10,"JSON"],[78,16,79,14],[78,17,79,15,"stringify"],[78,26,79,24],[78,27,79,25],[79,8,79,27,"job_id"],[79,14,79,33],[79,16,79,35,"jobId"],[80,6,79,41],[80,7,79,42],[81,4,80,2],[81,5,80,3],[81,6,80,4],[82,2,81,0],[84,2,83,0],[85,0,84,0],[86,0,85,0],[87,2,86,7],[87,17,86,22,"getMyApplications"],[87,34,86,39,"getMyApplications"],[87,35,86,39],[87,37,86,66],[88,4,87,2],[88,11,87,9,"apiRequest"],[88,21,87,19],[88,22,87,35],[88,44,87,57],[88,45,87,58],[89,2,88,0],[91,2,90,0],[92,0,91,0],[93,0,92,0],[94,2,93,7],[94,17,93,22,"getApplicationsForJob"],[94,38,93,43,"getApplicationsForJob"],[94,39,93,44,"jobId"],[94,44,93,57],[94,46,93,83],[95,4,94,2],[95,11,94,9,"apiRequest"],[95,21,94,19],[95,22,94,35],[95,47,94,60,"jobId"],[95,52,94,65],[95,54,94,67],[95,55,94,68],[96,2,95,0],[98,2,97,0],[99,2,98,0],[100,2,99,0],[102,2,106,0],[103,0,107,0],[104,0,108,0],[105,2,109,7],[105,17,109,22,"selectWorker"],[105,29,109,34,"selectWorker"],[105,30,109,35,"applicationId"],[105,43,109,56],[105,45,109,89],[106,4,110,2],[106,11,110,9,"apiRequest"],[106,21,110,19],[106,22,110,42],[106,45,110,65,"applicationId"],[106,58,110,78],[106,60,110,80],[106,62,110,82],[107,6,111,4,"method"],[107,12,111,10],[107,14,111,12],[108,4,112,2],[108,5,112,3],[108,6,112,4],[109,2,113,0],[111,2,115,0],[112,2,116,0],[113,2,117,0],[115,2,135,0],[116,0,136,0],[117,0,137,0],[118,2,138,7],[118,17,138,22,"getJobById"],[118,27,138,32,"getJobById"],[118,28,138,33,"jobId"],[118,33,138,46],[118,35,138,62],[119,4,139,2],[119,11,139,9,"apiRequest"],[119,21,139,19],[119,22,139,25],[119,35,139,38,"jobId"],[119,40,139,43],[119,42,139,45],[119,43,139,46],[120,2,140,0],[122,2,142,0],[123,2,143,0],[124,2,144,0],[126,2,164,0],[127,0,165,0],[128,0,166,0],[129,2,167,7],[129,17,167,22,"getWorkerProfile"],[129,33,167,38,"getWorkerProfile"],[129,34,167,38],[129,36,167,65],[130,4,168,2],[130,11,168,9,"apiRequest"],[130,21,168,19],[130,22,168,35],[130,47,168,60],[130,48,168,61],[131,2,169,0],[133,2,171,0],[134,0,172,0],[135,0,173,0],[136,2,174,7],[136,17,174,22,"getWorkerProfileById"],[136,37,174,42,"getWorkerProfileById"],[136,38,174,43,"userId"],[136,44,174,57],[136,46,174,83],[137,4,175,2],[137,11,175,9,"apiRequest"],[137,21,175,19],[137,22,175,35],[137,46,175,59,"userId"],[137,52,175,65],[137,54,175,67],[137,55,175,68],[138,2,176,0],[140,2,178,0],[141,0,179,0],[142,0,180,0],[143,2,181,7],[143,17,181,22,"updateWorkerProfile"],[143,36,181,41,"updateWorkerProfile"],[143,37,181,42,"data"],[143,41,181,70],[143,43,181,96],[144,4,182,2],[144,11,182,9,"apiRequest"],[144,21,182,19],[144,22,182,35],[144,47,182,60],[144,49,182,62],[145,6,183,4,"method"],[145,12,183,10],[145,14,183,12],[145,21,183,19],[146,6,184,4,"body"],[146,10,184,8],[146,12,184,10,"JSON"],[146,16,184,14],[146,17,184,15,"stringify"],[146,26,184,24],[146,27,184,25,"data"],[146,31,184,29],[147,4,185,2],[147,5,185,3],[147,6,185,4],[148,2,186,0],[150,2,188,0],[151,2,189,0],[152,2,190,0],[154,2,197,0],[155,0,198,0],[156,0,199,0],[157,2,200,7],[157,17,200,22,"uploadProfilePhoto"],[157,35,200,40,"uploadProfilePhoto"],[157,36,200,41,"uri"],[157,39,200,52],[157,41,200,97],[158,4,201,2],[158,10,201,8,"token"],[158,15,201,13],[158,18,201,16],[158,24,201,22,"getAuthToken"],[158,36,201,34],[158,37,201,35],[158,38,201,36],[160,4,203,2],[161,4,204,2],[161,10,204,8,"formData"],[161,18,204,16],[161,21,204,19],[161,25,204,23,"FormData"],[161,33,204,31],[161,34,204,32],[161,35,204,33],[162,4,205,2],[162,10,205,8,"filename"],[162,18,205,16],[162,21,205,19,"uri"],[162,24,205,22],[162,25,205,23,"split"],[162,30,205,28],[162,31,205,29],[162,34,205,32],[162,35,205,33],[162,36,205,34,"pop"],[162,39,205,37],[162,40,205,38],[162,41,205,39],[162,45,205,43],[162,56,205,54],[163,4,206,2],[163,10,206,8,"fileType"],[163,18,206,16],[163,21,206,19,"filename"],[163,29,206,27],[163,30,206,28,"split"],[163,35,206,33],[163,36,206,34],[163,39,206,37],[163,40,206,38],[163,41,206,39,"pop"],[163,44,206,42],[163,45,206,43],[163,46,206,44],[163,50,206,48],[163,55,206,53],[165,4,208,2],[166,4,209,2,"formData"],[166,12,209,10],[166,13,209,11,"append"],[166,19,209,17],[166,20,209,18],[166,26,209,24],[166,28,209,26],[167,6,210,4,"uri"],[167,9,210,7],[168,6,211,4,"name"],[168,10,211,8],[168,12,211,10,"filename"],[168,20,211,18],[169,6,212,4,"type"],[169,10,212,8],[169,12,212,10],[169,21,212,19,"fileType"],[169,29,212,27],[170,4,213,2],[170,5,213,3],[170,6,213,4],[171,4,215,2],[171,10,215,8,"url"],[171,13,215,11],[171,16,215,14],[171,19,215,17,"API_BASE_URL"],[171,31,215,29],[171,58,215,56],[172,4,217,2],[172,8,217,6],[173,6,218,4],[173,12,218,10,"response"],[173,20,218,18],[173,23,218,21],[173,29,218,27,"fetch"],[173,34,218,32],[173,35,218,33,"url"],[173,38,218,36],[173,40,218,38],[174,8,219,6,"method"],[174,14,219,12],[174,16,219,14],[174,22,219,20],[175,8,220,6,"headers"],[175,15,220,13],[175,17,220,15],[176,10,221,8],[176,25,221,23],[176,27,221,25,"token"],[176,32,221,30],[176,35,221,33],[176,45,221,43,"token"],[176,50,221,48],[176,52,221,50],[176,55,221,53],[177,8,222,6],[177,9,222,7],[178,8,223,6,"body"],[178,12,223,10],[178,14,223,12,"formData"],[179,6,224,4],[179,7,224,5],[179,8,224,6],[180,6,226,4],[180,10,226,8],[180,11,226,9,"response"],[180,19,226,17],[180,20,226,18,"ok"],[180,22,226,20],[180,24,226,22],[181,8,227,6],[181,14,227,12,"errorData"],[181,23,227,21],[181,26,227,24],[181,32,227,30,"response"],[181,40,227,38],[181,41,227,39,"json"],[181,45,227,43],[181,46,227,44],[181,47,227,45],[181,48,227,46,"catch"],[181,53,227,51],[181,54,227,52],[181,61,227,59],[182,10,227,61,"detail"],[182,16,227,67],[182,18,227,69],[183,8,227,85],[183,9,227,86],[183,10,227,87],[183,11,227,88],[184,8,228,6],[184,14,228,12],[184,18,228,16,"Error"],[184,23,228,21],[184,24,228,22,"errorData"],[184,33,228,31],[184,34,228,32,"detail"],[184,40,228,38],[184,44,228,42],[184,52,228,50,"response"],[184,60,228,58],[184,61,228,59,"status"],[184,67,228,65],[184,69,228,67],[184,70,228,68],[185,6,229,4],[186,6,231,4],[186,12,231,10,"result"],[186,18,231,16],[186,21,231,19],[186,27,231,25,"response"],[186,35,231,33],[186,36,231,34,"json"],[186,40,231,38],[186,41,231,39],[186,42,231,40],[187,6,232,4],[188,6,233,4],[188,13,233,11],[189,8,234,6,"url"],[189,11,234,9],[189,13,234,11,"result"],[189,19,234,17],[189,20,234,18,"photo_url"],[189,29,234,27],[190,8,235,6,"message"],[190,15,235,13],[190,17,235,15,"result"],[190,23,235,21],[190,24,235,22,"message"],[191,6,236,4],[191,7,236,5],[192,4,237,2],[192,5,237,3],[192,6,237,4],[192,13,237,11,"error"],[192,18,237,16],[192,20,237,18],[193,6,238,4,"console"],[193,13,238,11],[193,14,238,12,"error"],[193,19,238,17],[193,20,238,18],[193,41,238,39],[193,43,238,41,"error"],[193,48,238,46],[193,49,238,47],[194,6,239,4],[194,12,239,10,"error"],[194,17,239,15],[195,4,240,2],[196,2,241,0],[197,0,241,1]],"functionMap":{"names":["<global>","getAuthToken","apiRequest","response.json._catch$argument_0","applyForJob","getMyApplications","getApplicationsForJob","selectWorker","getJobById","getWorkerProfile","getWorkerProfileById","updateWorkerProfile","uploadProfilePhoto"],"mappings":"AAA;ACY;CDQ;AEK;oDCwB,mCD;CFS;OIiB;CJK;OKK;CLE;OMK;CNE;OOc;CPI;OQyB;CRE;OS2B;CTE;OUK;CVE;OWK;CXK;OYc;oDT2B,mCS;CZc"}},"type":"js/module"}]}