{"dependencies":[{"name":"./api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":111},"end":{"line":3,"column":60,"index":171}}],"key":"FbKPDeRJ9TF3vg1eKYKz12urgic=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getWorkerProfile = getWorkerProfile;\n  exports.saveWorkerProfile = saveWorkerProfile;\n  var _api = require(_dependencyMap[0], \"./api\");\n  // utils/profileStore.ts - Worker Profile Store (REFACTORED)\n\n  // ===== GET WORKER PROFILE =====\n  async function getWorkerProfile(userId) {\n    // If no userId provided, get it from auth\n    if (!userId) {\n      userId = await (0, _api.getUserId)();\n      if (!userId) {\n        console.error('‚ùå getWorkerProfile: No userId provided and not authenticated');\n        throw new Error('Not authenticated');\n      }\n    }\n    console.log('üîç getWorkerProfile: Loading profile for user', userId);\n    try {\n      const headers = await (0, _api.getAuthHeaders)();\n      const response = await fetch(`${_api.API_BASE}/profiles/worker/${userId}`, {\n        method: 'GET',\n        headers\n      });\n      if (response.status === 404) {\n        console.log('‚ö†Ô∏è getWorkerProfile: Profile not found (404)');\n        return null;\n      }\n      if (!response.ok) {\n        const error = await response.text();\n        console.error('‚ùå getWorkerProfile: API error', response.status, error);\n        throw new Error(`Failed to fetch profile: ${response.status}`);\n      }\n      const profile = await response.json();\n\n      // Map Backend keys (snake_case) ‚Üí Frontend keys (camelCase)\n      if (profile.home_address) {\n        profile.homeAddress = {\n          street: profile.home_address.street,\n          houseNumber: profile.home_address.house_number || profile.home_address.houseNumber,\n          postalCode: profile.home_address.postal_code || profile.home_address.postalCode,\n          city: profile.home_address.city,\n          country: profile.home_address.country\n        };\n      }\n      if (profile.home_lat) profile.homeLat = profile.home_lat;\n      if (profile.home_lon) profile.homeLon = profile.home_lon;\n      if (profile.radius_km !== undefined) profile.radiusKm = profile.radius_km;\n      if (profile.is_self_employed !== undefined) profile.isSelfEmployed = profile.is_self_employed;\n      if (profile.short_bio) profile.shortBio = profile.short_bio;\n      console.log('‚úÖ getWorkerProfile: Profile loaded', {\n        userId: profile.userId,\n        categories: profile.categories?.length || 0,\n        radiusKm: profile.radiusKm,\n        isSelfEmployed: profile.isSelfEmployed\n      });\n      return profile;\n    } catch (error) {\n      console.error('‚ùå getWorkerProfile: Error', error);\n      throw error;\n    }\n  }\n\n  // ===== SAVE WORKER PROFILE =====\n  async function saveWorkerProfile(userId, profileData) {\n    console.log('üíæ saveWorkerProfile: Saving profile for', userId);\n    console.log('üíæ saveWorkerProfile: Data:', profileData);\n    try {\n      // 1. Bestehendes Profil laden\n      const existing = await getWorkerProfile(userId);\n\n      // 2. Vollst√§ndiges Profil-Objekt erstellen\n      const merged = existing ? Object.assign({}, existing, profileData) : profileData;\n      const headers = await (0, _api.getAuthHeaders)();\n\n      // 3. merged statt profileData senden\n      // Try PUT first (update existing)\n      let response = await fetch(`${_api.API_BASE}/profiles/worker/${userId}`, {\n        method: 'PUT',\n        headers,\n        body: JSON.stringify(merged)\n      });\n      console.log('üì• saveWorkerProfile: PUT response status:', response.status);\n\n      // If 404, profile doesn't exist - create with POST\n      if (response.status === 404) {\n        console.log('‚ö†Ô∏è saveWorkerProfile: Profile not found, creating new via POST');\n        response = await fetch(`${_api.API_BASE}/profiles/worker`, {\n          method: 'POST',\n          headers,\n          body: JSON.stringify(merged)\n        });\n        console.log('üì• saveWorkerProfile: POST response status:', response.status);\n      }\n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error('‚ùå saveWorkerProfile: Backend error:', errorText);\n        throw new Error(`Server Error ${response.status}: ${errorText}`);\n      }\n      const result = await response.json();\n      console.log('‚úÖ saveWorkerProfile: Profile saved successfully', result);\n    } catch (error) {\n      console.error('‚ùå saveWorkerProfile: Exception:', error.message);\n      throw error;\n    }\n  }\n});","lineCount":111,"map":[[7,2,6,0,"exports"],[7,9,6,0],[7,10,6,0,"getWorkerProfile"],[7,26,6,0],[7,29,6,0,"getWorkerProfile"],[7,45,6,0],[8,2,70,0,"exports"],[8,9,70,0],[8,10,70,0,"saveWorkerProfile"],[8,27,70,0],[8,30,70,0,"saveWorkerProfile"],[8,47,70,0],[9,2,3,0],[9,6,3,0,"_api"],[9,10,3,0],[9,13,3,0,"require"],[9,20,3,0],[9,21,3,0,"_dependencyMap"],[9,35,3,0],[10,2,1,0],[12,2,5,0],[13,2,6,7],[13,17,6,22,"getWorkerProfile"],[13,33,6,38,"getWorkerProfile"],[13,34,6,39,"userId"],[13,40,6,54],[13,42,6,87],[14,4,7,2],[15,4,8,2],[15,8,8,6],[15,9,8,7,"userId"],[15,15,8,13],[15,17,8,15],[16,6,9,4,"userId"],[16,12,9,10],[16,15,9,13],[16,21,9,19],[16,25,9,19,"getUserId"],[16,29,9,28],[16,30,9,28,"getUserId"],[16,39,9,28],[16,41,9,29],[16,42,9,30],[17,6,10,4],[17,10,10,8],[17,11,10,9,"userId"],[17,17,10,15],[17,19,10,17],[18,8,11,6,"console"],[18,15,11,13],[18,16,11,14,"error"],[18,21,11,19],[18,22,11,20],[18,84,11,82],[18,85,11,83],[19,8,12,6],[19,14,12,12],[19,18,12,16,"Error"],[19,23,12,21],[19,24,12,22],[19,43,12,41],[19,44,12,42],[20,6,13,4],[21,4,14,2],[22,4,16,2,"console"],[22,11,16,9],[22,12,16,10,"log"],[22,15,16,13],[22,16,16,14],[22,63,16,61],[22,65,16,63,"userId"],[22,71,16,69],[22,72,16,70],[23,4,18,2],[23,8,18,6],[24,6,19,4],[24,12,19,10,"headers"],[24,19,19,17],[24,22,19,20],[24,28,19,26],[24,32,19,26,"getAuthHeaders"],[24,36,19,40],[24,37,19,40,"getAuthHeaders"],[24,51,19,40],[24,53,19,41],[24,54,19,42],[25,6,21,4],[25,12,21,10,"response"],[25,20,21,18],[25,23,21,21],[25,29,21,27,"fetch"],[25,34,21,32],[25,35,21,33],[25,38,21,36,"API_BASE"],[25,42,21,44],[25,43,21,44,"API_BASE"],[25,51,21,44],[25,71,21,64,"userId"],[25,77,21,70],[25,79,21,72],[25,81,21,74],[26,8,22,6,"method"],[26,14,22,12],[26,16,22,14],[26,21,22,19],[27,8,23,6,"headers"],[28,6,24,4],[28,7,24,5],[28,8,24,6],[29,6,26,4],[29,10,26,8,"response"],[29,18,26,16],[29,19,26,17,"status"],[29,25,26,23],[29,30,26,28],[29,33,26,31],[29,35,26,33],[30,8,27,6,"console"],[30,15,27,13],[30,16,27,14,"log"],[30,19,27,17],[30,20,27,18],[30,66,27,64],[30,67,27,65],[31,8,28,6],[31,15,28,13],[31,19,28,17],[32,6,29,4],[33,6,31,4],[33,10,31,8],[33,11,31,9,"response"],[33,19,31,17],[33,20,31,18,"ok"],[33,22,31,20],[33,24,31,22],[34,8,32,6],[34,14,32,12,"error"],[34,19,32,17],[34,22,32,20],[34,28,32,26,"response"],[34,36,32,34],[34,37,32,35,"text"],[34,41,32,39],[34,42,32,40],[34,43,32,41],[35,8,33,6,"console"],[35,15,33,13],[35,16,33,14,"error"],[35,21,33,19],[35,22,33,20],[35,53,33,51],[35,55,33,53,"response"],[35,63,33,61],[35,64,33,62,"status"],[35,70,33,68],[35,72,33,70,"error"],[35,77,33,75],[35,78,33,76],[36,8,34,6],[36,14,34,12],[36,18,34,16,"Error"],[36,23,34,21],[36,24,34,22],[36,52,34,50,"response"],[36,60,34,58],[36,61,34,59,"status"],[36,67,34,65],[36,69,34,67],[36,70,34,68],[37,6,35,4],[38,6,37,4],[38,12,37,10,"profile"],[38,19,37,17],[38,22,37,20],[38,28,37,26,"response"],[38,36,37,34],[38,37,37,35,"json"],[38,41,37,39],[38,42,37,40],[38,43,37,41],[40,6,39,4],[41,6,40,4],[41,10,40,8,"profile"],[41,17,40,15],[41,18,40,16,"home_address"],[41,30,40,28],[41,32,40,30],[42,8,41,6,"profile"],[42,15,41,13],[42,16,41,14,"homeAddress"],[42,27,41,25],[42,30,41,28],[43,10,42,8,"street"],[43,16,42,14],[43,18,42,16,"profile"],[43,25,42,23],[43,26,42,24,"home_address"],[43,38,42,36],[43,39,42,37,"street"],[43,45,42,43],[44,10,43,8,"houseNumber"],[44,21,43,19],[44,23,43,21,"profile"],[44,30,43,28],[44,31,43,29,"home_address"],[44,43,43,41],[44,44,43,42,"house_number"],[44,56,43,54],[44,60,43,58,"profile"],[44,67,43,65],[44,68,43,66,"home_address"],[44,80,43,78],[44,81,43,79,"houseNumber"],[44,92,43,90],[45,10,44,8,"postalCode"],[45,20,44,18],[45,22,44,20,"profile"],[45,29,44,27],[45,30,44,28,"home_address"],[45,42,44,40],[45,43,44,41,"postal_code"],[45,54,44,52],[45,58,44,56,"profile"],[45,65,44,63],[45,66,44,64,"home_address"],[45,78,44,76],[45,79,44,77,"postalCode"],[45,89,44,87],[46,10,45,8,"city"],[46,14,45,12],[46,16,45,14,"profile"],[46,23,45,21],[46,24,45,22,"home_address"],[46,36,45,34],[46,37,45,35,"city"],[46,41,45,39],[47,10,46,8,"country"],[47,17,46,15],[47,19,46,17,"profile"],[47,26,46,24],[47,27,46,25,"home_address"],[47,39,46,37],[47,40,46,38,"country"],[48,8,47,6],[48,9,47,7],[49,6,48,4],[50,6,49,4],[50,10,49,8,"profile"],[50,17,49,15],[50,18,49,16,"home_lat"],[50,26,49,24],[50,28,49,26,"profile"],[50,35,49,33],[50,36,49,34,"homeLat"],[50,43,49,41],[50,46,49,44,"profile"],[50,53,49,51],[50,54,49,52,"home_lat"],[50,62,49,60],[51,6,50,4],[51,10,50,8,"profile"],[51,17,50,15],[51,18,50,16,"home_lon"],[51,26,50,24],[51,28,50,26,"profile"],[51,35,50,33],[51,36,50,34,"homeLon"],[51,43,50,41],[51,46,50,44,"profile"],[51,53,50,51],[51,54,50,52,"home_lon"],[51,62,50,60],[52,6,51,4],[52,10,51,8,"profile"],[52,17,51,15],[52,18,51,16,"radius_km"],[52,27,51,25],[52,32,51,30,"undefined"],[52,41,51,39],[52,43,51,41,"profile"],[52,50,51,48],[52,51,51,49,"radiusKm"],[52,59,51,57],[52,62,51,60,"profile"],[52,69,51,67],[52,70,51,68,"radius_km"],[52,79,51,77],[53,6,52,4],[53,10,52,8,"profile"],[53,17,52,15],[53,18,52,16,"is_self_employed"],[53,34,52,32],[53,39,52,37,"undefined"],[53,48,52,46],[53,50,52,48,"profile"],[53,57,52,55],[53,58,52,56,"isSelfEmployed"],[53,72,52,70],[53,75,52,73,"profile"],[53,82,52,80],[53,83,52,81,"is_self_employed"],[53,99,52,97],[54,6,53,4],[54,10,53,8,"profile"],[54,17,53,15],[54,18,53,16,"short_bio"],[54,27,53,25],[54,29,53,27,"profile"],[54,36,53,34],[54,37,53,35,"shortBio"],[54,45,53,43],[54,48,53,46,"profile"],[54,55,53,53],[54,56,53,54,"short_bio"],[54,65,53,63],[55,6,55,4,"console"],[55,13,55,11],[55,14,55,12,"log"],[55,17,55,15],[55,18,55,16],[55,54,55,52],[55,56,55,54],[56,8,56,6,"userId"],[56,14,56,12],[56,16,56,14,"profile"],[56,23,56,21],[56,24,56,22,"userId"],[56,30,56,28],[57,8,57,6,"categories"],[57,18,57,16],[57,20,57,18,"profile"],[57,27,57,25],[57,28,57,26,"categories"],[57,38,57,36],[57,40,57,38,"length"],[57,46,57,44],[57,50,57,48],[57,51,57,49],[58,8,58,6,"radiusKm"],[58,16,58,14],[58,18,58,16,"profile"],[58,25,58,23],[58,26,58,24,"radiusKm"],[58,34,58,32],[59,8,59,6,"isSelfEmployed"],[59,22,59,20],[59,24,59,22,"profile"],[59,31,59,29],[59,32,59,30,"isSelfEmployed"],[60,6,60,4],[60,7,60,5],[60,8,60,6],[61,6,62,4],[61,13,62,11,"profile"],[61,20,62,18],[62,4,63,2],[62,5,63,3],[62,6,63,4],[62,13,63,11,"error"],[62,18,63,16],[62,20,63,18],[63,6,64,4,"console"],[63,13,64,11],[63,14,64,12,"error"],[63,19,64,17],[63,20,64,18],[63,47,64,45],[63,49,64,47,"error"],[63,54,64,52],[63,55,64,53],[64,6,65,4],[64,12,65,10,"error"],[64,17,65,15],[65,4,66,2],[66,2,67,0],[68,2,69,0],[69,2,70,7],[69,17,70,22,"saveWorkerProfile"],[69,34,70,39,"saveWorkerProfile"],[69,35,71,2,"userId"],[69,41,71,16],[69,43,72,2,"profileData"],[69,54,72,37],[69,56,73,17],[70,4,74,2,"console"],[70,11,74,9],[70,12,74,10,"log"],[70,15,74,13],[70,16,74,14],[70,58,74,56],[70,60,74,58,"userId"],[70,66,74,64],[70,67,74,65],[71,4,75,2,"console"],[71,11,75,9],[71,12,75,10,"log"],[71,15,75,13],[71,16,75,14],[71,45,75,43],[71,47,75,45,"profileData"],[71,58,75,56],[71,59,75,57],[72,4,77,2],[72,8,77,6],[73,6,78,4],[74,6,79,4],[74,12,79,10,"existing"],[74,20,79,18],[74,23,79,21],[74,29,79,27,"getWorkerProfile"],[74,45,79,43],[74,46,79,44,"userId"],[74,52,79,50],[74,53,79,51],[76,6,81,4],[77,6,82,4],[77,12,82,10,"merged"],[77,18,82,16],[77,21,82,19,"existing"],[77,29,82,27],[77,32,82,27,"Object"],[77,38,82,27],[77,39,82,27,"assign"],[77,45,82,27],[77,50,82,35,"existing"],[77,58,82,43],[77,60,82,48,"profileData"],[77,71,82,59],[77,75,82,64,"profileData"],[77,86,82,75],[78,6,84,4],[78,12,84,10,"headers"],[78,19,84,17],[78,22,84,20],[78,28,84,26],[78,32,84,26,"getAuthHeaders"],[78,36,84,40],[78,37,84,40,"getAuthHeaders"],[78,51,84,40],[78,53,84,41],[78,54,84,42],[80,6,86,4],[81,6,87,4],[82,6,88,4],[82,10,88,8,"response"],[82,18,88,16],[82,21,88,19],[82,27,88,25,"fetch"],[82,32,88,30],[82,33,88,31],[82,36,88,34,"API_BASE"],[82,40,88,42],[82,41,88,42,"API_BASE"],[82,49,88,42],[82,69,88,62,"userId"],[82,75,88,68],[82,77,88,70],[82,79,88,72],[83,8,89,6,"method"],[83,14,89,12],[83,16,89,14],[83,21,89,19],[84,8,90,6,"headers"],[84,15,90,13],[85,8,91,6,"body"],[85,12,91,10],[85,14,91,12,"JSON"],[85,18,91,16],[85,19,91,17,"stringify"],[85,28,91,26],[85,29,91,27,"merged"],[85,35,91,33],[86,6,92,4],[86,7,92,5],[86,8,92,6],[87,6,94,4,"console"],[87,13,94,11],[87,14,94,12,"log"],[87,17,94,15],[87,18,94,16],[87,62,94,60],[87,64,94,62,"response"],[87,72,94,70],[87,73,94,71,"status"],[87,79,94,77],[87,80,94,78],[89,6,96,4],[90,6,97,4],[90,10,97,8,"response"],[90,18,97,16],[90,19,97,17,"status"],[90,25,97,23],[90,30,97,28],[90,33,97,31],[90,35,97,33],[91,8,98,6,"console"],[91,15,98,13],[91,16,98,14,"log"],[91,19,98,17],[91,20,98,18],[91,84,98,82],[91,85,98,83],[92,8,100,6,"response"],[92,16,100,14],[92,19,100,17],[92,25,100,23,"fetch"],[92,30,100,28],[92,31,100,29],[92,34,100,32,"API_BASE"],[92,38,100,40],[92,39,100,40,"API_BASE"],[92,47,100,40],[92,65,100,58],[92,67,100,60],[93,10,101,8,"method"],[93,16,101,14],[93,18,101,16],[93,24,101,22],[94,10,102,8,"headers"],[94,17,102,15],[95,10,103,8,"body"],[95,14,103,12],[95,16,103,14,"JSON"],[95,20,103,18],[95,21,103,19,"stringify"],[95,30,103,28],[95,31,103,29,"merged"],[95,37,103,35],[96,8,104,6],[96,9,104,7],[96,10,104,8],[97,8,106,6,"console"],[97,15,106,13],[97,16,106,14,"log"],[97,19,106,17],[97,20,106,18],[97,65,106,63],[97,67,106,65,"response"],[97,75,106,73],[97,76,106,74,"status"],[97,82,106,80],[97,83,106,81],[98,6,107,4],[99,6,109,4],[99,10,109,8],[99,11,109,9,"response"],[99,19,109,17],[99,20,109,18,"ok"],[99,22,109,20],[99,24,109,22],[100,8,110,6],[100,14,110,12,"errorText"],[100,23,110,21],[100,26,110,24],[100,32,110,30,"response"],[100,40,110,38],[100,41,110,39,"text"],[100,45,110,43],[100,46,110,44],[100,47,110,45],[101,8,111,6,"console"],[101,15,111,13],[101,16,111,14,"error"],[101,21,111,19],[101,22,111,20],[101,59,111,57],[101,61,111,59,"errorText"],[101,70,111,68],[101,71,111,69],[102,8,112,6],[102,14,112,12],[102,18,112,16,"Error"],[102,23,112,21],[102,24,112,22],[102,40,112,38,"response"],[102,48,112,46],[102,49,112,47,"status"],[102,55,112,53],[102,60,112,58,"errorText"],[102,69,112,67],[102,71,112,69],[102,72,112,70],[103,6,113,4],[104,6,115,4],[104,12,115,10,"result"],[104,18,115,16],[104,21,115,19],[104,27,115,25,"response"],[104,35,115,33],[104,36,115,34,"json"],[104,40,115,38],[104,41,115,39],[104,42,115,40],[105,6,116,4,"console"],[105,13,116,11],[105,14,116,12,"log"],[105,17,116,15],[105,18,116,16],[105,67,116,65],[105,69,116,67,"result"],[105,75,116,73],[105,76,116,74],[106,4,117,2],[106,5,117,3],[106,6,117,4],[106,13,117,11,"error"],[106,18,117,21],[106,20,117,23],[107,6,118,4,"console"],[107,13,118,11],[107,14,118,12,"error"],[107,19,118,17],[107,20,118,18],[107,53,118,51],[107,55,118,53,"error"],[107,60,118,58],[107,61,118,59,"message"],[107,68,118,66],[107,69,118,67],[108,6,119,4],[108,12,119,10,"error"],[108,17,119,15],[109,4,120,2],[110,2,121,0],[111,0,121,1],[111,3]],"functionMap":{"names":["<global>","getWorkerProfile","saveWorkerProfile"],"mappings":"AAA;OCK;CD6D;OEG;CFmD"},"hasCjsExports":false},"type":"js/module"}]}