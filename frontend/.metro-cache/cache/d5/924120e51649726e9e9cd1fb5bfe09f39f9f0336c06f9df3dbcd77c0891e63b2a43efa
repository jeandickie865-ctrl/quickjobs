{"dependencies":[{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":75},"end":{"line":3,"column":36,"index":111}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getWorkerProfile = getWorkerProfile;\n  exports.saveWorkerProfile = saveWorkerProfile;\n  var _storage = require(_dependencyMap[0], \"./storage\");\n  // utils/profileStore.ts\n\n  const PROFILE_KEY = '@shiftmatch:worker_profile';\n  async function getWorkerProfile(userId) {\n    console.log('üîç getWorkerProfile: Loading profile for user', userId);\n    const stored = await _storage.storage.getItem(PROFILE_KEY);\n    if (!stored) {\n      console.log('‚ö†Ô∏è getWorkerProfile: No profile found');\n      return null;\n    }\n    if (stored.userId !== userId) {\n      console.log('‚ö†Ô∏è getWorkerProfile: Profile userId mismatch', {\n        stored: stored.userId,\n        requested: userId\n      });\n      return null;\n    }\n\n    // MIGRATION: Altes Format ‚Üí Neues Format\n    let profile;\n\n    // Check if old format (has street, postalCode, city fields directly)\n    if ('street' in stored || 'postalCode' in stored || 'city' in stored) {\n      console.log('üîÑ Migrating old profile format to new format');\n      profile = {\n        userId: stored.userId,\n        categories: stored.categories ?? [],\n        selectedTags: stored.selectedTags ?? [],\n        radiusKm: stored.radiusKm ?? 15,\n        homeAddress: {\n          street: stored.street || '',\n          postalCode: stored.postalCode || '',\n          city: stored.city || '',\n          country: 'DE'\n        },\n        homeLat: stored.homeLat ?? stored.lat ?? null,\n        homeLon: stored.homeLon ?? stored.lon ?? null,\n        firstName: stored.name || stored.firstName,\n        profilePhotoUri: stored.photoUrl || stored.profilePhotoUri,\n        pushToken: stored.pushToken\n      };\n\n      // Save migrated version\n      await _storage.storage.setItem(PROFILE_KEY, profile);\n      console.log('‚úÖ Profile migrated and saved');\n    } else {\n      // Already new format\n      profile = Object.assign({}, stored, {\n        categories: stored.categories ?? [],\n        selectedTags: stored.selectedTags ?? [],\n        homeLat: stored.homeLat ?? null,\n        homeLon: stored.homeLon ?? null\n      });\n    }\n    console.log('‚úÖ getWorkerProfile: Profile loaded', {\n      userId: profile.userId,\n      categories: profile.categories.length,\n      tags: profile.selectedTags.length\n    });\n    return profile;\n  }\n  async function saveWorkerProfile(profile) {\n    console.log('üíæ saveWorkerProfile: Saving profile for user', profile.userId);\n    console.log('üíæ saveWorkerProfile: Categories:', profile.categories);\n    console.log('üíæ saveWorkerProfile: SelectedTags:', profile.selectedTags);\n\n    // Normalize profile to ensure arrays are never undefined\n    const normalized = Object.assign({}, profile, {\n      categories: profile.categories ?? [],\n      selectedTags: profile.selectedTags ?? []\n    });\n    console.log('üíæ saveWorkerProfile: Normalized tags:', normalized.selectedTags);\n    await _storage.storage.setItem(PROFILE_KEY, normalized);\n    console.log('‚úÖ saveWorkerProfile: Profile saved successfully', {\n      userId: normalized.userId,\n      categories: normalized.categories.length,\n      tags: normalized.selectedTags.length,\n      pushToken: normalized.pushToken ? '‚úì' : '‚úó'\n    });\n  }\n});","lineCount":90,"map":[[7,2,7,0,"exports"],[7,9,7,0],[7,10,7,0,"getWorkerProfile"],[7,26,7,0],[7,29,7,0,"getWorkerProfile"],[7,45,7,0],[8,2,68,0,"exports"],[8,9,68,0],[8,10,68,0,"saveWorkerProfile"],[8,27,68,0],[8,30,68,0,"saveWorkerProfile"],[8,47,68,0],[9,2,3,0],[9,6,3,0,"_storage"],[9,14,3,0],[9,17,3,0,"require"],[9,24,3,0],[9,25,3,0,"_dependencyMap"],[9,39,3,0],[10,2,1,0],[12,2,5,0],[12,8,5,6,"PROFILE_KEY"],[12,19,5,17],[12,22,5,20],[12,50,5,48],[13,2,7,7],[13,17,7,22,"getWorkerProfile"],[13,33,7,38,"getWorkerProfile"],[13,34,7,39,"userId"],[13,40,7,53],[13,42,7,86],[14,4,8,2,"console"],[14,11,8,9],[14,12,8,10,"log"],[14,15,8,13],[14,16,8,14],[14,63,8,61],[14,65,8,63,"userId"],[14,71,8,69],[14,72,8,70],[15,4,9,2],[15,10,9,8,"stored"],[15,16,9,14],[15,19,9,17],[15,25,9,23,"storage"],[15,33,9,30],[15,34,9,30,"storage"],[15,41,9,30],[15,42,9,31,"getItem"],[15,49,9,38],[15,50,9,44,"PROFILE_KEY"],[15,61,9,55],[15,62,9,56],[16,4,11,2],[16,8,11,6],[16,9,11,7,"stored"],[16,15,11,13],[16,17,11,15],[17,6,12,4,"console"],[17,13,12,11],[17,14,12,12,"log"],[17,17,12,15],[17,18,12,16],[17,57,12,55],[17,58,12,56],[18,6,13,4],[18,13,13,11],[18,17,13,15],[19,4,14,2],[20,4,16,2],[20,8,16,6,"stored"],[20,14,16,12],[20,15,16,13,"userId"],[20,21,16,19],[20,26,16,24,"userId"],[20,32,16,30],[20,34,16,32],[21,6,17,4,"console"],[21,13,17,11],[21,14,17,12,"log"],[21,17,17,15],[21,18,17,16],[21,64,17,62],[21,66,17,64],[22,8,17,66,"stored"],[22,14,17,72],[22,16,17,74,"stored"],[22,22,17,80],[22,23,17,81,"userId"],[22,29,17,87],[23,8,17,89,"requested"],[23,17,17,98],[23,19,17,100,"userId"],[24,6,17,107],[24,7,17,108],[24,8,17,109],[25,6,18,4],[25,13,18,11],[25,17,18,15],[26,4,19,2],[28,4,21,2],[29,4,22,2],[29,8,22,6,"profile"],[29,15,22,28],[31,4,24,2],[32,4,25,2],[32,8,25,6],[32,16,25,14],[32,20,25,18,"stored"],[32,26,25,24],[32,30,25,28],[32,42,25,40],[32,46,25,44,"stored"],[32,52,25,50],[32,56,25,54],[32,62,25,60],[32,66,25,64,"stored"],[32,72,25,70],[32,74,25,72],[33,6,26,4,"console"],[33,13,26,11],[33,14,26,12,"log"],[33,17,26,15],[33,18,26,16],[33,65,26,63],[33,66,26,64],[34,6,27,4,"profile"],[34,13,27,11],[34,16,27,14],[35,8,28,6,"userId"],[35,14,28,12],[35,16,28,14,"stored"],[35,22,28,20],[35,23,28,21,"userId"],[35,29,28,27],[36,8,29,6,"categories"],[36,18,29,16],[36,20,29,18,"stored"],[36,26,29,24],[36,27,29,25,"categories"],[36,37,29,35],[36,41,29,39],[36,43,29,41],[37,8,30,6,"selectedTags"],[37,20,30,18],[37,22,30,20,"stored"],[37,28,30,26],[37,29,30,27,"selectedTags"],[37,41,30,39],[37,45,30,43],[37,47,30,45],[38,8,31,6,"radiusKm"],[38,16,31,14],[38,18,31,16,"stored"],[38,24,31,22],[38,25,31,23,"radiusKm"],[38,33,31,31],[38,37,31,35],[38,39,31,37],[39,8,32,6,"homeAddress"],[39,19,32,17],[39,21,32,19],[40,10,33,8,"street"],[40,16,33,14],[40,18,33,16,"stored"],[40,24,33,22],[40,25,33,23,"street"],[40,31,33,29],[40,35,33,33],[40,37,33,35],[41,10,34,8,"postalCode"],[41,20,34,18],[41,22,34,20,"stored"],[41,28,34,26],[41,29,34,27,"postalCode"],[41,39,34,37],[41,43,34,41],[41,45,34,43],[42,10,35,8,"city"],[42,14,35,12],[42,16,35,14,"stored"],[42,22,35,20],[42,23,35,21,"city"],[42,27,35,25],[42,31,35,29],[42,33,35,31],[43,10,36,8,"country"],[43,17,36,15],[43,19,36,17],[44,8,37,6],[44,9,37,7],[45,8,38,6,"homeLat"],[45,15,38,13],[45,17,38,15,"stored"],[45,23,38,21],[45,24,38,22,"homeLat"],[45,31,38,29],[45,35,38,33,"stored"],[45,41,38,39],[45,42,38,40,"lat"],[45,45,38,43],[45,49,38,47],[45,53,38,51],[46,8,39,6,"homeLon"],[46,15,39,13],[46,17,39,15,"stored"],[46,23,39,21],[46,24,39,22,"homeLon"],[46,31,39,29],[46,35,39,33,"stored"],[46,41,39,39],[46,42,39,40,"lon"],[46,45,39,43],[46,49,39,47],[46,53,39,51],[47,8,40,6,"firstName"],[47,17,40,15],[47,19,40,17,"stored"],[47,25,40,23],[47,26,40,24,"name"],[47,30,40,28],[47,34,40,32,"stored"],[47,40,40,38],[47,41,40,39,"firstName"],[47,50,40,48],[48,8,41,6,"profilePhotoUri"],[48,23,41,21],[48,25,41,23,"stored"],[48,31,41,29],[48,32,41,30,"photoUrl"],[48,40,41,38],[48,44,41,42,"stored"],[48,50,41,48],[48,51,41,49,"profilePhotoUri"],[48,66,41,64],[49,8,42,6,"pushToken"],[49,17,42,15],[49,19,42,17,"stored"],[49,25,42,23],[49,26,42,24,"pushToken"],[50,6,43,4],[50,7,43,5],[52,6,45,4],[53,6,46,4],[53,12,46,10,"storage"],[53,20,46,17],[53,21,46,17,"storage"],[53,28,46,17],[53,29,46,18,"setItem"],[53,36,46,25],[53,37,46,26,"PROFILE_KEY"],[53,48,46,37],[53,50,46,39,"profile"],[53,57,46,46],[53,58,46,47],[54,6,47,4,"console"],[54,13,47,11],[54,14,47,12,"log"],[54,17,47,15],[54,18,47,16],[54,48,47,46],[54,49,47,47],[55,4,48,2],[55,5,48,3],[55,11,48,9],[56,6,49,4],[57,6,50,4,"profile"],[57,13,50,11],[57,16,50,11,"Object"],[57,22,50,11],[57,23,50,11,"assign"],[57,29,50,11],[57,34,51,9,"stored"],[57,40,51,15],[58,8,52,6,"categories"],[58,18,52,16],[58,20,52,18,"stored"],[58,26,52,24],[58,27,52,25,"categories"],[58,37,52,35],[58,41,52,39],[58,43,52,41],[59,8,53,6,"selectedTags"],[59,20,53,18],[59,22,53,20,"stored"],[59,28,53,26],[59,29,53,27,"selectedTags"],[59,41,53,39],[59,45,53,43],[59,47,53,45],[60,8,54,6,"homeLat"],[60,15,54,13],[60,17,54,15,"stored"],[60,23,54,21],[60,24,54,22,"homeLat"],[60,31,54,29],[60,35,54,33],[60,39,54,37],[61,8,55,6,"homeLon"],[61,15,55,13],[61,17,55,15,"stored"],[61,23,55,21],[61,24,55,22,"homeLon"],[61,31,55,29],[61,35,55,33],[62,6,55,37],[62,8,56,5],[63,4,57,2],[64,4,59,2,"console"],[64,11,59,9],[64,12,59,10,"log"],[64,15,59,13],[64,16,59,14],[64,52,59,50],[64,54,59,52],[65,6,60,4,"userId"],[65,12,60,10],[65,14,60,12,"profile"],[65,21,60,19],[65,22,60,20,"userId"],[65,28,60,26],[66,6,61,4,"categories"],[66,16,61,14],[66,18,61,16,"profile"],[66,25,61,23],[66,26,61,24,"categories"],[66,36,61,34],[66,37,61,35,"length"],[66,43,61,41],[67,6,62,4,"tags"],[67,10,62,8],[67,12,62,10,"profile"],[67,19,62,17],[67,20,62,18,"selectedTags"],[67,32,62,30],[67,33,62,31,"length"],[68,4,63,2],[68,5,63,3],[68,6,63,4],[69,4,65,2],[69,11,65,9,"profile"],[69,18,65,16],[70,2,66,0],[71,2,68,7],[71,17,68,22,"saveWorkerProfile"],[71,34,68,39,"saveWorkerProfile"],[71,35,68,40,"profile"],[71,42,68,62],[71,44,68,79],[72,4,69,2,"console"],[72,11,69,9],[72,12,69,10,"log"],[72,15,69,13],[72,16,69,14],[72,63,69,61],[72,65,69,63,"profile"],[72,72,69,70],[72,73,69,71,"userId"],[72,79,69,77],[72,80,69,78],[73,4,70,2,"console"],[73,11,70,9],[73,12,70,10,"log"],[73,15,70,13],[73,16,70,14],[73,51,70,49],[73,53,70,51,"profile"],[73,60,70,58],[73,61,70,59,"categories"],[73,71,70,69],[73,72,70,70],[74,4,71,2,"console"],[74,11,71,9],[74,12,71,10,"log"],[74,15,71,13],[74,16,71,14],[74,53,71,51],[74,55,71,53,"profile"],[74,62,71,60],[74,63,71,61,"selectedTags"],[74,75,71,73],[74,76,71,74],[76,4,73,2],[77,4,74,2],[77,10,74,8,"normalized"],[77,20,74,33],[77,23,74,33,"Object"],[77,29,74,33],[77,30,74,33,"assign"],[77,36,74,33],[77,41,75,7,"profile"],[77,48,75,14],[78,6,76,4,"categories"],[78,16,76,14],[78,18,76,16,"profile"],[78,25,76,23],[78,26,76,24,"categories"],[78,36,76,34],[78,40,76,38],[78,42,76,40],[79,6,77,4,"selectedTags"],[79,18,77,16],[79,20,77,18,"profile"],[79,27,77,25],[79,28,77,26,"selectedTags"],[79,40,77,38],[79,44,77,42],[80,4,77,44],[80,6,78,3],[81,4,80,2,"console"],[81,11,80,9],[81,12,80,10,"log"],[81,15,80,13],[81,16,80,14],[81,56,80,54],[81,58,80,56,"normalized"],[81,68,80,66],[81,69,80,67,"selectedTags"],[81,81,80,79],[81,82,80,80],[82,4,82,2],[82,10,82,8,"storage"],[82,18,82,15],[82,19,82,15,"storage"],[82,26,82,15],[82,27,82,16,"setItem"],[82,34,82,23],[82,35,82,24,"PROFILE_KEY"],[82,46,82,35],[82,48,82,37,"normalized"],[82,58,82,47],[82,59,82,48],[83,4,83,2,"console"],[83,11,83,9],[83,12,83,10,"log"],[83,15,83,13],[83,16,83,14],[83,65,83,63],[83,67,83,65],[84,6,84,4,"userId"],[84,12,84,10],[84,14,84,12,"normalized"],[84,24,84,22],[84,25,84,23,"userId"],[84,31,84,29],[85,6,85,4,"categories"],[85,16,85,14],[85,18,85,16,"normalized"],[85,28,85,26],[85,29,85,27,"categories"],[85,39,85,37],[85,40,85,38,"length"],[85,46,85,44],[86,6,86,4,"tags"],[86,10,86,8],[86,12,86,10,"normalized"],[86,22,86,20],[86,23,86,21,"selectedTags"],[86,35,86,33],[86,36,86,34,"length"],[86,42,86,40],[87,6,87,4,"pushToken"],[87,15,87,13],[87,17,87,15,"normalized"],[87,27,87,25],[87,28,87,26,"pushToken"],[87,37,87,35],[87,40,87,38],[87,43,87,41],[87,46,87,44],[88,4,88,2],[88,5,88,3],[88,6,88,4],[89,2,89,0],[90,0,89,1],[90,3]],"functionMap":{"names":["<global>","getWorkerProfile","saveWorkerProfile"],"mappings":"AAA;OCM;CD2D;OEE"},"hasCjsExports":false},"type":"js/module"}]}