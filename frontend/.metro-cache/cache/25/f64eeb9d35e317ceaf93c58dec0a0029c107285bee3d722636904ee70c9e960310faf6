{"dependencies":[{"name":"./distance","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":151},"end":{"line":4,"column":47,"index":198}}],"key":"iycZ8wRItk4OOQEBVmvrrq3ooL8=","exportNames":["*"],"imports":1}},{"name":"./normalizeAddress","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":199},"end":{"line":5,"column":54,"index":253}}],"key":"m3UysYDWsYidjBqN8dpi7aXnojU=","exportNames":["*"],"imports":1}},{"name":"../types/address","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":254},"end":{"line":6,"column":49,"index":303}}],"key":"RVJOe6JSBSaA+pZyb/fapuHyuxI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.nearbyJobs = nearbyJobs;\n  var _distance = require(_dependencyMap[0], \"./distance\");\n  var _normalizeAddress = require(_dependencyMap[1], \"./normalizeAddress\");\n  var _typesAddress = require(_dependencyMap[2], \"../types/address\");\n  // utils/nearbyJobs.ts - MATCHING 2.2 (Extended Security Checks)\n\n  // Security Tags (alle werden geprüft)\n  var SECURITY_SACHKUNDE = \"Sachkunde nach § 34a GewO\";\n  var SECURITY_UNTERRICHTUNG = \"Unterrichtung nach § 34a GewO\";\n  var SECURITY_BEWACHER_ID = \"Bewacher-ID\";\n  var SECURITY_FUEHRUNGSZEUGNIS = \"Polizeiliches Führungszeugnis\";\n  /**\n   * Get jobs near the worker with distance info and disabled state\n   * MATCHING 2.0 - Simple nearby jobs view\n   */\n  function nearbyJobs(jobs, worker) {\n    var workerSkills = worker.selectedTags || [];\n    return jobs.map(function (job) {\n      var _job$address;\n      // Calculate distance\n      var distance = (0, _distance.calculateDistance)({\n        lat: job.lat,\n        lon: job.lon\n      }, {\n        lat: worker.homeLat,\n        lon: worker.homeLon\n      });\n\n      // Check all security requirements (MATCHING 2.2)\n      var jobTags = job.required_all_tags || [];\n      var missingSecuritySkill;\n\n      // Sachkunde §34a\n      if (jobTags.includes(SECURITY_SACHKUNDE) && !workerSkills.includes(SECURITY_SACHKUNDE)) {\n        missingSecuritySkill = \"Sachkunde § 34a\";\n      }\n\n      // Unterrichtung §34a (oder Sachkunde)\n      if (jobTags.includes(SECURITY_UNTERRICHTUNG)) {\n        var hasUnterrichtung = workerSkills.includes(SECURITY_UNTERRICHTUNG);\n        var hasSachkunde = workerSkills.includes(SECURITY_SACHKUNDE);\n        if (!hasUnterrichtung && !hasSachkunde) {\n          missingSecuritySkill = \"Unterrichtung § 34a\";\n        }\n      }\n\n      // Bewacher-ID\n      if (jobTags.includes(SECURITY_BEWACHER_ID) && !workerSkills.includes(SECURITY_BEWACHER_ID)) {\n        missingSecuritySkill = \"Bewacher-ID\";\n      }\n\n      // Polizeiliches Führungszeugnis\n      if (jobTags.includes(SECURITY_FUEHRUNGSZEUGNIS) && !workerSkills.includes(SECURITY_FUEHRUNGSZEUGNIS)) {\n        missingSecuritySkill = \"Polizeiliches Führungszeugnis\";\n      }\n\n      // Determine disabled state and reason\n      var disabled = distance > worker.radiusKm || !!missingSecuritySkill;\n      var disabledReason;\n      if (distance > worker.radiusKm) {\n        disabledReason = \"Außerhalb deines Radius\";\n      } else if (missingSecuritySkill) {\n        disabledReason = `Erfordert ${missingSecuritySkill}`;\n      }\n\n      // Normalize address\n      var normalizedAddress = (0, _typesAddress.formatAddress)(job.address, true) || (0, _normalizeAddress.normalizeAddress)(((_job$address = job.address) == null ? void 0 : _job$address.city) || \"\");\n      return Object.assign({}, job, {\n        distance: distance,\n        normalizedAddress: normalizedAddress,\n        disabled: disabled,\n        disabledReason: disabledReason\n      });\n    }).sort(function (a, b) {\n      return a.distance - b.distance;\n    }); // Sort by distance (closest first)\n  }\n});","lineCount":84,"map":[[7,2,26,0,"exports"],[7,9,26,0],[7,10,26,0,"nearbyJobs"],[7,20,26,0],[7,23,26,0,"nearbyJobs"],[7,33,26,0],[8,2,4,0],[8,6,4,0,"_distance"],[8,15,4,0],[8,18,4,0,"require"],[8,25,4,0],[8,26,4,0,"_dependencyMap"],[8,40,4,0],[9,2,5,0],[9,6,5,0,"_normalizeAddress"],[9,23,5,0],[9,26,5,0,"require"],[9,33,5,0],[9,34,5,0,"_dependencyMap"],[9,48,5,0],[10,2,6,0],[10,6,6,0,"_typesAddress"],[10,19,6,0],[10,22,6,0,"require"],[10,29,6,0],[10,30,6,0,"_dependencyMap"],[10,44,6,0],[11,2,1,0],[13,2,9,0],[14,2,10,0],[14,6,10,6,"SECURITY_SACHKUNDE"],[14,24,10,24],[14,27,10,27],[14,54,10,54],[15,2,11,0],[15,6,11,6,"SECURITY_UNTERRICHTUNG"],[15,28,11,28],[15,31,11,31],[15,62,11,62],[16,2,12,0],[16,6,12,6,"SECURITY_BEWACHER_ID"],[16,26,12,26],[16,29,12,29],[16,42,12,42],[17,2,13,0],[17,6,13,6,"SECURITY_FUEHRUNGSZEUGNIS"],[17,31,13,31],[17,34,13,34],[17,65,13,65],[18,2,22,0],[19,0,23,0],[20,0,24,0],[21,0,25,0],[22,2,26,7],[22,11,26,16,"nearbyJobs"],[22,21,26,26,"nearbyJobs"],[22,22,27,2,"jobs"],[22,26,27,13],[22,28,28,2,"worker"],[22,34,28,23],[22,36,29,15],[23,4,30,2],[23,8,30,8,"workerSkills"],[23,20,30,20],[23,23,30,23,"worker"],[23,29,30,29],[23,30,30,30,"selectedTags"],[23,42,30,42],[23,46,30,46],[23,48,30,48],[24,4,32,2],[24,11,32,9,"jobs"],[24,15,32,13],[24,16,33,5,"map"],[24,19,33,8],[24,20,33,9],[24,30,33,9,"job"],[24,33,33,12],[24,35,33,16],[25,6,33,16],[25,10,33,16,"_job$address"],[25,22,33,16],[26,6,34,6],[27,6,35,6],[27,10,35,12,"distance"],[27,18,35,20],[27,21,35,23],[27,25,35,23,"calculateDistance"],[27,34,35,40],[27,35,35,40,"calculateDistance"],[27,52,35,40],[27,54,36,8],[28,8,36,10,"lat"],[28,11,36,13],[28,13,36,15,"job"],[28,16,36,18],[28,17,36,19,"lat"],[28,20,36,22],[29,8,36,24,"lon"],[29,11,36,27],[29,13,36,29,"job"],[29,16,36,32],[29,17,36,33,"lon"],[30,6,36,37],[30,7,36,38],[30,9,37,8],[31,8,37,10,"lat"],[31,11,37,13],[31,13,37,15,"worker"],[31,19,37,21],[31,20,37,22,"homeLat"],[31,27,37,29],[32,8,37,31,"lon"],[32,11,37,34],[32,13,37,36,"worker"],[32,19,37,42],[32,20,37,43,"homeLon"],[33,6,37,51],[33,7,38,6],[33,8,38,7],[35,6,40,6],[36,6,41,6],[36,10,41,12,"jobTags"],[36,17,41,19],[36,20,41,22,"job"],[36,23,41,25],[36,24,41,26,"required_all_tags"],[36,41,41,43],[36,45,41,47],[36,47,41,49],[37,6,43,6],[37,10,43,10,"missingSecuritySkill"],[37,30,43,50],[39,6,45,6],[40,6,46,6],[40,10,46,10,"jobTags"],[40,17,46,17],[40,18,46,18,"includes"],[40,26,46,26],[40,27,46,27,"SECURITY_SACHKUNDE"],[40,45,46,45],[40,46,46,46],[40,50,46,50],[40,51,46,51,"workerSkills"],[40,63,46,63],[40,64,46,64,"includes"],[40,72,46,72],[40,73,46,73,"SECURITY_SACHKUNDE"],[40,91,46,91],[40,92,46,92],[40,94,46,94],[41,8,47,8,"missingSecuritySkill"],[41,28,47,28],[41,31,47,31],[41,48,47,48],[42,6,48,6],[44,6,50,6],[45,6,51,6],[45,10,51,10,"jobTags"],[45,17,51,17],[45,18,51,18,"includes"],[45,26,51,26],[45,27,51,27,"SECURITY_UNTERRICHTUNG"],[45,49,51,49],[45,50,51,50],[45,52,51,52],[46,8,52,8],[46,12,52,14,"hasUnterrichtung"],[46,28,52,30],[46,31,52,33,"workerSkills"],[46,43,52,45],[46,44,52,46,"includes"],[46,52,52,54],[46,53,52,55,"SECURITY_UNTERRICHTUNG"],[46,75,52,77],[46,76,52,78],[47,8,53,8],[47,12,53,14,"hasSachkunde"],[47,24,53,26],[47,27,53,29,"workerSkills"],[47,39,53,41],[47,40,53,42,"includes"],[47,48,53,50],[47,49,53,51,"SECURITY_SACHKUNDE"],[47,67,53,69],[47,68,53,70],[48,8,54,8],[48,12,54,12],[48,13,54,13,"hasUnterrichtung"],[48,29,54,29],[48,33,54,33],[48,34,54,34,"hasSachkunde"],[48,46,54,46],[48,48,54,48],[49,10,55,10,"missingSecuritySkill"],[49,30,55,30],[49,33,55,33],[49,54,55,54],[50,8,56,8],[51,6,57,6],[53,6,59,6],[54,6,60,6],[54,10,60,10,"jobTags"],[54,17,60,17],[54,18,60,18,"includes"],[54,26,60,26],[54,27,60,27,"SECURITY_BEWACHER_ID"],[54,47,60,47],[54,48,60,48],[54,52,60,52],[54,53,60,53,"workerSkills"],[54,65,60,65],[54,66,60,66,"includes"],[54,74,60,74],[54,75,60,75,"SECURITY_BEWACHER_ID"],[54,95,60,95],[54,96,60,96],[54,98,60,98],[55,8,61,8,"missingSecuritySkill"],[55,28,61,28],[55,31,61,31],[55,44,61,44],[56,6,62,6],[58,6,64,6],[59,6,65,6],[59,10,65,10,"jobTags"],[59,17,65,17],[59,18,65,18,"includes"],[59,26,65,26],[59,27,65,27,"SECURITY_FUEHRUNGSZEUGNIS"],[59,52,65,52],[59,53,65,53],[59,57,65,57],[59,58,65,58,"workerSkills"],[59,70,65,70],[59,71,65,71,"includes"],[59,79,65,79],[59,80,65,80,"SECURITY_FUEHRUNGSZEUGNIS"],[59,105,65,105],[59,106,65,106],[59,108,65,108],[60,8,66,8,"missingSecuritySkill"],[60,28,66,28],[60,31,66,31],[60,62,66,62],[61,6,67,6],[63,6,69,6],[64,6,70,6],[64,10,70,12,"disabled"],[64,18,70,20],[64,21,70,23,"distance"],[64,29,70,31],[64,32,70,34,"worker"],[64,38,70,40],[64,39,70,41,"radiusKm"],[64,47,70,49],[64,51,70,53],[64,52,70,54],[64,53,70,55,"missingSecuritySkill"],[64,73,70,75],[65,6,72,6],[65,10,72,10,"disabledReason"],[65,24,72,44],[66,6,73,6],[66,10,73,10,"distance"],[66,18,73,18],[66,21,73,21,"worker"],[66,27,73,27],[66,28,73,28,"radiusKm"],[66,36,73,36],[66,38,73,38],[67,8,74,8,"disabledReason"],[67,22,74,22],[67,25,74,25],[67,50,74,50],[68,6,75,6],[68,7,75,7],[68,13,75,13],[68,17,75,17,"missingSecuritySkill"],[68,37,75,37],[68,39,75,39],[69,8,76,8,"disabledReason"],[69,22,76,22],[69,25,76,25],[69,38,76,38,"missingSecuritySkill"],[69,58,76,58],[69,60,76,60],[70,6,77,6],[72,6,79,6],[73,6,80,6],[73,10,80,12,"normalizedAddress"],[73,27,80,29],[73,30,80,32],[73,34,80,32,"formatAddress"],[73,47,80,45],[73,48,80,45,"formatAddress"],[73,61,80,45],[73,63,80,46,"job"],[73,66,80,49],[73,67,80,50,"address"],[73,74,80,57],[73,76,80,59],[73,80,80,63],[73,81,80,64],[73,85,81,32],[73,89,81,32,"normalizeAddress"],[73,106,81,48],[73,107,81,48,"normalizeAddress"],[73,123,81,48],[73,125,81,49],[73,127,81,49,"_job$address"],[73,139,81,49],[73,142,81,49,"job"],[73,145,81,52],[73,146,81,53,"address"],[73,153,81,60],[73,174,81,49,"_job$address"],[73,186,81,49],[73,187,81,62,"city"],[73,191,81,66],[73,196,81,70],[73,198,81,72],[73,199,81,73],[74,6,83,6],[74,13,83,6,"Object"],[74,19,83,6],[74,20,83,6,"assign"],[74,26,83,6],[74,31,84,11,"job"],[74,34,84,14],[75,8,85,8,"distance"],[75,16,85,16],[75,18,85,8,"distance"],[75,26,85,16],[76,8,86,8,"normalizedAddress"],[76,25,86,25],[76,27,86,8,"normalizedAddress"],[76,44,86,25],[77,8,87,8,"disabled"],[77,16,87,16],[77,18,87,8,"disabled"],[77,26,87,16],[78,8,88,8,"disabledReason"],[78,22,88,22],[78,24,88,8,"disabledReason"],[79,6,88,22],[80,4,90,4],[80,5,90,5],[80,6,90,6],[80,7,91,5,"sort"],[80,11,91,9],[80,12,91,10],[80,22,91,11,"a"],[80,23,91,12],[80,25,91,14,"b"],[80,26,91,15],[81,6,91,15],[81,13,91,20,"a"],[81,14,91,21],[81,15,91,22,"distance"],[81,23,91,30],[81,26,91,33,"b"],[81,27,91,34],[81,28,91,35,"distance"],[81,36,91,43],[82,4,91,43],[82,6,91,44],[82,7,91,45],[82,8,91,46],[83,2,92,0],[84,0,92,1],[84,3]],"functionMap":{"names":["<global>","nearbyJobs","jobs.map$argument_0","jobs.map.sort$argument_0"],"mappings":"AAA;OCyB;SCO;KDyD;UEC,iCF;CDC"},"hasCjsExports":false},"type":"js/module"}]}