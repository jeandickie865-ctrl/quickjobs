{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":28},"end":{"line":9,"column":15,"index":139}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../utils/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":10,"column":0,"index":140},"end":{"line":10,"column":64,"index":204}}],"key":"rswhtWQFlk40P6/ZSXiz3NZSC0I=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(); // contexts/AuthContext.tsx\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _utilsStorage = require(_dependencyMap[1], \"../utils/storage\");\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const USER_KEY = '@shiftmatch:user';\n  const CREDENTIALS_KEY = '@shiftmatch:auth_users';\n  async function loadCredentials() {\n    const data = await (0, _utilsStorage.getItem)(CREDENTIALS_KEY);\n    return data ?? [];\n  }\n  async function saveCredentials(creds) {\n    await (0, _utilsStorage.setItem)(CREDENTIALS_KEY, creds);\n  }\n  const AuthProvider = ({\n    children\n  }) => {\n    _s();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n\n    // beim Start User aus Storage holen\n    (0, _react.useEffect)(() => {\n      (async () => {\n        const stored = await (0, _utilsStorage.getItem)(USER_KEY);\n        if (stored) {\n          setUser(stored);\n        }\n        setIsLoading(false);\n      })();\n    }, []);\n    const value = (0, _react.useMemo)(() => {\n      return {\n        user,\n        isLoading,\n        async signUp(email, password) {\n          const creds = await loadCredentials();\n          const exists = creds.find(c => c.email.toLowerCase() === email.toLowerCase());\n          if (exists) {\n            throw new Error('E-Mail ist bereits registriert');\n          }\n          const newUser = {\n            id: 'u-' + Date.now().toString(),\n            email\n          };\n          const nextCreds = [...creds, {\n            email: email.toLowerCase(),\n            password\n          }];\n          await saveCredentials(nextCreds);\n          await (0, _utilsStorage.setItem)(USER_KEY, newUser);\n          setUser(newUser);\n        },\n        async signIn(email, password) {\n          const creds = await loadCredentials();\n          const found = creds.find(c => c.email.toLowerCase() === email.toLowerCase());\n          if (!found || found.password !== password) {\n            throw new Error('E-Mail oder Passwort ist falsch');\n          }\n\n          // Wenn es schon einen gespeicherten User mit Rolle gibt, nutze ihn\n          const stored = await (0, _utilsStorage.getItem)(USER_KEY);\n          if (stored && stored.email.toLowerCase() === email.toLowerCase()) {\n            setUser(stored);\n            return;\n          }\n\n          // Sonst neuen User ohne Rolle anlegen\n          const newUser = {\n            id: 'u-' + Date.now().toString(),\n            email\n          };\n          await (0, _utilsStorage.setItem)(USER_KEY, newUser);\n          setUser(newUser);\n        },\n        async signOut() {\n          setUser(null);\n          await (0, _utilsStorage.removeItem)(USER_KEY);\n        },\n        async setRole(role) {\n          if (!user) return;\n          const updated = {\n            id: user.id,\n            email: user.email,\n            role,\n            accountType: user.accountType\n          };\n          await (0, _utilsStorage.setItem)(USER_KEY, updated);\n          setUser(updated);\n        }\n      };\n    }, [user, isLoading]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: value,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 10\n    }, this);\n  };\n  _s(AuthProvider, \"8wer8K7tMZqmv8b7mqDHs9YXPbQ=\");\n  _c = AuthProvider;\n  function useAuth() {\n    _s2();\n    const ctx = (0, _react.useContext)(AuthContext);\n    if (!ctx) {\n      throw new Error('AuthProvider fehlt');\n    }\n    return ctx;\n  }\n  _s2(useAuth, \"/dMy7t63NXD4eYACoT93CePwGrg=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":130,"map":[[6,26,1,0],[7,2,1,0,"Object"],[7,8,1,0],[7,9,1,0,"defineProperty"],[7,23,1,0],[7,24,1,0,"exports"],[7,31,1,0],[8,4,1,0,"value"],[8,9,1,0],[9,2,1,0],[10,2,56,0,"Object"],[10,8,56,0],[10,9,56,0,"defineProperty"],[10,23,56,0],[10,24,56,0,"exports"],[10,31,56,0],[11,4,56,0,"enumerable"],[11,14,56,0],[12,4,56,0,"get"],[12,7,56,0],[12,18,56,0,"get"],[12,19,56,0],[13,6,56,0],[13,13,56,0,"AuthProvider"],[13,25,56,0],[14,4,56,0],[15,2,56,0],[16,2,143,0,"exports"],[16,9,143,0],[16,10,143,0,"useAuth"],[16,17,143,0],[16,20,143,0,"useAuth"],[16,27,143,0],[17,2,2,0],[17,6,2,0,"_react"],[17,12,2,0],[17,15,2,0,"require"],[17,22,2,0],[17,23,2,0,"_dependencyMap"],[17,37,2,0],[18,2,10,0],[18,6,10,0,"_utilsStorage"],[18,19,10,0],[18,22,10,0,"require"],[18,29,10,0],[18,30,10,0,"_dependencyMap"],[18,44,10,0],[19,2,10,64],[19,6,10,64,"_reactJsxDevRuntime"],[19,25,10,64],[19,28,10,64,"require"],[19,35,10,64],[19,36,10,64,"_dependencyMap"],[19,50,10,64],[20,2,30,0],[20,8,30,6,"AuthContext"],[20,19,30,17],[20,35,30,20],[20,39,30,20,"createContext"],[20,45,30,33],[20,46,30,33,"createContext"],[20,59,30,33],[20,61,30,64,"undefined"],[20,70,30,73],[20,71,30,74],[21,2,32,0],[21,8,32,6,"USER_KEY"],[21,16,32,14],[21,19,32,17],[21,37,32,35],[22,2,33,0],[22,8,33,6,"CREDENTIALS_KEY"],[22,23,33,21],[22,26,33,24],[22,50,33,48],[23,2,47,0],[23,17,47,15,"loadCredentials"],[23,32,47,30,"loadCredentials"],[23,33,47,30],[23,35,47,61],[24,4,48,2],[24,10,48,8,"data"],[24,14,48,12],[24,17,48,15],[24,23,48,21],[24,27,48,21,"getItem"],[24,40,48,28],[24,41,48,28,"getItem"],[24,48,48,28],[24,50,48,48,"CREDENTIALS_KEY"],[24,65,48,63],[24,66,48,64],[25,4,49,2],[25,11,49,9,"data"],[25,15,49,13],[25,19,49,17],[25,21,49,19],[26,2,50,0],[27,2,52,0],[27,17,52,15,"saveCredentials"],[27,32,52,30,"saveCredentials"],[27,33,52,31,"creds"],[27,38,52,55],[27,40,52,72],[28,4,53,2],[28,10,53,8],[28,14,53,8,"setItem"],[28,27,53,15],[28,28,53,15,"setItem"],[28,35,53,15],[28,37,53,16,"CREDENTIALS_KEY"],[28,52,53,31],[28,54,53,33,"creds"],[28,59,53,38],[28,60,53,39],[29,2,54,0],[30,2,56,7],[30,8,56,13,"AuthProvider"],[30,20,56,60],[30,23,56,63,"AuthProvider"],[30,24,56,64],[31,4,56,66,"children"],[32,2,56,75],[32,3,56,76],[32,8,56,81],[33,4,56,81,"_s"],[33,6,56,81],[34,4,57,2],[34,10,57,8],[34,11,57,9,"user"],[34,15,57,13],[34,17,57,15,"setUser"],[34,24,57,22],[34,25,57,23],[34,28,57,26],[34,32,57,26,"useState"],[34,38,57,34],[34,39,57,34,"useState"],[34,47,57,34],[34,49,57,41],[34,53,57,45],[34,54,57,46],[35,4,58,2],[35,10,58,8],[35,11,58,9,"isLoading"],[35,20,58,18],[35,22,58,20,"setIsLoading"],[35,34,58,32],[35,35,58,33],[35,38,58,36],[35,42,58,36,"useState"],[35,48,58,44],[35,49,58,44,"useState"],[35,57,58,44],[35,59,58,45],[35,63,58,49],[35,64,58,50],[37,4,60,2],[38,4,61,2],[38,8,61,2,"useEffect"],[38,14,61,11],[38,15,61,11,"useEffect"],[38,24,61,11],[38,26,61,12],[38,32,61,18],[39,6,62,4],[39,7,62,5],[39,19,62,17],[40,8,63,6],[40,14,63,12,"stored"],[40,20,63,18],[40,23,63,21],[40,29,63,27],[40,33,63,27,"getItem"],[40,46,63,34],[40,47,63,34,"getItem"],[40,54,63,34],[40,56,63,47,"USER_KEY"],[40,64,63,55],[40,65,63,56],[41,8,64,6],[41,12,64,10,"stored"],[41,18,64,16],[41,20,64,18],[42,10,65,8,"setUser"],[42,17,65,15],[42,18,65,16,"stored"],[42,24,65,22],[42,25,65,23],[43,8,66,6],[44,8,67,6,"setIsLoading"],[44,20,67,18],[44,21,67,19],[44,26,67,24],[44,27,67,25],[45,6,68,4],[45,7,68,5],[45,9,68,7],[45,10,68,8],[46,4,69,2],[46,5,69,3],[46,7,69,5],[46,9,69,7],[46,10,69,8],[47,4,71,2],[47,10,71,8,"value"],[47,15,71,13],[47,18,71,16],[47,22,71,16,"useMemo"],[47,28,71,23],[47,29,71,23,"useMemo"],[47,36,71,23],[47,38,71,42],[47,44,71,48],[48,6,72,4],[48,13,72,11],[49,8,73,6,"user"],[49,12,73,10],[50,8,74,6,"isLoading"],[50,17,74,15],[51,8,76,6],[51,14,76,12,"signUp"],[51,20,76,18,"signUp"],[51,21,76,19,"email"],[51,26,76,24],[51,28,76,26,"password"],[51,36,76,34],[51,38,76,36],[52,10,77,8],[52,16,77,14,"creds"],[52,21,77,19],[52,24,77,22],[52,30,77,28,"loadCredentials"],[52,45,77,43],[52,46,77,44],[52,47,77,45],[53,10,78,8],[53,16,78,14,"exists"],[53,22,78,20],[53,25,78,23,"creds"],[53,30,78,28],[53,31,78,29,"find"],[53,35,78,33],[53,36,78,34,"c"],[53,37,78,35],[53,41,78,39,"c"],[53,42,78,40],[53,43,78,41,"email"],[53,48,78,46],[53,49,78,47,"toLowerCase"],[53,60,78,58],[53,61,78,59],[53,62,78,60],[53,67,78,65,"email"],[53,72,78,70],[53,73,78,71,"toLowerCase"],[53,84,78,82],[53,85,78,83],[53,86,78,84],[53,87,78,85],[54,10,79,8],[54,14,79,12,"exists"],[54,20,79,18],[54,22,79,20],[55,12,80,10],[55,18,80,16],[55,22,80,20,"Error"],[55,27,80,25],[55,28,80,26],[55,60,80,58],[55,61,80,59],[56,10,81,8],[57,10,83,8],[57,16,83,14,"newUser"],[57,23,83,33],[57,26,83,36],[58,12,84,10,"id"],[58,14,84,12],[58,16,84,14],[58,20,84,18],[58,23,84,21,"Date"],[58,27,84,25],[58,28,84,26,"now"],[58,31,84,29],[58,32,84,30],[58,33,84,31],[58,34,84,32,"toString"],[58,42,84,40],[58,43,84,41],[58,44,84,42],[59,12,85,10,"email"],[60,10,86,8],[60,11,86,9],[61,10,88,8],[61,16,88,14,"nextCreds"],[61,25,88,42],[61,28,88,45],[61,29,89,10],[61,32,89,13,"creds"],[61,37,89,18],[61,39,90,10],[62,12,90,12,"email"],[62,17,90,17],[62,19,90,19,"email"],[62,24,90,24],[62,25,90,25,"toLowerCase"],[62,36,90,36],[62,37,90,37],[62,38,90,38],[63,12,90,40,"password"],[64,10,90,49],[64,11,90,50],[64,12,91,9],[65,10,93,8],[65,16,93,14,"saveCredentials"],[65,31,93,29],[65,32,93,30,"nextCreds"],[65,41,93,39],[65,42,93,40],[66,10,94,8],[66,16,94,14],[66,20,94,14,"setItem"],[66,33,94,21],[66,34,94,21,"setItem"],[66,41,94,21],[66,43,94,22,"USER_KEY"],[66,51,94,30],[66,53,94,32,"newUser"],[66,60,94,39],[66,61,94,40],[67,10,95,8,"setUser"],[67,17,95,15],[67,18,95,16,"newUser"],[67,25,95,23],[67,26,95,24],[68,8,96,6],[68,9,96,7],[69,8,98,6],[69,14,98,12,"signIn"],[69,20,98,18,"signIn"],[69,21,98,19,"email"],[69,26,98,24],[69,28,98,26,"password"],[69,36,98,34],[69,38,98,36],[70,10,99,8],[70,16,99,14,"creds"],[70,21,99,19],[70,24,99,22],[70,30,99,28,"loadCredentials"],[70,45,99,43],[70,46,99,44],[70,47,99,45],[71,10,100,8],[71,16,100,14,"found"],[71,21,100,19],[71,24,100,22,"creds"],[71,29,100,27],[71,30,100,28,"find"],[71,34,100,32],[71,35,100,33,"c"],[71,36,100,34],[71,40,100,38,"c"],[71,41,100,39],[71,42,100,40,"email"],[71,47,100,45],[71,48,100,46,"toLowerCase"],[71,59,100,57],[71,60,100,58],[71,61,100,59],[71,66,100,64,"email"],[71,71,100,69],[71,72,100,70,"toLowerCase"],[71,83,100,81],[71,84,100,82],[71,85,100,83],[71,86,100,84],[72,10,101,8],[72,14,101,12],[72,15,101,13,"found"],[72,20,101,18],[72,24,101,22,"found"],[72,29,101,27],[72,30,101,28,"password"],[72,38,101,36],[72,43,101,41,"password"],[72,51,101,49],[72,53,101,51],[73,12,102,10],[73,18,102,16],[73,22,102,20,"Error"],[73,27,102,25],[73,28,102,26],[73,61,102,59],[73,62,102,60],[74,10,103,8],[76,10,105,8],[77,10,106,8],[77,16,106,14,"stored"],[77,22,106,20],[77,25,106,23],[77,31,106,29],[77,35,106,29,"getItem"],[77,48,106,36],[77,49,106,36,"getItem"],[77,56,106,36],[77,58,106,49,"USER_KEY"],[77,66,106,57],[77,67,106,58],[78,10,107,8],[78,14,107,12,"stored"],[78,20,107,18],[78,24,107,22,"stored"],[78,30,107,28],[78,31,107,29,"email"],[78,36,107,34],[78,37,107,35,"toLowerCase"],[78,48,107,46],[78,49,107,47],[78,50,107,48],[78,55,107,53,"email"],[78,60,107,58],[78,61,107,59,"toLowerCase"],[78,72,107,70],[78,73,107,71],[78,74,107,72],[78,76,107,74],[79,12,108,10,"setUser"],[79,19,108,17],[79,20,108,18,"stored"],[79,26,108,24],[79,27,108,25],[80,12,109,10],[81,10,110,8],[83,10,112,8],[84,10,113,8],[84,16,113,14,"newUser"],[84,23,113,33],[84,26,113,36],[85,12,114,10,"id"],[85,14,114,12],[85,16,114,14],[85,20,114,18],[85,23,114,21,"Date"],[85,27,114,25],[85,28,114,26,"now"],[85,31,114,29],[85,32,114,30],[85,33,114,31],[85,34,114,32,"toString"],[85,42,114,40],[85,43,114,41],[85,44,114,42],[86,12,115,10,"email"],[87,10,116,8],[87,11,116,9],[88,10,117,8],[88,16,117,14],[88,20,117,14,"setItem"],[88,33,117,21],[88,34,117,21,"setItem"],[88,41,117,21],[88,43,117,22,"USER_KEY"],[88,51,117,30],[88,53,117,32,"newUser"],[88,60,117,39],[88,61,117,40],[89,10,118,8,"setUser"],[89,17,118,15],[89,18,118,16,"newUser"],[89,25,118,23],[89,26,118,24],[90,8,119,6],[90,9,119,7],[91,8,121,6],[91,14,121,12,"signOut"],[91,21,121,19,"signOut"],[91,22,121,19],[91,24,121,22],[92,10,122,8,"setUser"],[92,17,122,15],[92,18,122,16],[92,22,122,20],[92,23,122,21],[93,10,123,8],[93,16,123,14],[93,20,123,14,"removeItem"],[93,33,123,24],[93,34,123,24,"removeItem"],[93,44,123,24],[93,46,123,25,"USER_KEY"],[93,54,123,33],[93,55,123,34],[94,8,124,6],[94,9,124,7],[95,8,126,6],[95,14,126,12,"setRole"],[95,21,126,19,"setRole"],[95,22,126,20,"role"],[95,26,126,24],[95,28,126,26],[96,10,127,8],[96,14,127,12],[96,15,127,13,"user"],[96,19,127,17],[96,21,127,19],[97,10,128,8],[97,16,128,14,"updated"],[97,23,128,33],[97,26,128,36],[98,12,129,10,"id"],[98,14,129,12],[98,16,129,14,"user"],[98,20,129,18],[98,21,129,19,"id"],[98,23,129,21],[99,12,130,10,"email"],[99,17,130,15],[99,19,130,17,"user"],[99,23,130,21],[99,24,130,22,"email"],[99,29,130,27],[100,12,131,10,"role"],[100,16,131,14],[101,12,132,10,"accountType"],[101,23,132,21],[101,25,132,23,"user"],[101,29,132,27],[101,30,132,28,"accountType"],[102,10,133,8],[102,11,133,9],[103,10,134,8],[103,16,134,14],[103,20,134,14,"setItem"],[103,33,134,21],[103,34,134,21,"setItem"],[103,41,134,21],[103,43,134,22,"USER_KEY"],[103,51,134,30],[103,53,134,32,"updated"],[103,60,134,39],[103,61,134,40],[104,10,135,8,"setUser"],[104,17,135,15],[104,18,135,16,"updated"],[104,25,135,23],[104,26,135,24],[105,8,136,6],[106,6,137,4],[106,7,137,5],[107,4,138,2],[107,5,138,3],[107,7,138,5],[107,8,138,6,"user"],[107,12,138,10],[107,14,138,12,"isLoading"],[107,23,138,21],[107,24,138,22],[107,25,138,23],[108,4,140,2],[108,24,140,9],[108,28,140,9,"_reactJsxDevRuntime"],[108,47,140,9],[108,48,140,9,"jsxDEV"],[108,54,140,9],[108,56,140,10,"AuthContext"],[108,67,140,21],[108,68,140,22,"Provider"],[108,76,140,30],[109,6,140,31,"value"],[109,11,140,36],[109,13,140,38,"value"],[109,18,140,44],[110,6,140,44,"children"],[110,14,140,44],[110,16,140,46,"children"],[111,4,140,54],[112,6,140,54,"fileName"],[112,14,140,54],[112,16,140,54,"_jsxFileName"],[112,28,140,54],[113,6,140,54,"lineNumber"],[113,16,140,54],[114,6,140,54,"columnNumber"],[114,18,140,54],[115,4,140,54],[115,11,140,77],[115,12,140,78],[116,2,141,0],[116,3,141,1],[117,2,141,2,"_s"],[117,4,141,2],[117,5,56,13,"AuthProvider"],[117,17,56,60],[118,2,56,60,"_c"],[118,4,56,60],[118,7,56,13,"AuthProvider"],[118,19,56,60],[119,2,143,7],[119,11,143,16,"useAuth"],[119,18,143,23,"useAuth"],[119,19,143,23],[119,21,143,44],[120,4,143,44,"_s2"],[120,7,143,44],[121,4,144,2],[121,10,144,8,"ctx"],[121,13,144,11],[121,16,144,14],[121,20,144,14,"useContext"],[121,26,144,24],[121,27,144,24,"useContext"],[121,37,144,24],[121,39,144,25,"AuthContext"],[121,50,144,36],[121,51,144,37],[122,4,145,2],[122,8,145,6],[122,9,145,7,"ctx"],[122,12,145,10],[122,14,145,12],[123,6,146,4],[123,12,146,10],[123,16,146,14,"Error"],[123,21,146,19],[123,22,146,20],[123,42,146,40],[123,43,146,41],[124,4,147,2],[125,4,148,2],[125,11,148,9,"ctx"],[125,14,148,12],[126,2,149,0],[127,2,149,1,"_s2"],[127,5,149,1],[127,6,143,16,"useAuth"],[127,13,143,23],[128,2,143,23],[128,6,143,23,"_c"],[128,8,143,23],[129,2,143,23,"$RefreshReg$"],[129,14,143,23],[129,15,143,23,"_c"],[129,17,143,23],[130,0,143,23],[130,3]],"functionMap":{"names":["<global>","loadCredentials","saveCredentials","AuthProvider","useEffect$argument_0","<anonymous>","useMemo$argument_0","signUp","creds.find$argument_0","signIn","signOut","setRole","useAuth"],"mappings":"AAA;AC8C;CDG;AEE;CFE;+DGE;YCK;KCC;KDM;GDC;0CGE;MCK;kCCE,kDD;ODkB;MGE;iCDE,kDC;OHmB;MIE;OJG;MKE;OLU;GHE;CHG;OYE"},"hasCjsExports":false},"type":"js/module"}]}