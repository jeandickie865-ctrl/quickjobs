{"dependencies":[{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":45,"index":45}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.addApplication = addApplication;\n  exports.getApplicationsForJob = getApplicationsForJob;\n  exports.getApplicationsForWorker = getApplicationsForWorker;\n  exports.acceptApplication = acceptApplication;\n  exports.updateApplicationStatus = updateApplicationStatus;\n  exports.applyForJob = applyForJob;\n  var _storage = require(_dependencyMap[0], \"./storage\");\n  const APPLICATIONS_KEY = '@shiftmatch:applications';\n  async function loadApplications() {\n    const stored = await (0, _storage.getItem)(APPLICATIONS_KEY);\n    return stored ?? [];\n  }\n  async function saveApplications(apps) {\n    await (0, _storage.setItem)(APPLICATIONS_KEY, apps);\n  }\n  async function addApplication(jobId, workerId, employerId) {\n    const apps = await loadApplications();\n    const existing = apps.find(a => a.jobId === jobId && a.workerId === workerId);\n    if (existing) {\n      console.log('üìã Application already exists', {\n        jobId,\n        workerId,\n        appId: existing.id\n      });\n      return existing;\n    }\n    const app = {\n      id: 'app-' + Date.now().toString() + '-' + Math.random().toString(36).slice(2),\n      jobId,\n      workerId,\n      employerId,\n      createdAt: new Date().toISOString(),\n      status: 'pending'\n    };\n    const next = [...apps, app];\n    await saveApplications(next);\n    console.log('‚úÖ New application created', {\n      appId: app.id,\n      jobId,\n      workerId,\n      employerId\n    });\n    return app;\n  }\n  async function getApplicationsForJob(jobId) {\n    const apps = await loadApplications();\n    return apps.filter(a => a.jobId === jobId);\n  }\n  async function getApplicationsForWorker(workerId) {\n    const apps = await loadApplications();\n    return apps.filter(a => a.workerId === workerId);\n  }\n  async function acceptApplication(jobId, applicationId) {\n    const apps = await loadApplications();\n    const next = apps.map(app => {\n      if (app.jobId !== jobId) return app;\n      if (app.id === applicationId) {\n        return Object.assign({}, app, {\n          status: 'accepted'\n        });\n      }\n      if (app.status === 'pending') {\n        return Object.assign({}, app, {\n          status: 'rejected'\n        });\n      }\n      return app;\n    });\n    await saveApplications(next);\n  }\n  async function updateApplicationStatus(id, status) {\n    const apps = await loadApplications();\n    const next = apps.map(app => app.id === id ? Object.assign({}, app, {\n      status\n    }) : app);\n    await saveApplications(next);\n  }\n\n  // Alias f√ºr addApplication mit erweiterten Logs\n  async function applyForJob(jobId, workerId, employerId) {\n    try {\n      console.log('üîç applyForJob called', {\n        jobId,\n        workerId,\n        employerId\n      });\n      if (!employerId) {\n        console.log('‚ùå applyForJob: employerId fehlt beim Bewerben');\n        throw new Error('employerId fehlt beim Bewerben.');\n      }\n      const result = await addApplication(jobId, workerId, employerId);\n      console.log('‚úÖ applyForJob: success', result);\n      return result;\n    } catch (e) {\n      console.log('‚ùå applyForJob: ERROR', e);\n      throw e;\n    }\n  }\n});","lineCount":105,"map":[[7,2,15,0,"exports"],[7,9,15,0],[7,10,15,0,"addApplication"],[7,24,15,0],[7,27,15,0,"addApplication"],[7,41,15,0],[8,2,41,0,"exports"],[8,9,41,0],[8,10,41,0,"getApplicationsForJob"],[8,31,41,0],[8,34,41,0,"getApplicationsForJob"],[8,55,41,0],[9,2,46,0,"exports"],[9,9,46,0],[9,10,46,0,"getApplicationsForWorker"],[9,34,46,0],[9,37,46,0,"getApplicationsForWorker"],[9,61,46,0],[10,2,51,0,"exports"],[10,9,51,0],[10,10,51,0,"acceptApplication"],[10,27,51,0],[10,30,51,0,"acceptApplication"],[10,47,51,0],[11,2,66,0,"exports"],[11,9,66,0],[11,10,66,0,"updateApplicationStatus"],[11,33,66,0],[11,36,66,0,"updateApplicationStatus"],[11,59,66,0],[12,2,73,0,"exports"],[12,9,73,0],[12,10,73,0,"applyForJob"],[12,21,73,0],[12,24,73,0,"applyForJob"],[12,35,73,0],[13,2,1,0],[13,6,1,0,"_storage"],[13,14,1,0],[13,17,1,0,"require"],[13,24,1,0],[13,25,1,0,"_dependencyMap"],[13,39,1,0],[14,2,4,0],[14,8,4,6,"APPLICATIONS_KEY"],[14,24,4,22],[14,27,4,25],[14,53,4,51],[15,2,6,0],[15,17,6,15,"loadApplications"],[15,33,6,31,"loadApplications"],[15,34,6,31],[15,36,6,61],[16,4,7,2],[16,10,7,8,"stored"],[16,16,7,14],[16,19,7,17],[16,25,7,23],[16,29,7,23,"getItem"],[16,37,7,30],[16,38,7,30,"getItem"],[16,45,7,30],[16,47,7,49,"APPLICATIONS_KEY"],[16,63,7,65],[16,64,7,66],[17,4,8,2],[17,11,8,9,"stored"],[17,17,8,15],[17,21,8,19],[17,23,8,21],[18,2,9,0],[19,2,11,0],[19,17,11,15,"saveApplications"],[19,33,11,31,"saveApplications"],[19,34,11,32,"apps"],[19,38,11,54],[19,40,11,71],[20,4,12,2],[20,10,12,8],[20,14,12,8,"setItem"],[20,22,12,15],[20,23,12,15,"setItem"],[20,30,12,15],[20,32,12,34,"APPLICATIONS_KEY"],[20,48,12,50],[20,50,12,52,"apps"],[20,54,12,56],[20,55,12,57],[21,2,13,0],[22,2,15,7],[22,17,15,22,"addApplication"],[22,31,15,36,"addApplication"],[22,32,16,2,"jobId"],[22,37,16,15],[22,39,17,2,"workerId"],[22,47,17,18],[22,49,18,2,"employerId"],[22,59,18,20],[22,61,19,27],[23,4,20,2],[23,10,20,8,"apps"],[23,14,20,12],[23,17,20,15],[23,23,20,21,"loadApplications"],[23,39,20,37],[23,40,20,38],[23,41,20,39],[24,4,21,2],[24,10,21,8,"existing"],[24,18,21,16],[24,21,21,19,"apps"],[24,25,21,23],[24,26,21,24,"find"],[24,30,21,28],[24,31,21,29,"a"],[24,32,21,30],[24,36,21,34,"a"],[24,37,21,35],[24,38,21,36,"jobId"],[24,43,21,41],[24,48,21,46,"jobId"],[24,53,21,51],[24,57,21,55,"a"],[24,58,21,56],[24,59,21,57,"workerId"],[24,67,21,65],[24,72,21,70,"workerId"],[24,80,21,78],[24,81,21,79],[25,4,22,2],[25,8,22,6,"existing"],[25,16,22,14],[25,18,22,16],[26,6,23,4,"console"],[26,13,23,11],[26,14,23,12,"log"],[26,17,23,15],[26,18,23,16],[26,49,23,47],[26,51,23,49],[27,8,23,51,"jobId"],[27,13,23,56],[28,8,23,58,"workerId"],[28,16,23,66],[29,8,23,68,"appId"],[29,13,23,73],[29,15,23,75,"existing"],[29,23,23,83],[29,24,23,84,"id"],[30,6,23,87],[30,7,23,88],[30,8,23,89],[31,6,24,4],[31,13,24,11,"existing"],[31,21,24,19],[32,4,25,2],[33,4,27,2],[33,10,27,8,"app"],[33,13,27,27],[33,16,27,30],[34,6,28,4,"id"],[34,8,28,6],[34,10,28,8],[34,16,28,14],[34,19,28,17,"Date"],[34,23,28,21],[34,24,28,22,"now"],[34,27,28,25],[34,28,28,26],[34,29,28,27],[34,30,28,28,"toString"],[34,38,28,36],[34,39,28,37],[34,40,28,38],[34,43,28,41],[34,46,28,44],[34,49,28,47,"Math"],[34,53,28,51],[34,54,28,52,"random"],[34,60,28,58],[34,61,28,59],[34,62,28,60],[34,63,28,61,"toString"],[34,71,28,69],[34,72,28,70],[34,74,28,72],[34,75,28,73],[34,76,28,74,"slice"],[34,81,28,79],[34,82,28,80],[34,83,28,81],[34,84,28,82],[35,6,29,4,"jobId"],[35,11,29,9],[36,6,30,4,"workerId"],[36,14,30,12],[37,6,31,4,"employerId"],[37,16,31,14],[38,6,32,4,"createdAt"],[38,15,32,13],[38,17,32,15],[38,21,32,19,"Date"],[38,25,32,23],[38,26,32,24],[38,27,32,25],[38,28,32,26,"toISOString"],[38,39,32,37],[38,40,32,38],[38,41,32,39],[39,6,33,4,"status"],[39,12,33,10],[39,14,33,12],[40,4,34,2],[40,5,34,3],[41,4,35,2],[41,10,35,8,"next"],[41,14,35,12],[41,17,35,15],[41,18,35,16],[41,21,35,19,"apps"],[41,25,35,23],[41,27,35,25,"app"],[41,30,35,28],[41,31,35,29],[42,4,36,2],[42,10,36,8,"saveApplications"],[42,26,36,24],[42,27,36,25,"next"],[42,31,36,29],[42,32,36,30],[43,4,37,2,"console"],[43,11,37,9],[43,12,37,10,"log"],[43,15,37,13],[43,16,37,14],[43,43,37,41],[43,45,37,43],[44,6,37,45,"appId"],[44,11,37,50],[44,13,37,52,"app"],[44,16,37,55],[44,17,37,56,"id"],[44,19,37,58],[45,6,37,60,"jobId"],[45,11,37,65],[46,6,37,67,"workerId"],[46,14,37,75],[47,6,37,77,"employerId"],[48,4,37,88],[48,5,37,89],[48,6,37,90],[49,4,38,2],[49,11,38,9,"app"],[49,14,38,12],[50,2,39,0],[51,2,41,7],[51,17,41,22,"getApplicationsForJob"],[51,38,41,43,"getApplicationsForJob"],[51,39,41,44,"jobId"],[51,44,41,57],[51,46,41,86],[52,4,42,2],[52,10,42,8,"apps"],[52,14,42,12],[52,17,42,15],[52,23,42,21,"loadApplications"],[52,39,42,37],[52,40,42,38],[52,41,42,39],[53,4,43,2],[53,11,43,9,"apps"],[53,15,43,13],[53,16,43,14,"filter"],[53,22,43,20],[53,23,43,21,"a"],[53,24,43,22],[53,28,43,26,"a"],[53,29,43,27],[53,30,43,28,"jobId"],[53,35,43,33],[53,40,43,38,"jobId"],[53,45,43,43],[53,46,43,44],[54,2,44,0],[55,2,46,7],[55,17,46,22,"getApplicationsForWorker"],[55,41,46,46,"getApplicationsForWorker"],[55,42,46,47,"workerId"],[55,50,46,63],[55,52,46,92],[56,4,47,2],[56,10,47,8,"apps"],[56,14,47,12],[56,17,47,15],[56,23,47,21,"loadApplications"],[56,39,47,37],[56,40,47,38],[56,41,47,39],[57,4,48,2],[57,11,48,9,"apps"],[57,15,48,13],[57,16,48,14,"filter"],[57,22,48,20],[57,23,48,21,"a"],[57,24,48,22],[57,28,48,26,"a"],[57,29,48,27],[57,30,48,28,"workerId"],[57,38,48,36],[57,43,48,41,"workerId"],[57,51,48,49],[57,52,48,50],[58,2,49,0],[59,2,51,7],[59,17,51,22,"acceptApplication"],[59,34,51,39,"acceptApplication"],[59,35,51,40,"jobId"],[59,40,51,53],[59,42,51,55,"applicationId"],[59,55,51,76],[59,57,51,93],[60,4,52,2],[60,10,52,8,"apps"],[60,14,52,12],[60,17,52,15],[60,23,52,21,"loadApplications"],[60,39,52,37],[60,40,52,38],[60,41,52,39],[61,4,53,2],[61,10,53,8,"next"],[61,14,53,12],[61,17,53,15,"apps"],[61,21,53,19],[61,22,53,20,"map"],[61,25,53,23],[61,26,53,24,"app"],[61,29,53,27],[61,33,53,31],[62,6,54,4],[62,10,54,8,"app"],[62,13,54,11],[62,14,54,12,"jobId"],[62,19,54,17],[62,24,54,22,"jobId"],[62,29,54,27],[62,31,54,29],[62,38,54,36,"app"],[62,41,54,39],[63,6,55,4],[63,10,55,8,"app"],[63,13,55,11],[63,14,55,12,"id"],[63,16,55,14],[63,21,55,19,"applicationId"],[63,34,55,32],[63,36,55,34],[64,8,56,6],[64,15,56,6,"Object"],[64,21,56,6],[64,22,56,6,"assign"],[64,28,56,6],[64,33,56,18,"app"],[64,36,56,21],[65,10,56,23,"status"],[65,16,56,29],[65,18,56,31],[66,8,56,62],[67,6,57,4],[68,6,58,4],[68,10,58,8,"app"],[68,13,58,11],[68,14,58,12,"status"],[68,20,58,18],[68,25,58,23],[68,34,58,32],[68,36,58,34],[69,8,59,6],[69,15,59,6,"Object"],[69,21,59,6],[69,22,59,6,"assign"],[69,28,59,6],[69,33,59,18,"app"],[69,36,59,21],[70,10,59,23,"status"],[70,16,59,29],[70,18,59,31],[71,8,59,62],[72,6,60,4],[73,6,61,4],[73,13,61,11,"app"],[73,16,61,14],[74,4,62,2],[74,5,62,3],[74,6,62,4],[75,4,63,2],[75,10,63,8,"saveApplications"],[75,26,63,24],[75,27,63,25,"next"],[75,31,63,29],[75,32,63,30],[76,2,64,0],[77,2,66,7],[77,17,66,22,"updateApplicationStatus"],[77,40,66,45,"updateApplicationStatus"],[77,41,66,46,"id"],[77,43,66,56],[77,45,66,58,"status"],[77,51,66,83],[77,53,66,100],[78,4,67,2],[78,10,67,8,"apps"],[78,14,67,12],[78,17,67,15],[78,23,67,21,"loadApplications"],[78,39,67,37],[78,40,67,38],[78,41,67,39],[79,4,68,2],[79,10,68,8,"next"],[79,14,68,12],[79,17,68,15,"apps"],[79,21,68,19],[79,22,68,20,"map"],[79,25,68,23],[79,26,68,24,"app"],[79,29,68,27],[79,33,68,32,"app"],[79,36,68,35],[79,37,68,36,"id"],[79,39,68,38],[79,44,68,43,"id"],[79,46,68,45],[79,49,68,45,"Object"],[79,55,68,45],[79,56,68,45,"assign"],[79,62,68,45],[79,67,68,53,"app"],[79,70,68,56],[80,6,68,58,"status"],[81,4,68,64],[81,9,68,69,"app"],[81,12,68,73],[81,13,68,74],[82,4,69,2],[82,10,69,8,"saveApplications"],[82,26,69,24],[82,27,69,25,"next"],[82,31,69,29],[82,32,69,30],[83,2,70,0],[85,2,72,0],[86,2,73,7],[86,17,73,22,"applyForJob"],[86,28,73,33,"applyForJob"],[86,29,74,2,"jobId"],[86,34,74,15],[86,36,75,2,"workerId"],[86,44,75,18],[86,46,76,2,"employerId"],[86,56,76,20],[86,58,77,27],[87,4,78,2],[87,8,78,6],[88,6,79,4,"console"],[88,13,79,11],[88,14,79,12,"log"],[88,17,79,15],[88,18,79,16],[88,41,79,39],[88,43,79,41],[89,8,79,43,"jobId"],[89,13,79,48],[90,8,79,50,"workerId"],[90,16,79,58],[91,8,79,60,"employerId"],[92,6,79,71],[92,7,79,72],[92,8,79,73],[93,6,81,4],[93,10,81,8],[93,11,81,9,"employerId"],[93,21,81,19],[93,23,81,21],[94,8,82,6,"console"],[94,15,82,13],[94,16,82,14,"log"],[94,19,82,17],[94,20,82,18],[94,67,82,65],[94,68,82,66],[95,8,83,6],[95,14,83,12],[95,18,83,16,"Error"],[95,23,83,21],[95,24,83,22],[95,57,83,55],[95,58,83,56],[96,6,84,4],[97,6,86,4],[97,12,86,10,"result"],[97,18,86,16],[97,21,86,19],[97,27,86,25,"addApplication"],[97,41,86,39],[97,42,86,40,"jobId"],[97,47,86,45],[97,49,86,47,"workerId"],[97,57,86,55],[97,59,86,57,"employerId"],[97,69,86,67],[97,70,86,68],[98,6,87,4,"console"],[98,13,87,11],[98,14,87,12,"log"],[98,17,87,15],[98,18,87,16],[98,42,87,40],[98,44,87,42,"result"],[98,50,87,48],[98,51,87,49],[99,6,88,4],[99,13,88,11,"result"],[99,19,88,17],[100,4,89,2],[100,5,89,3],[100,6,89,4],[100,13,89,11,"e"],[100,14,89,12],[100,16,89,14],[101,6,90,4,"console"],[101,13,90,11],[101,14,90,12,"log"],[101,17,90,15],[101,18,90,16],[101,40,90,38],[101,42,90,40,"e"],[101,43,90,41],[101,44,90,42],[102,6,91,4],[102,12,91,10,"e"],[102,13,91,11],[103,4,92,2],[104,2,93,0],[105,0,93,1],[105,3]],"functionMap":{"names":["<global>","loadApplications","saveApplications","addApplication","apps.find$argument_0","getApplicationsForJob","apps.filter$argument_0","getApplicationsForWorker","acceptApplication","apps.map$argument_0","updateApplicationStatus","applyForJob"],"mappings":"AAA;ACK;CDG;AEE;CFE;OGE;6BCM,iDD;CHkB;OKE;qBCE,sBD;CLC;OOE;qBDE,4BC;CPC;OQE;wBCE;GDS;CRE;OUE;wBDE,iDC;CVE;OWG;CXoB"},"hasCjsExports":false},"type":"js/module"}]}