{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":242,"column":0,"index":5994}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":19},"end":{"line":2,"column":69,"index":88}}],"key":"6eZFbfKht0uO2NEVT/d8+i8B0s8="}},{"name":"expo-constants","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":89},"end":{"line":3,"column":39,"index":128}}],"key":"2TquPknmjb1g5OMuvQ0eTuioYjU="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.applyForJob = applyForJob;\n  exports.getApplicationsForJob = getApplicationsForJob;\n  exports.getJobById = getJobById;\n  exports.getMyApplications = getMyApplications;\n  exports.getWorkerProfile = getWorkerProfile;\n  exports.getWorkerProfileById = getWorkerProfileById;\n  exports.selectWorker = selectWorker;\n  exports.updateWorkerProfile = updateWorkerProfile;\n  exports.uploadProfilePhoto = uploadProfilePhoto;\n  var _asyncStorage = _interopRequireDefault(require(_dependencyMap[1], \"@react-native-async-storage/async-storage\"));\n  var _expoConstants = _interopRequireDefault(require(_dependencyMap[2], \"expo-constants\"));\n  // services/api.ts\n\n  // Get API base URL from environment\n  // In Kubernetes, all /api/* requests are automatically routed to backend (port 8001)\n  // So we use an empty base URL (relative paths)\n  const API_BASE_URL = _expoConstants.default.expoConfig?.extra?.backendUrl || '';\n\n  /**\n   * Get auth token from AsyncStorage\n   */\n  async function getAuthToken() {\n    try {\n      const token = await _asyncStorage.default.getItem('@backup:token');\n      return token;\n    } catch (error) {\n      console.error('Error getting auth token:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Make authenticated API request\n   */\n  async function apiRequest(endpoint) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const token = await getAuthToken();\n    const headers = {\n      'Content-Type': 'application/json',\n      ...options.headers\n    };\n    if (token) {\n      headers['Authorization'] = `Bearer ${token}`;\n    }\n    const url = `${API_BASE_URL}${endpoint}`;\n    try {\n      const response = await fetch(url, {\n        ...options,\n        headers\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({\n          detail: 'Unknown error'\n        }));\n        throw new Error(errorData.detail || `HTTP ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error(`API Error [${endpoint}]:`, error);\n      throw error;\n    }\n  }\n\n  // ============================================\n  // APPLICATIONS API\n  // ============================================\n\n  /**\n   * Worker bewirbt sich auf einen Job\n   */\n  async function applyForJob(jobId) {\n    return apiRequest('/api/applications', {\n      method: 'POST',\n      body: JSON.stringify({\n        job_id: jobId\n      })\n    });\n  }\n\n  /**\n   * Worker lädt eigene Bewerbungen\n   */\n  async function getMyApplications() {\n    return apiRequest('/api/applications/me');\n  }\n\n  /**\n   * Employer lädt Bewerbungen für einen Job\n   */\n  async function getApplicationsForJob(jobId) {\n    return apiRequest(`/api/applications/job/${jobId}`);\n  }\n\n  // ============================================\n  // MATCHES API\n  // ============================================\n\n  /**\n   * Employer wählt einen Worker aus\n   */\n  async function selectWorker(applicationId) {\n    return apiRequest(`/api/matches/select/${applicationId}`, {\n      method: 'POST'\n    });\n  }\n\n  // ============================================\n  // JOBS API\n  // ============================================\n\n  /**\n   * Get job by ID\n   */\n  async function getJobById(jobId) {\n    return apiRequest(`/api/jobs/${jobId}`);\n  }\n\n  // ============================================\n  // PROFILES API\n  // ============================================\n\n  /**\n   * Worker Profile laden (eigenes)\n   */\n  async function getWorkerProfile() {\n    return apiRequest('/api/profiles/worker/me');\n  }\n\n  /**\n   * Worker Profile laden (by ID, für Employers)\n   */\n  async function getWorkerProfileById(userId) {\n    return apiRequest(`/api/profiles/worker/${userId}`);\n  }\n\n  /**\n   * Worker Profile aktualisieren\n   */\n  async function updateWorkerProfile(data) {\n    return apiRequest('/api/profiles/worker/me', {\n      method: 'PATCH',\n      body: JSON.stringify(data)\n    });\n  }\n\n  // ============================================\n  // UPLOAD API\n  // ============================================\n\n  /**\n   * Upload profile photo\n   */\n  async function uploadProfilePhoto(uri) {\n    const token = await getAuthToken();\n\n    // Create form data\n    const formData = new FormData();\n    const filename = uri.split('/').pop() || 'photo.jpg';\n    const fileType = filename.split('.').pop() || 'jpg';\n\n    // @ts-ignore - React Native FormData accepts this format\n    formData.append('file', {\n      uri,\n      name: filename,\n      type: `image/${fileType}`\n    });\n    const url = `${API_BASE_URL}/api/upload/profile-photo`;\n    try {\n      const response = await fetch(url, {\n        method: 'POST',\n        headers: {\n          'Authorization': token ? `Bearer ${token}` : ''\n        },\n        body: formData\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({\n          detail: 'Upload failed'\n        }));\n        throw new Error(errorData.detail || `HTTP ${response.status}`);\n      }\n      const result = await response.json();\n      // Backend returns { photo_url, message }, map to { url, message }\n      return {\n        url: result.photo_url,\n        message: result.message\n      };\n    } catch (error) {\n      console.error('Photo upload error:', error);\n      throw error;\n    }\n  }\n});","lineCount":198,"map":[[15,2,2,0],[15,6,2,0,"_asyncStorage"],[15,19,2,0],[15,22,2,0,"_interopRequireDefault"],[15,44,2,0],[15,45,2,0,"require"],[15,52,2,0],[15,53,2,0,"_dependencyMap"],[15,67,2,0],[16,2,3,0],[16,6,3,0,"_expoConstants"],[16,20,3,0],[16,23,3,0,"_interopRequireDefault"],[16,45,3,0],[16,46,3,0,"require"],[16,53,3,0],[16,54,3,0,"_dependencyMap"],[16,68,3,0],[17,2,1,0],[19,2,5,0],[20,2,6,0],[21,2,7,0],[22,2,8,0],[22,8,8,6,"API_BASE_URL"],[22,20,8,18],[22,23,8,21,"Constants"],[22,45,8,30],[22,46,8,31,"expoConfig"],[22,56,8,41],[22,58,8,43,"extra"],[22,63,8,48],[22,65,8,50,"backendUrl"],[22,75,8,60],[22,79,8,64],[22,81,8,66],[24,2,10,0],[25,0,11,0],[26,0,12,0],[27,2,13,0],[27,17,13,15,"getAuthToken"],[27,29,13,27,"getAuthToken"],[27,30,13,27],[27,32,13,54],[28,4,14,2],[28,8,14,6],[29,6,15,4],[29,12,15,10,"token"],[29,17,15,15],[29,20,15,18],[29,26,15,24,"AsyncStorage"],[29,47,15,36],[29,48,15,37,"getItem"],[29,55,15,44],[29,56,15,45],[29,71,15,60],[29,72,15,61],[30,6,16,4],[30,13,16,11,"token"],[30,18,16,16],[31,4,17,2],[31,5,17,3],[31,6,17,4],[31,13,17,11,"error"],[31,18,17,16],[31,20,17,18],[32,6,18,4,"console"],[32,13,18,11],[32,14,18,12,"error"],[32,19,18,17],[32,20,18,18],[32,47,18,45],[32,49,18,47,"error"],[32,54,18,52],[32,55,18,53],[33,6,19,4],[33,13,19,11],[33,17,19,15],[34,4,20,2],[35,2,21,0],[37,2,23,0],[38,0,24,0],[39,0,25,0],[40,2,26,0],[40,17,26,15,"apiRequest"],[40,27,26,25,"apiRequest"],[40,28,27,2,"endpoint"],[40,36,27,18],[40,38,29,14],[41,4,29,14],[41,8,28,2,"options"],[41,15,28,22],[41,18,28,22,"arguments"],[41,27,28,22],[41,28,28,22,"length"],[41,34,28,22],[41,42,28,22,"arguments"],[41,51,28,22],[41,59,28,22,"undefined"],[41,68,28,22],[41,71,28,22,"arguments"],[41,80,28,22],[41,86,28,25],[41,87,28,26],[41,88,28,27],[42,4,30,2],[42,10,30,8,"token"],[42,15,30,13],[42,18,30,16],[42,24,30,22,"getAuthToken"],[42,36,30,34],[42,37,30,35],[42,38,30,36],[43,4,32,2],[43,10,32,8,"headers"],[43,17,32,28],[43,20,32,31],[44,6,33,4],[44,20,33,18],[44,22,33,20],[44,40,33,38],[45,6,34,4],[45,9,34,7,"options"],[45,16,34,14],[45,17,34,15,"headers"],[46,4,35,2],[46,5,35,3],[47,4,37,2],[47,8,37,6,"token"],[47,13,37,11],[47,15,37,13],[48,6,38,4,"headers"],[48,13,38,11],[48,14,38,12],[48,29,38,27],[48,30,38,28],[48,33,38,31],[48,43,38,41,"token"],[48,48,38,46],[48,50,38,48],[49,4,39,2],[50,4,41,2],[50,10,41,8,"url"],[50,13,41,11],[50,16,41,14],[50,19,41,17,"API_BASE_URL"],[50,31,41,29],[50,34,41,32,"endpoint"],[50,42,41,40],[50,44,41,42],[51,4,43,2],[51,8,43,6],[52,6,44,4],[52,12,44,10,"response"],[52,20,44,18],[52,23,44,21],[52,29,44,27,"fetch"],[52,34,44,32],[52,35,44,33,"url"],[52,38,44,36],[52,40,44,38],[53,8,45,6],[53,11,45,9,"options"],[53,18,45,16],[54,8,46,6,"headers"],[55,6,47,4],[55,7,47,5],[55,8,47,6],[56,6,49,4],[56,10,49,8],[56,11,49,9,"response"],[56,19,49,17],[56,20,49,18,"ok"],[56,22,49,20],[56,24,49,22],[57,8,50,6],[57,14,50,12,"errorData"],[57,23,50,21],[57,26,50,24],[57,32,50,30,"response"],[57,40,50,38],[57,41,50,39,"json"],[57,45,50,43],[57,46,50,44],[57,47,50,45],[57,48,50,46,"catch"],[57,53,50,51],[57,54,50,52],[57,61,50,59],[58,10,50,61,"detail"],[58,16,50,67],[58,18,50,69],[59,8,50,85],[59,9,50,86],[59,10,50,87],[59,11,50,88],[60,8,51,6],[60,14,51,12],[60,18,51,16,"Error"],[60,23,51,21],[60,24,51,22,"errorData"],[60,33,51,31],[60,34,51,32,"detail"],[60,40,51,38],[60,44,51,42],[60,52,51,50,"response"],[60,60,51,58],[60,61,51,59,"status"],[60,67,51,65],[60,69,51,67],[60,70,51,68],[61,6,52,4],[62,6,54,4],[62,13,54,11],[62,19,54,17,"response"],[62,27,54,25],[62,28,54,26,"json"],[62,32,54,30],[62,33,54,31],[62,34,54,32],[63,4,55,2],[63,5,55,3],[63,6,55,4],[63,13,55,11,"error"],[63,18,55,16],[63,20,55,18],[64,6,56,4,"console"],[64,13,56,11],[64,14,56,12,"error"],[64,19,56,17],[64,20,56,18],[64,34,56,32,"endpoint"],[64,42,56,40],[64,46,56,44],[64,48,56,46,"error"],[64,53,56,51],[64,54,56,52],[65,6,57,4],[65,12,57,10,"error"],[65,17,57,15],[66,4,58,2],[67,2,59,0],[69,2,61,0],[70,2,62,0],[71,2,63,0],[73,2,73,0],[74,0,74,0],[75,0,75,0],[76,2,76,7],[76,17,76,22,"applyForJob"],[76,28,76,33,"applyForJob"],[76,29,76,34,"jobId"],[76,34,76,47],[76,36,76,71],[77,4,77,2],[77,11,77,9,"apiRequest"],[77,21,77,19],[77,22,77,33],[77,41,77,52],[77,43,77,54],[78,6,78,4,"method"],[78,12,78,10],[78,14,78,12],[78,20,78,18],[79,6,79,4,"body"],[79,10,79,8],[79,12,79,10,"JSON"],[79,16,79,14],[79,17,79,15,"stringify"],[79,26,79,24],[79,27,79,25],[80,8,79,27,"job_id"],[80,14,79,33],[80,16,79,35,"jobId"],[81,6,79,41],[81,7,79,42],[82,4,80,2],[82,5,80,3],[82,6,80,4],[83,2,81,0],[85,2,83,0],[86,0,84,0],[87,0,85,0],[88,2,86,7],[88,17,86,22,"getMyApplications"],[88,34,86,39,"getMyApplications"],[88,35,86,39],[88,37,86,66],[89,4,87,2],[89,11,87,9,"apiRequest"],[89,21,87,19],[89,22,87,35],[89,44,87,57],[89,45,87,58],[90,2,88,0],[92,2,90,0],[93,0,91,0],[94,0,92,0],[95,2,93,7],[95,17,93,22,"getApplicationsForJob"],[95,38,93,43,"getApplicationsForJob"],[95,39,93,44,"jobId"],[95,44,93,57],[95,46,93,83],[96,4,94,2],[96,11,94,9,"apiRequest"],[96,21,94,19],[96,22,94,35],[96,47,94,60,"jobId"],[96,52,94,65],[96,54,94,67],[96,55,94,68],[97,2,95,0],[99,2,97,0],[100,2,98,0],[101,2,99,0],[103,2,106,0],[104,0,107,0],[105,0,108,0],[106,2,109,7],[106,17,109,22,"selectWorker"],[106,29,109,34,"selectWorker"],[106,30,109,35,"applicationId"],[106,43,109,56],[106,45,109,89],[107,4,110,2],[107,11,110,9,"apiRequest"],[107,21,110,19],[107,22,110,42],[107,45,110,65,"applicationId"],[107,58,110,78],[107,60,110,80],[107,62,110,82],[108,6,111,4,"method"],[108,12,111,10],[108,14,111,12],[109,4,112,2],[109,5,112,3],[109,6,112,4],[110,2,113,0],[112,2,115,0],[113,2,116,0],[114,2,117,0],[116,2,135,0],[117,0,136,0],[118,0,137,0],[119,2,138,7],[119,17,138,22,"getJobById"],[119,27,138,32,"getJobById"],[119,28,138,33,"jobId"],[119,33,138,46],[119,35,138,62],[120,4,139,2],[120,11,139,9,"apiRequest"],[120,21,139,19],[120,22,139,25],[120,35,139,38,"jobId"],[120,40,139,43],[120,42,139,45],[120,43,139,46],[121,2,140,0],[123,2,142,0],[124,2,143,0],[125,2,144,0],[127,2,164,0],[128,0,165,0],[129,0,166,0],[130,2,167,7],[130,17,167,22,"getWorkerProfile"],[130,33,167,38,"getWorkerProfile"],[130,34,167,38],[130,36,167,65],[131,4,168,2],[131,11,168,9,"apiRequest"],[131,21,168,19],[131,22,168,35],[131,47,168,60],[131,48,168,61],[132,2,169,0],[134,2,171,0],[135,0,172,0],[136,0,173,0],[137,2,174,7],[137,17,174,22,"getWorkerProfileById"],[137,37,174,42,"getWorkerProfileById"],[137,38,174,43,"userId"],[137,44,174,57],[137,46,174,83],[138,4,175,2],[138,11,175,9,"apiRequest"],[138,21,175,19],[138,22,175,35],[138,46,175,59,"userId"],[138,52,175,65],[138,54,175,67],[138,55,175,68],[139,2,176,0],[141,2,178,0],[142,0,179,0],[143,0,180,0],[144,2,181,7],[144,17,181,22,"updateWorkerProfile"],[144,36,181,41,"updateWorkerProfile"],[144,37,181,42,"data"],[144,41,181,70],[144,43,181,96],[145,4,182,2],[145,11,182,9,"apiRequest"],[145,21,182,19],[145,22,182,35],[145,47,182,60],[145,49,182,62],[146,6,183,4,"method"],[146,12,183,10],[146,14,183,12],[146,21,183,19],[147,6,184,4,"body"],[147,10,184,8],[147,12,184,10,"JSON"],[147,16,184,14],[147,17,184,15,"stringify"],[147,26,184,24],[147,27,184,25,"data"],[147,31,184,29],[148,4,185,2],[148,5,185,3],[148,6,185,4],[149,2,186,0],[151,2,188,0],[152,2,189,0],[153,2,190,0],[155,2,197,0],[156,0,198,0],[157,0,199,0],[158,2,200,7],[158,17,200,22,"uploadProfilePhoto"],[158,35,200,40,"uploadProfilePhoto"],[158,36,200,41,"uri"],[158,39,200,52],[158,41,200,97],[159,4,201,2],[159,10,201,8,"token"],[159,15,201,13],[159,18,201,16],[159,24,201,22,"getAuthToken"],[159,36,201,34],[159,37,201,35],[159,38,201,36],[161,4,203,2],[162,4,204,2],[162,10,204,8,"formData"],[162,18,204,16],[162,21,204,19],[162,25,204,23,"FormData"],[162,33,204,31],[162,34,204,32],[162,35,204,33],[163,4,205,2],[163,10,205,8,"filename"],[163,18,205,16],[163,21,205,19,"uri"],[163,24,205,22],[163,25,205,23,"split"],[163,30,205,28],[163,31,205,29],[163,34,205,32],[163,35,205,33],[163,36,205,34,"pop"],[163,39,205,37],[163,40,205,38],[163,41,205,39],[163,45,205,43],[163,56,205,54],[164,4,206,2],[164,10,206,8,"fileType"],[164,18,206,16],[164,21,206,19,"filename"],[164,29,206,27],[164,30,206,28,"split"],[164,35,206,33],[164,36,206,34],[164,39,206,37],[164,40,206,38],[164,41,206,39,"pop"],[164,44,206,42],[164,45,206,43],[164,46,206,44],[164,50,206,48],[164,55,206,53],[166,4,208,2],[167,4,209,2,"formData"],[167,12,209,10],[167,13,209,11,"append"],[167,19,209,17],[167,20,209,18],[167,26,209,24],[167,28,209,26],[168,6,210,4,"uri"],[168,9,210,7],[169,6,211,4,"name"],[169,10,211,8],[169,12,211,10,"filename"],[169,20,211,18],[170,6,212,4,"type"],[170,10,212,8],[170,12,212,10],[170,21,212,19,"fileType"],[170,29,212,27],[171,4,213,2],[171,5,213,3],[171,6,213,4],[172,4,215,2],[172,10,215,8,"url"],[172,13,215,11],[172,16,215,14],[172,19,215,17,"API_BASE_URL"],[172,31,215,29],[172,58,215,56],[173,4,217,2],[173,8,217,6],[174,6,218,4],[174,12,218,10,"response"],[174,20,218,18],[174,23,218,21],[174,29,218,27,"fetch"],[174,34,218,32],[174,35,218,33,"url"],[174,38,218,36],[174,40,218,38],[175,8,219,6,"method"],[175,14,219,12],[175,16,219,14],[175,22,219,20],[176,8,220,6,"headers"],[176,15,220,13],[176,17,220,15],[177,10,221,8],[177,25,221,23],[177,27,221,25,"token"],[177,32,221,30],[177,35,221,33],[177,45,221,43,"token"],[177,50,221,48],[177,52,221,50],[177,55,221,53],[178,8,222,6],[178,9,222,7],[179,8,223,6,"body"],[179,12,223,10],[179,14,223,12,"formData"],[180,6,224,4],[180,7,224,5],[180,8,224,6],[181,6,226,4],[181,10,226,8],[181,11,226,9,"response"],[181,19,226,17],[181,20,226,18,"ok"],[181,22,226,20],[181,24,226,22],[182,8,227,6],[182,14,227,12,"errorData"],[182,23,227,21],[182,26,227,24],[182,32,227,30,"response"],[182,40,227,38],[182,41,227,39,"json"],[182,45,227,43],[182,46,227,44],[182,47,227,45],[182,48,227,46,"catch"],[182,53,227,51],[182,54,227,52],[182,61,227,59],[183,10,227,61,"detail"],[183,16,227,67],[183,18,227,69],[184,8,227,85],[184,9,227,86],[184,10,227,87],[184,11,227,88],[185,8,228,6],[185,14,228,12],[185,18,228,16,"Error"],[185,23,228,21],[185,24,228,22,"errorData"],[185,33,228,31],[185,34,228,32,"detail"],[185,40,228,38],[185,44,228,42],[185,52,228,50,"response"],[185,60,228,58],[185,61,228,59,"status"],[185,67,228,65],[185,69,228,67],[185,70,228,68],[186,6,229,4],[187,6,231,4],[187,12,231,10,"result"],[187,18,231,16],[187,21,231,19],[187,27,231,25,"response"],[187,35,231,33],[187,36,231,34,"json"],[187,40,231,38],[187,41,231,39],[187,42,231,40],[188,6,232,4],[189,6,233,4],[189,13,233,11],[190,8,234,6,"url"],[190,11,234,9],[190,13,234,11,"result"],[190,19,234,17],[190,20,234,18,"photo_url"],[190,29,234,27],[191,8,235,6,"message"],[191,15,235,13],[191,17,235,15,"result"],[191,23,235,21],[191,24,235,22,"message"],[192,6,236,4],[192,7,236,5],[193,4,237,2],[193,5,237,3],[193,6,237,4],[193,13,237,11,"error"],[193,18,237,16],[193,20,237,18],[194,6,238,4,"console"],[194,13,238,11],[194,14,238,12,"error"],[194,19,238,17],[194,20,238,18],[194,41,238,39],[194,43,238,41,"error"],[194,48,238,46],[194,49,238,47],[195,6,239,4],[195,12,239,10,"error"],[195,17,239,15],[196,4,240,2],[197,2,241,0],[198,0,241,1]],"functionMap":{"names":["<global>","getAuthToken","apiRequest","response.json._catch$argument_0","applyForJob","getMyApplications","getApplicationsForJob","selectWorker","getJobById","getWorkerProfile","getWorkerProfileById","updateWorkerProfile","uploadProfilePhoto"],"mappings":"AAA;ACY;CDQ;AEK;oDCwB,mCD;CFS;OIiB;CJK;OKK;CLE;OMK;CNE;OOc;CPI;OQyB;CRE;OS2B;CTE;OUK;CVE;OWK;CXK;OYc;oDT2B,mCS;CZc"}},"type":"js/module"}]}