{"dependencies":[{"name":"./storage","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":45,"index":45}}],"key":"dkq9sfvDyrGcbIAsF1EmLCvdhOw="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.addMessage = addMessage;\n  exports.getMessagesForApplication = getMessagesForApplication;\n  var _storage = require(_dependencyMap[0], \"./storage\");\n  const CHAT_KEY = '@shiftmatch:chatMessages';\n  async function loadAll() {\n    return (await (0, _storage.getItem)(CHAT_KEY)) ?? [];\n  }\n  async function saveAll(messages) {\n    await (0, _storage.setItem)(CHAT_KEY, messages);\n  }\n  async function getMessagesForApplication(applicationId) {\n    const all = await loadAll();\n    return all.filter(m => m.applicationId === applicationId).sort((a, b) => a.createdAt.localeCompare(b.createdAt));\n  }\n  async function addMessage(applicationId, senderRole, text) {\n    const all = await loadAll();\n    const msg = {\n      id: 'msg-' + Date.now().toString() + '-' + Math.random().toString(36).slice(2),\n      applicationId,\n      senderRole,\n      text,\n      createdAt: new Date().toISOString()\n    };\n    const next = [...all, msg];\n    await saveAll(next);\n    return msg;\n  }\n});","lineCount":32,"map":[[7,2,1,0],[7,6,1,0,"_storage"],[7,14,1,0],[7,17,1,0,"require"],[7,24,1,0],[7,25,1,0,"_dependencyMap"],[7,39,1,0],[8,2,4,0],[8,8,4,6,"CHAT_KEY"],[8,16,4,14],[8,19,4,17],[8,45,4,43],[9,2,6,0],[9,17,6,15,"loadAll"],[9,24,6,22,"loadAll"],[9,25,6,22],[9,27,6,49],[10,4,7,2],[10,11,7,9],[10,12,7,10],[10,18,7,16],[10,22,7,16,"getItem"],[10,38,7,23],[10,40,7,39,"CHAT_KEY"],[10,48,7,47],[10,49,7,48],[10,54,7,53],[10,56,7,55],[11,2,8,0],[12,2,10,0],[12,17,10,15,"saveAll"],[12,24,10,22,"saveAll"],[12,25,10,23,"messages"],[12,33,10,46],[12,35,10,63],[13,4,11,2],[13,10,11,8],[13,14,11,8,"setItem"],[13,30,11,15],[13,32,11,16,"CHAT_KEY"],[13,40,11,24],[13,42,11,26,"messages"],[13,50,11,34],[13,51,11,35],[14,2,12,0],[15,2,14,7],[15,17,14,22,"getMessagesForApplication"],[15,42,14,47,"getMessagesForApplication"],[15,43,14,48,"applicationId"],[15,56,14,69],[15,58,14,95],[16,4,15,2],[16,10,15,8,"all"],[16,13,15,11],[16,16,15,14],[16,22,15,20,"loadAll"],[16,29,15,27],[16,30,15,28],[16,31,15,29],[17,4,16,2],[17,11,16,9,"all"],[17,14,16,12],[17,15,17,5,"filter"],[17,21,17,11],[17,22,17,12,"m"],[17,23,17,13],[17,27,17,17,"m"],[17,28,17,18],[17,29,17,19,"applicationId"],[17,42,17,32],[17,47,17,37,"applicationId"],[17,60,17,50],[17,61,17,51],[17,62,18,5,"sort"],[17,66,18,9],[17,67,18,10],[17,68,18,11,"a"],[17,69,18,12],[17,71,18,14,"b"],[17,72,18,15],[17,77,18,20,"a"],[17,78,18,21],[17,79,18,22,"createdAt"],[17,88,18,31],[17,89,18,32,"localeCompare"],[17,102,18,45],[17,103,18,46,"b"],[17,104,18,47],[17,105,18,48,"createdAt"],[17,114,18,57],[17,115,18,58],[17,116,18,59],[18,2,19,0],[19,2,21,7],[19,17,21,22,"addMessage"],[19,27,21,32,"addMessage"],[19,28,22,2,"applicationId"],[19,41,22,23],[19,43,23,2,"senderRole"],[19,53,23,28],[19,55,24,2,"text"],[19,59,24,14],[19,61,25,24],[20,4,26,2],[20,10,26,8,"all"],[20,13,26,11],[20,16,26,14],[20,22,26,20,"loadAll"],[20,29,26,27],[20,30,26,28],[20,31,26,29],[21,4,27,2],[21,10,27,8,"msg"],[21,13,27,24],[21,16,27,27],[22,6,28,4,"id"],[22,8,28,6],[22,10,28,8],[22,16,28,14],[22,19,28,17,"Date"],[22,23,28,21],[22,24,28,22,"now"],[22,27,28,25],[22,28,28,26],[22,29,28,27],[22,30,28,28,"toString"],[22,38,28,36],[22,39,28,37],[22,40,28,38],[22,43,28,41],[22,46,28,44],[22,49,28,47,"Math"],[22,53,28,51],[22,54,28,52,"random"],[22,60,28,58],[22,61,28,59],[22,62,28,60],[22,63,28,61,"toString"],[22,71,28,69],[22,72,28,70],[22,74,28,72],[22,75,28,73],[22,76,28,74,"slice"],[22,81,28,79],[22,82,28,80],[22,83,28,81],[22,84,28,82],[23,6,29,4,"applicationId"],[23,19,29,17],[24,6,30,4,"senderRole"],[24,16,30,14],[25,6,31,4,"text"],[25,10,31,8],[26,6,32,4,"createdAt"],[26,15,32,13],[26,17,32,15],[26,21,32,19,"Date"],[26,25,32,23],[26,26,32,24],[26,27,32,25],[26,28,32,26,"toISOString"],[26,39,32,37],[26,40,32,38],[27,4,33,2],[27,5,33,3],[28,4,34,2],[28,10,34,8,"next"],[28,14,34,12],[28,17,34,15],[28,18,34,16],[28,21,34,19,"all"],[28,24,34,22],[28,26,34,24,"msg"],[28,29,34,27],[28,30,34,28],[29,4,35,2],[29,10,35,8,"saveAll"],[29,17,35,15],[29,18,35,16,"next"],[29,22,35,20],[29,23,35,21],[30,4,36,2],[30,11,36,9,"msg"],[30,14,36,12],[31,2,37,0],[32,0,37,1]],"functionMap":{"names":["<global>","loadAll","saveAll","getMessagesForApplication","all.filter$argument_0","all.filter.sort$argument_0","addMessage"],"mappings":"AAA;ACK;CDE;AEE;CFE;OGE;YCG,sCD;UEC,gDF;CHC;OME;CNgB"}},"type":"js/module"}]}