{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":45,"index":45}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.getMessagesForApplication = getMessagesForApplication;\n  exports.addMessage = addMessage;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _storage = require(_dependencyMap[1], \"./storage\");\n  var CHAT_KEY = '@shiftmatch:chatMessages';\n  function loadAll() {\n    return _loadAll.apply(this, arguments);\n  }\n  function _loadAll() {\n    _loadAll = (0, _asyncToGenerator.default)(function* () {\n      return (yield (0, _storage.getItem)(CHAT_KEY)) ?? [];\n    });\n    return _loadAll.apply(this, arguments);\n  }\n  function saveAll(_x) {\n    return _saveAll.apply(this, arguments);\n  }\n  function _saveAll() {\n    _saveAll = (0, _asyncToGenerator.default)(function* (messages) {\n      yield (0, _storage.setItem)(CHAT_KEY, messages);\n    });\n    return _saveAll.apply(this, arguments);\n  }\n  function getMessagesForApplication(_x2) {\n    return _getMessagesForApplication.apply(this, arguments);\n  }\n  function _getMessagesForApplication() {\n    _getMessagesForApplication = (0, _asyncToGenerator.default)(function* (applicationId) {\n      var all = yield loadAll();\n      return all.filter(m => m.applicationId === applicationId).sort((a, b) => a.createdAt.localeCompare(b.createdAt));\n    });\n    return _getMessagesForApplication.apply(this, arguments);\n  }\n  function addMessage(_x3, _x4, _x5) {\n    return _addMessage.apply(this, arguments);\n  }\n  function _addMessage() {\n    _addMessage = (0, _asyncToGenerator.default)(function* (applicationId, senderRole, text) {\n      var all = yield loadAll();\n      var msg = {\n        id: 'msg-' + Date.now().toString() + '-' + Math.random().toString(36).slice(2),\n        applicationId,\n        senderRole,\n        text,\n        createdAt: new Date().toISOString()\n      };\n      var next = [...all, msg];\n      yield saveAll(next);\n      return msg;\n    });\n    return _addMessage.apply(this, arguments);\n  }\n});","lineCount":65,"map":[[12,2,14,0,"exports"],[12,9,14,0],[12,10,14,0,"getMessagesForApplication"],[12,35,14,0],[12,38,14,0,"getMessagesForApplication"],[12,63,14,0],[13,2,21,0,"exports"],[13,9,21,0],[13,10,21,0,"addMessage"],[13,20,21,0],[13,23,21,0,"addMessage"],[13,33,21,0],[14,2,37,1],[14,6,37,1,"_babelRuntimeHelpersAsyncToGenerator"],[14,42,37,1],[14,45,37,1,"require"],[14,52,37,1],[14,53,37,1,"_dependencyMap"],[14,67,37,1],[15,2,37,1],[15,6,37,1,"_asyncToGenerator"],[15,23,37,1],[15,26,37,1,"_interopDefault"],[15,41,37,1],[15,42,37,1,"_babelRuntimeHelpersAsyncToGenerator"],[15,78,37,1],[16,2,1,0],[16,6,1,0,"_storage"],[16,14,1,0],[16,17,1,0,"require"],[16,24,1,0],[16,25,1,0,"_dependencyMap"],[16,39,1,0],[17,2,4,0],[17,6,4,6,"CHAT_KEY"],[17,14,4,14],[17,17,4,17],[17,43,4,43],[18,2,4,44],[18,11,6,15,"loadAll"],[18,18,6,22,"loadAll"],[18,19,6,22],[19,4,6,22],[19,11,6,22,"_loadAll"],[19,19,6,22],[19,20,6,22,"apply"],[19,25,6,22],[19,32,6,22,"arguments"],[19,41,6,22],[20,2,6,22],[21,2,6,22],[21,11,6,22,"_loadAll"],[21,20,6,22],[22,4,6,22,"_loadAll"],[22,12,6,22],[22,19,6,22,"_asyncToGenerator"],[22,36,6,22],[22,37,6,22,"default"],[22,44,6,22],[22,46,6,0],[22,59,6,49],[23,6,7,2],[23,13,7,9],[23,20,7,16],[23,24,7,16,"getItem"],[23,32,7,23],[23,33,7,23,"getItem"],[23,40,7,23],[23,42,7,39,"CHAT_KEY"],[23,50,7,47],[23,51,7,48],[23,56,7,53],[23,58,7,55],[24,4,8,0],[24,5,8,1],[25,4,8,1],[25,11,8,1,"_loadAll"],[25,19,8,1],[25,20,8,1,"apply"],[25,25,8,1],[25,32,8,1,"arguments"],[25,41,8,1],[26,2,8,1],[27,2,8,1],[27,11,10,15,"saveAll"],[27,18,10,22,"saveAll"],[27,19,10,22,"_x"],[27,21,10,22],[28,4,10,22],[28,11,10,22,"_saveAll"],[28,19,10,22],[28,20,10,22,"apply"],[28,25,10,22],[28,32,10,22,"arguments"],[28,41,10,22],[29,2,10,22],[30,2,10,22],[30,11,10,22,"_saveAll"],[30,20,10,22],[31,4,10,22,"_saveAll"],[31,12,10,22],[31,19,10,22,"_asyncToGenerator"],[31,36,10,22],[31,37,10,22,"default"],[31,44,10,22],[31,46,10,0],[31,57,10,23,"messages"],[31,65,10,46],[31,67,10,63],[32,6,11,2],[32,12,11,8],[32,16,11,8,"setItem"],[32,24,11,15],[32,25,11,15,"setItem"],[32,32,11,15],[32,34,11,16,"CHAT_KEY"],[32,42,11,24],[32,44,11,26,"messages"],[32,52,11,34],[32,53,11,35],[33,4,12,0],[33,5,12,1],[34,4,12,1],[34,11,12,1,"_saveAll"],[34,19,12,1],[34,20,12,1,"apply"],[34,25,12,1],[34,32,12,1,"arguments"],[34,41,12,1],[35,2,12,1],[36,2,12,1],[36,11,14,22,"getMessagesForApplication"],[36,36,14,47,"getMessagesForApplication"],[36,37,14,47,"_x2"],[36,40,14,47],[37,4,14,47],[37,11,14,47,"_getMessagesForApplication"],[37,37,14,47],[37,38,14,47,"apply"],[37,43,14,47],[37,50,14,47,"arguments"],[37,59,14,47],[38,2,14,47],[39,2,14,47],[39,11,14,47,"_getMessagesForApplication"],[39,38,14,47],[40,4,14,47,"_getMessagesForApplication"],[40,30,14,47],[40,37,14,47,"_asyncToGenerator"],[40,54,14,47],[40,55,14,47,"default"],[40,62,14,47],[40,64,14,7],[40,75,14,48,"applicationId"],[40,88,14,69],[40,90,14,95],[41,6,15,2],[41,10,15,8,"all"],[41,13,15,11],[41,22,15,20,"loadAll"],[41,29,15,27],[41,30,15,28],[41,31,15,29],[42,6,16,2],[42,13,16,9,"all"],[42,16,16,12],[42,17,17,5,"filter"],[42,23,17,11],[42,24,17,12,"m"],[42,25,17,13],[42,29,17,17,"m"],[42,30,17,18],[42,31,17,19,"applicationId"],[42,44,17,32],[42,49,17,37,"applicationId"],[42,62,17,50],[42,63,17,51],[42,64,18,5,"sort"],[42,68,18,9],[42,69,18,10],[42,70,18,11,"a"],[42,71,18,12],[42,73,18,14,"b"],[42,74,18,15],[42,79,18,20,"a"],[42,80,18,21],[42,81,18,22,"createdAt"],[42,90,18,31],[42,91,18,32,"localeCompare"],[42,104,18,45],[42,105,18,46,"b"],[42,106,18,47],[42,107,18,48,"createdAt"],[42,116,18,57],[42,117,18,58],[42,118,18,59],[43,4,19,0],[43,5,19,1],[44,4,19,1],[44,11,19,1,"_getMessagesForApplication"],[44,37,19,1],[44,38,19,1,"apply"],[44,43,19,1],[44,50,19,1,"arguments"],[44,59,19,1],[45,2,19,1],[46,2,19,1],[46,11,21,22,"addMessage"],[46,21,21,32,"addMessage"],[46,22,21,32,"_x3"],[46,25,21,32],[46,27,21,32,"_x4"],[46,30,21,32],[46,32,21,32,"_x5"],[46,35,21,32],[47,4,21,32],[47,11,21,32,"_addMessage"],[47,22,21,32],[47,23,21,32,"apply"],[47,28,21,32],[47,35,21,32,"arguments"],[47,44,21,32],[48,2,21,32],[49,2,21,32],[49,11,21,32,"_addMessage"],[49,23,21,32],[50,4,21,32,"_addMessage"],[50,15,21,32],[50,22,21,32,"_asyncToGenerator"],[50,39,21,32],[50,40,21,32,"default"],[50,47,21,32],[50,49,21,7],[50,60,22,2,"applicationId"],[50,73,22,23],[50,75,23,2,"senderRole"],[50,85,23,28],[50,87,24,2,"text"],[50,91,24,14],[50,93,25,24],[51,6,26,2],[51,10,26,8,"all"],[51,13,26,11],[51,22,26,20,"loadAll"],[51,29,26,27],[51,30,26,28],[51,31,26,29],[52,6,27,2],[52,10,27,8,"msg"],[52,13,27,24],[52,16,27,27],[53,8,28,4,"id"],[53,10,28,6],[53,12,28,8],[53,18,28,14],[53,21,28,17,"Date"],[53,25,28,21],[53,26,28,22,"now"],[53,29,28,25],[53,30,28,26],[53,31,28,27],[53,32,28,28,"toString"],[53,40,28,36],[53,41,28,37],[53,42,28,38],[53,45,28,41],[53,48,28,44],[53,51,28,47,"Math"],[53,55,28,51],[53,56,28,52,"random"],[53,62,28,58],[53,63,28,59],[53,64,28,60],[53,65,28,61,"toString"],[53,73,28,69],[53,74,28,70],[53,76,28,72],[53,77,28,73],[53,78,28,74,"slice"],[53,83,28,79],[53,84,28,80],[53,85,28,81],[53,86,28,82],[54,8,29,4,"applicationId"],[54,21,29,17],[55,8,30,4,"senderRole"],[55,18,30,14],[56,8,31,4,"text"],[56,12,31,8],[57,8,32,4,"createdAt"],[57,17,32,13],[57,19,32,15],[57,23,32,19,"Date"],[57,27,32,23],[57,28,32,24],[57,29,32,25],[57,30,32,26,"toISOString"],[57,41,32,37],[57,42,32,38],[58,6,33,2],[58,7,33,3],[59,6,34,2],[59,10,34,8,"next"],[59,14,34,12],[59,17,34,15],[59,18,34,16],[59,21,34,19,"all"],[59,24,34,22],[59,26,34,24,"msg"],[59,29,34,27],[59,30,34,28],[60,6,35,2],[60,12,35,8,"saveAll"],[60,19,35,15],[60,20,35,16,"next"],[60,24,35,20],[60,25,35,21],[61,6,36,2],[61,13,36,9,"msg"],[61,16,36,12],[62,4,37,0],[62,5,37,1],[63,4,37,1],[63,11,37,1,"_addMessage"],[63,22,37,1],[63,23,37,1,"apply"],[63,28,37,1],[63,35,37,1,"arguments"],[63,44,37,1],[64,2,37,1],[65,0,37,1],[65,3]],"functionMap":{"names":["<global>","loadAll","saveAll","getMessagesForApplication","all.filter$argument_0","all.filter.sort$argument_0","addMessage"],"mappings":"AAA;ACK;CDE;AEE;CFE;OGE;YCG,sCD;UEC,gDF;CHC;OME;CNgB"},"hasCjsExports":false},"type":"js/module"}]}