{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":28},"end":{"line":9,"column":15,"index":139}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../utils/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":10,"column":0,"index":140},"end":{"line":10,"column":64,"index":204}}],"key":"rswhtWQFlk40P6/ZSXiz3NZSC0I=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\"; // contexts/AuthContext.tsx\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _utilsStorage = require(_dependencyMap[1], \"../utils/storage\");\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const USER_KEY = '@shiftmatch:user';\n  const CREDENTIALS_KEY = '@shiftmatch:auth_users';\n  async function loadCredentials() {\n    const data = await (0, _utilsStorage.getItem)(CREDENTIALS_KEY);\n    return data ?? [];\n  }\n  async function saveCredentials(creds) {\n    await (0, _utilsStorage.setItem)(CREDENTIALS_KEY, creds);\n  }\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n\n    // beim Start User aus Storage holen\n    (0, _react.useEffect)(() => {\n      (async () => {\n        const stored = await (0, _utilsStorage.getItem)(USER_KEY);\n        if (stored) {\n          setUser(stored);\n        }\n        setIsLoading(false);\n      })();\n    }, []);\n    const value = (0, _react.useMemo)(() => {\n      return {\n        user,\n        isLoading,\n        async signUp(email, password) {\n          const creds = await loadCredentials();\n          const exists = creds.find(c => c.email.toLowerCase() === email.toLowerCase());\n          if (exists) {\n            throw new Error('E-Mail ist bereits registriert');\n          }\n          const newUser = {\n            id: 'u-' + Date.now().toString(),\n            email\n          };\n          const nextCreds = [...creds, {\n            email: email.toLowerCase(),\n            password\n          }];\n          await saveCredentials(nextCreds);\n          await (0, _utilsStorage.setItem)(USER_KEY, newUser);\n          setUser(newUser);\n        },\n        async signIn(email, password) {\n          const creds = await loadCredentials();\n          const found = creds.find(c => c.email.toLowerCase() === email.toLowerCase());\n          if (!found || found.password !== password) {\n            throw new Error('E-Mail oder Passwort ist falsch');\n          }\n\n          // Wenn es schon einen gespeicherten User mit Rolle gibt, nutze ihn\n          const stored = await (0, _utilsStorage.getItem)(USER_KEY);\n          if (stored && stored.email.toLowerCase() === email.toLowerCase()) {\n            setUser(stored);\n            return;\n          }\n\n          // Sonst neuen User ohne Rolle anlegen\n          const newUser = {\n            id: 'u-' + Date.now().toString(),\n            email\n          };\n          await (0, _utilsStorage.setItem)(USER_KEY, newUser);\n          setUser(newUser);\n        },\n        async signOut() {\n          setUser(null);\n          await (0, _utilsStorage.removeItem)(USER_KEY);\n        },\n        async setRole(role) {\n          if (!user) return;\n          const updated = {\n            id: user.id,\n            email: user.email,\n            role,\n            accountType: user.accountType\n          };\n          await (0, _utilsStorage.setItem)(USER_KEY, updated);\n          setUser(updated);\n        }\n      };\n    }, [user, isLoading]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: value,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 10\n    }, this);\n  };\n  function useAuth() {\n    const ctx = (0, _react.useContext)(AuthContext);\n    if (!ctx) {\n      throw new Error('AuthProvider fehlt');\n    }\n    return ctx;\n  }\n});","lineCount":121,"map":[[4,63,1,0],[5,2,1,0,"Object"],[5,8,1,0],[5,9,1,0,"defineProperty"],[5,23,1,0],[5,24,1,0,"exports"],[5,31,1,0],[6,4,1,0,"value"],[6,9,1,0],[7,2,1,0],[8,2,56,0,"Object"],[8,8,56,0],[8,9,56,0,"defineProperty"],[8,23,56,0],[8,24,56,0,"exports"],[8,31,56,0],[9,4,56,0,"enumerable"],[9,14,56,0],[10,4,56,0,"get"],[10,7,56,0],[10,18,56,0,"get"],[10,19,56,0],[11,6,56,0],[11,13,56,0,"AuthProvider"],[11,25,56,0],[12,4,56,0],[13,2,56,0],[14,2,143,0,"exports"],[14,9,143,0],[14,10,143,0,"useAuth"],[14,17,143,0],[14,20,143,0,"useAuth"],[14,27,143,0],[15,2,2,0],[15,6,2,0,"_react"],[15,12,2,0],[15,15,2,0,"require"],[15,22,2,0],[15,23,2,0,"_dependencyMap"],[15,37,2,0],[16,2,10,0],[16,6,10,0,"_utilsStorage"],[16,19,10,0],[16,22,10,0,"require"],[16,29,10,0],[16,30,10,0,"_dependencyMap"],[16,44,10,0],[17,2,10,64],[17,6,10,64,"_reactJsxDevRuntime"],[17,25,10,64],[17,28,10,64,"require"],[17,35,10,64],[17,36,10,64,"_dependencyMap"],[17,50,10,64],[18,2,30,0],[18,8,30,6,"AuthContext"],[18,19,30,17],[18,35,30,20],[18,39,30,20,"createContext"],[18,45,30,33],[18,46,30,33,"createContext"],[18,59,30,33],[18,61,30,64,"undefined"],[18,70,30,73],[18,71,30,74],[19,2,32,0],[19,8,32,6,"USER_KEY"],[19,16,32,14],[19,19,32,17],[19,37,32,35],[20,2,33,0],[20,8,33,6,"CREDENTIALS_KEY"],[20,23,33,21],[20,26,33,24],[20,50,33,48],[21,2,47,0],[21,17,47,15,"loadCredentials"],[21,32,47,30,"loadCredentials"],[21,33,47,30],[21,35,47,61],[22,4,48,2],[22,10,48,8,"data"],[22,14,48,12],[22,17,48,15],[22,23,48,21],[22,27,48,21,"getItem"],[22,40,48,28],[22,41,48,28,"getItem"],[22,48,48,28],[22,50,48,48,"CREDENTIALS_KEY"],[22,65,48,63],[22,66,48,64],[23,4,49,2],[23,11,49,9,"data"],[23,15,49,13],[23,19,49,17],[23,21,49,19],[24,2,50,0],[25,2,52,0],[25,17,52,15,"saveCredentials"],[25,32,52,30,"saveCredentials"],[25,33,52,31,"creds"],[25,38,52,55],[25,40,52,72],[26,4,53,2],[26,10,53,8],[26,14,53,8,"setItem"],[26,27,53,15],[26,28,53,15,"setItem"],[26,35,53,15],[26,37,53,16,"CREDENTIALS_KEY"],[26,52,53,31],[26,54,53,33,"creds"],[26,59,53,38],[26,60,53,39],[27,2,54,0],[28,2,56,7],[28,8,56,13,"AuthProvider"],[28,20,56,60],[28,23,56,63,"AuthProvider"],[28,24,56,64],[29,4,56,66,"children"],[30,2,56,75],[30,3,56,76],[30,8,56,81],[31,4,57,2],[31,10,57,8],[31,11,57,9,"user"],[31,15,57,13],[31,17,57,15,"setUser"],[31,24,57,22],[31,25,57,23],[31,28,57,26],[31,32,57,26,"useState"],[31,38,57,34],[31,39,57,34,"useState"],[31,47,57,34],[31,49,57,41],[31,53,57,45],[31,54,57,46],[32,4,58,2],[32,10,58,8],[32,11,58,9,"isLoading"],[32,20,58,18],[32,22,58,20,"setIsLoading"],[32,34,58,32],[32,35,58,33],[32,38,58,36],[32,42,58,36,"useState"],[32,48,58,44],[32,49,58,44,"useState"],[32,57,58,44],[32,59,58,45],[32,63,58,49],[32,64,58,50],[34,4,60,2],[35,4,61,2],[35,8,61,2,"useEffect"],[35,14,61,11],[35,15,61,11,"useEffect"],[35,24,61,11],[35,26,61,12],[35,32,61,18],[36,6,62,4],[36,7,62,5],[36,19,62,17],[37,8,63,6],[37,14,63,12,"stored"],[37,20,63,18],[37,23,63,21],[37,29,63,27],[37,33,63,27,"getItem"],[37,46,63,34],[37,47,63,34,"getItem"],[37,54,63,34],[37,56,63,47,"USER_KEY"],[37,64,63,55],[37,65,63,56],[38,8,64,6],[38,12,64,10,"stored"],[38,18,64,16],[38,20,64,18],[39,10,65,8,"setUser"],[39,17,65,15],[39,18,65,16,"stored"],[39,24,65,22],[39,25,65,23],[40,8,66,6],[41,8,67,6,"setIsLoading"],[41,20,67,18],[41,21,67,19],[41,26,67,24],[41,27,67,25],[42,6,68,4],[42,7,68,5],[42,9,68,7],[42,10,68,8],[43,4,69,2],[43,5,69,3],[43,7,69,5],[43,9,69,7],[43,10,69,8],[44,4,71,2],[44,10,71,8,"value"],[44,15,71,13],[44,18,71,16],[44,22,71,16,"useMemo"],[44,28,71,23],[44,29,71,23,"useMemo"],[44,36,71,23],[44,38,71,42],[44,44,71,48],[45,6,72,4],[45,13,72,11],[46,8,73,6,"user"],[46,12,73,10],[47,8,74,6,"isLoading"],[47,17,74,15],[48,8,76,6],[48,14,76,12,"signUp"],[48,20,76,18,"signUp"],[48,21,76,19,"email"],[48,26,76,24],[48,28,76,26,"password"],[48,36,76,34],[48,38,76,36],[49,10,77,8],[49,16,77,14,"creds"],[49,21,77,19],[49,24,77,22],[49,30,77,28,"loadCredentials"],[49,45,77,43],[49,46,77,44],[49,47,77,45],[50,10,78,8],[50,16,78,14,"exists"],[50,22,78,20],[50,25,78,23,"creds"],[50,30,78,28],[50,31,78,29,"find"],[50,35,78,33],[50,36,78,34,"c"],[50,37,78,35],[50,41,78,39,"c"],[50,42,78,40],[50,43,78,41,"email"],[50,48,78,46],[50,49,78,47,"toLowerCase"],[50,60,78,58],[50,61,78,59],[50,62,78,60],[50,67,78,65,"email"],[50,72,78,70],[50,73,78,71,"toLowerCase"],[50,84,78,82],[50,85,78,83],[50,86,78,84],[50,87,78,85],[51,10,79,8],[51,14,79,12,"exists"],[51,20,79,18],[51,22,79,20],[52,12,80,10],[52,18,80,16],[52,22,80,20,"Error"],[52,27,80,25],[52,28,80,26],[52,60,80,58],[52,61,80,59],[53,10,81,8],[54,10,83,8],[54,16,83,14,"newUser"],[54,23,83,33],[54,26,83,36],[55,12,84,10,"id"],[55,14,84,12],[55,16,84,14],[55,20,84,18],[55,23,84,21,"Date"],[55,27,84,25],[55,28,84,26,"now"],[55,31,84,29],[55,32,84,30],[55,33,84,31],[55,34,84,32,"toString"],[55,42,84,40],[55,43,84,41],[55,44,84,42],[56,12,85,10,"email"],[57,10,86,8],[57,11,86,9],[58,10,88,8],[58,16,88,14,"nextCreds"],[58,25,88,42],[58,28,88,45],[58,29,89,10],[58,32,89,13,"creds"],[58,37,89,18],[58,39,90,10],[59,12,90,12,"email"],[59,17,90,17],[59,19,90,19,"email"],[59,24,90,24],[59,25,90,25,"toLowerCase"],[59,36,90,36],[59,37,90,37],[59,38,90,38],[60,12,90,40,"password"],[61,10,90,49],[61,11,90,50],[61,12,91,9],[62,10,93,8],[62,16,93,14,"saveCredentials"],[62,31,93,29],[62,32,93,30,"nextCreds"],[62,41,93,39],[62,42,93,40],[63,10,94,8],[63,16,94,14],[63,20,94,14,"setItem"],[63,33,94,21],[63,34,94,21,"setItem"],[63,41,94,21],[63,43,94,22,"USER_KEY"],[63,51,94,30],[63,53,94,32,"newUser"],[63,60,94,39],[63,61,94,40],[64,10,95,8,"setUser"],[64,17,95,15],[64,18,95,16,"newUser"],[64,25,95,23],[64,26,95,24],[65,8,96,6],[65,9,96,7],[66,8,98,6],[66,14,98,12,"signIn"],[66,20,98,18,"signIn"],[66,21,98,19,"email"],[66,26,98,24],[66,28,98,26,"password"],[66,36,98,34],[66,38,98,36],[67,10,99,8],[67,16,99,14,"creds"],[67,21,99,19],[67,24,99,22],[67,30,99,28,"loadCredentials"],[67,45,99,43],[67,46,99,44],[67,47,99,45],[68,10,100,8],[68,16,100,14,"found"],[68,21,100,19],[68,24,100,22,"creds"],[68,29,100,27],[68,30,100,28,"find"],[68,34,100,32],[68,35,100,33,"c"],[68,36,100,34],[68,40,100,38,"c"],[68,41,100,39],[68,42,100,40,"email"],[68,47,100,45],[68,48,100,46,"toLowerCase"],[68,59,100,57],[68,60,100,58],[68,61,100,59],[68,66,100,64,"email"],[68,71,100,69],[68,72,100,70,"toLowerCase"],[68,83,100,81],[68,84,100,82],[68,85,100,83],[68,86,100,84],[69,10,101,8],[69,14,101,12],[69,15,101,13,"found"],[69,20,101,18],[69,24,101,22,"found"],[69,29,101,27],[69,30,101,28,"password"],[69,38,101,36],[69,43,101,41,"password"],[69,51,101,49],[69,53,101,51],[70,12,102,10],[70,18,102,16],[70,22,102,20,"Error"],[70,27,102,25],[70,28,102,26],[70,61,102,59],[70,62,102,60],[71,10,103,8],[73,10,105,8],[74,10,106,8],[74,16,106,14,"stored"],[74,22,106,20],[74,25,106,23],[74,31,106,29],[74,35,106,29,"getItem"],[74,48,106,36],[74,49,106,36,"getItem"],[74,56,106,36],[74,58,106,49,"USER_KEY"],[74,66,106,57],[74,67,106,58],[75,10,107,8],[75,14,107,12,"stored"],[75,20,107,18],[75,24,107,22,"stored"],[75,30,107,28],[75,31,107,29,"email"],[75,36,107,34],[75,37,107,35,"toLowerCase"],[75,48,107,46],[75,49,107,47],[75,50,107,48],[75,55,107,53,"email"],[75,60,107,58],[75,61,107,59,"toLowerCase"],[75,72,107,70],[75,73,107,71],[75,74,107,72],[75,76,107,74],[76,12,108,10,"setUser"],[76,19,108,17],[76,20,108,18,"stored"],[76,26,108,24],[76,27,108,25],[77,12,109,10],[78,10,110,8],[80,10,112,8],[81,10,113,8],[81,16,113,14,"newUser"],[81,23,113,33],[81,26,113,36],[82,12,114,10,"id"],[82,14,114,12],[82,16,114,14],[82,20,114,18],[82,23,114,21,"Date"],[82,27,114,25],[82,28,114,26,"now"],[82,31,114,29],[82,32,114,30],[82,33,114,31],[82,34,114,32,"toString"],[82,42,114,40],[82,43,114,41],[82,44,114,42],[83,12,115,10,"email"],[84,10,116,8],[84,11,116,9],[85,10,117,8],[85,16,117,14],[85,20,117,14,"setItem"],[85,33,117,21],[85,34,117,21,"setItem"],[85,41,117,21],[85,43,117,22,"USER_KEY"],[85,51,117,30],[85,53,117,32,"newUser"],[85,60,117,39],[85,61,117,40],[86,10,118,8,"setUser"],[86,17,118,15],[86,18,118,16,"newUser"],[86,25,118,23],[86,26,118,24],[87,8,119,6],[87,9,119,7],[88,8,121,6],[88,14,121,12,"signOut"],[88,21,121,19,"signOut"],[88,22,121,19],[88,24,121,22],[89,10,122,8,"setUser"],[89,17,122,15],[89,18,122,16],[89,22,122,20],[89,23,122,21],[90,10,123,8],[90,16,123,14],[90,20,123,14,"removeItem"],[90,33,123,24],[90,34,123,24,"removeItem"],[90,44,123,24],[90,46,123,25,"USER_KEY"],[90,54,123,33],[90,55,123,34],[91,8,124,6],[91,9,124,7],[92,8,126,6],[92,14,126,12,"setRole"],[92,21,126,19,"setRole"],[92,22,126,20,"role"],[92,26,126,24],[92,28,126,26],[93,10,127,8],[93,14,127,12],[93,15,127,13,"user"],[93,19,127,17],[93,21,127,19],[94,10,128,8],[94,16,128,14,"updated"],[94,23,128,33],[94,26,128,36],[95,12,129,10,"id"],[95,14,129,12],[95,16,129,14,"user"],[95,20,129,18],[95,21,129,19,"id"],[95,23,129,21],[96,12,130,10,"email"],[96,17,130,15],[96,19,130,17,"user"],[96,23,130,21],[96,24,130,22,"email"],[96,29,130,27],[97,12,131,10,"role"],[97,16,131,14],[98,12,132,10,"accountType"],[98,23,132,21],[98,25,132,23,"user"],[98,29,132,27],[98,30,132,28,"accountType"],[99,10,133,8],[99,11,133,9],[100,10,134,8],[100,16,134,14],[100,20,134,14,"setItem"],[100,33,134,21],[100,34,134,21,"setItem"],[100,41,134,21],[100,43,134,22,"USER_KEY"],[100,51,134,30],[100,53,134,32,"updated"],[100,60,134,39],[100,61,134,40],[101,10,135,8,"setUser"],[101,17,135,15],[101,18,135,16,"updated"],[101,25,135,23],[101,26,135,24],[102,8,136,6],[103,6,137,4],[103,7,137,5],[104,4,138,2],[104,5,138,3],[104,7,138,5],[104,8,138,6,"user"],[104,12,138,10],[104,14,138,12,"isLoading"],[104,23,138,21],[104,24,138,22],[104,25,138,23],[105,4,140,2],[105,24,140,9],[105,28,140,9,"_reactJsxDevRuntime"],[105,47,140,9],[105,48,140,9,"jsxDEV"],[105,54,140,9],[105,56,140,10,"AuthContext"],[105,67,140,21],[105,68,140,22,"Provider"],[105,76,140,30],[106,6,140,31,"value"],[106,11,140,36],[106,13,140,38,"value"],[106,18,140,44],[107,6,140,44,"children"],[107,14,140,44],[107,16,140,46,"children"],[108,4,140,54],[109,6,140,54,"fileName"],[109,14,140,54],[109,16,140,54,"_jsxFileName"],[109,28,140,54],[110,6,140,54,"lineNumber"],[110,16,140,54],[111,6,140,54,"columnNumber"],[111,18,140,54],[112,4,140,54],[112,11,140,77],[112,12,140,78],[113,2,141,0],[113,3,141,1],[114,2,143,7],[114,11,143,16,"useAuth"],[114,18,143,23,"useAuth"],[114,19,143,23],[114,21,143,44],[115,4,144,2],[115,10,144,8,"ctx"],[115,13,144,11],[115,16,144,14],[115,20,144,14,"useContext"],[115,26,144,24],[115,27,144,24,"useContext"],[115,37,144,24],[115,39,144,25,"AuthContext"],[115,50,144,36],[115,51,144,37],[116,4,145,2],[116,8,145,6],[116,9,145,7,"ctx"],[116,12,145,10],[116,14,145,12],[117,6,146,4],[117,12,146,10],[117,16,146,14,"Error"],[117,21,146,19],[117,22,146,20],[117,42,146,40],[117,43,146,41],[118,4,147,2],[119,4,148,2],[119,11,148,9,"ctx"],[119,14,148,12],[120,2,149,0],[121,0,149,1],[121,3]],"functionMap":{"names":["<global>","loadCredentials","saveCredentials","AuthProvider","useEffect$argument_0","<anonymous>","useMemo$argument_0","signUp","creds.find$argument_0","signIn","signOut","setRole","useAuth"],"mappings":"AAA;AC8C;CDG;AEE;CFE;+DGE;YCK;KCC;KDM;GDC;0CGE;MCK;kCCE,kDD;ODkB;MGE;iCDE,kDC;OHmB;MIE;OJG;MKE;OLU;GHE;CHG;OYE"},"hasCjsExports":false},"type":"js/module"}]}