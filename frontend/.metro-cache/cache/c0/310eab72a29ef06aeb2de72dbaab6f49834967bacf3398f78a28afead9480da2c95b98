{"dependencies":[{"name":"@babel/runtime/helpers/defineProperty","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"X490zePjq+0IljAc8X0qcBg0iTo=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":89},"end":{"line":5,"column":31,"index":120}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"./NavigationBuilderContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":122},"end":{"line":9,"column":36,"index":222}}],"key":"KFIEweWhugyJmWZL0YQ42pa68TE=","exportNames":["*"],"imports":1}},{"name":"./NavigationRouteContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":10,"column":0,"index":223},"end":{"line":10,"column":62,"index":285}}],"key":"I5Ob2ePenkMlCuG37rE0R3UVd48=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return useOnPreventRemove;\n    }\n  });\n  Object.defineProperty(exports, \"shouldPreventRemove\", {\n    enumerable: true,\n    get: function () {\n      return shouldPreventRemove;\n    }\n  });\n  var _babelRuntimeHelpersDefineProperty = require(_dependencyMap[0], \"@babel/runtime/helpers/defineProperty\");\n  var _defineProperty = _interopDefault(_babelRuntimeHelpersDefineProperty);\n  var _react = require(_dependencyMap[1], \"react\");\n  var React = _interopNamespace(_react);\n  var _NavigationBuilderContext = require(_dependencyMap[2], \"./NavigationBuilderContext\");\n  var NavigationBuilderContext = _interopDefault(_NavigationBuilderContext);\n  var _NavigationRouteContext = require(_dependencyMap[3], \"./NavigationRouteContext\");\n  var NavigationRouteContext = _interopDefault(_NavigationRouteContext);\n  var VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n  var shouldPreventRemove = function shouldPreventRemove(emitter, beforeRemoveListeners, currentRoutes, nextRoutes, action) {\n    var _action$VISITED_ROUTE;\n    var nextRouteKeys = nextRoutes.map(function (route) {\n      return route.key;\n    });\n\n    // Call these in reverse order so last screens handle the event first\n    var removedRoutes = currentRoutes.filter(function (route) {\n      return !nextRouteKeys.includes(route.key);\n    }).reverse();\n    var visitedRouteKeys = // @ts-expect-error: add this property to mark that we've already emitted this action\n    (_action$VISITED_ROUTE = action[VISITED_ROUTE_KEYS]) != null ? _action$VISITED_ROUTE : new Set();\n    var beforeRemoveAction = Object.assign({}, action, (0, _defineProperty.default)({}, VISITED_ROUTE_KEYS, visitedRouteKeys));\n    for (var route of removedRoutes) {\n      var _beforeRemoveListener;\n      if (visitedRouteKeys.has(route.key)) {\n        // Skip if we've already emitted this action for this screen\n        continue;\n      }\n\n      // First, we need to check if any child screens want to prevent it\n      var isPrevented = (_beforeRemoveListener = beforeRemoveListeners[route.key]) == null ? void 0 : _beforeRemoveListener.call(beforeRemoveListeners, beforeRemoveAction);\n      if (isPrevented) {\n        return true;\n      }\n      visitedRouteKeys.add(route.key);\n      var event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n    return false;\n  };\n  function useOnPreventRemove(_ref) {\n    var getState = _ref.getState,\n      emitter = _ref.emitter,\n      beforeRemoveListeners = _ref.beforeRemoveListeners;\n    var _React$useContext = React.useContext(NavigationBuilderContext.default),\n      addKeyedListener = _React$useContext.addKeyedListener;\n    var route = React.useContext(NavigationRouteContext.default);\n    var routeKey = route == null ? void 0 : route.key;\n    React.useEffect(function () {\n      if (routeKey) {\n        return addKeyedListener == null ? void 0 : addKeyedListener('beforeRemove', routeKey, function (action) {\n          var state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, [], action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":105,"map":[[27,2,75,15,"Object"],[27,8,75,15],[27,9,75,15,"defineProperty"],[27,23,75,15],[27,24,75,15,"exports"],[27,31,75,15],[28,4,75,15,"enumerable"],[28,14,75,15],[29,4,75,15,"get"],[29,7,75,15],[29,18,75,15,"get"],[29,19,75,15],[30,6,75,15],[30,13,75,15,"useOnPreventRemove"],[30,31,75,15],[31,4,75,15],[32,2,75,15],[33,2,22,0,"Object"],[33,8,22,0],[33,9,22,0,"defineProperty"],[33,23,22,0],[33,24,22,0,"exports"],[33,31,22,0],[34,4,22,0,"enumerable"],[34,14,22,0],[35,4,22,0,"get"],[35,7,22,0],[35,18,22,0,"get"],[35,19,22,0],[36,6,22,0],[36,13,22,0,"shouldPreventRemove"],[36,32,22,0],[37,4,22,0],[38,2,22,0],[39,2,73,2],[39,6,73,2,"_babelRuntimeHelpersDefineProperty"],[39,40,73,2],[39,43,73,2,"require"],[39,50,73,2],[39,51,73,2,"_dependencyMap"],[39,65,73,2],[40,2,73,2],[40,6,73,2,"_defineProperty"],[40,21,73,2],[40,24,73,2,"_interopDefault"],[40,39,73,2],[40,40,73,2,"_babelRuntimeHelpersDefineProperty"],[40,74,73,2],[41,2,5,0],[41,6,5,0,"_react"],[41,12,5,0],[41,15,5,0,"require"],[41,22,5,0],[41,23,5,0,"_dependencyMap"],[41,37,5,0],[42,2,5,0],[42,6,5,0,"React"],[42,11,5,0],[42,14,5,0,"_interopNamespace"],[42,31,5,0],[42,32,5,0,"_react"],[42,38,5,0],[43,2,7,0],[43,6,7,0,"_NavigationBuilderContext"],[43,31,7,0],[43,34,7,0,"require"],[43,41,7,0],[43,42,7,0,"_dependencyMap"],[43,56,7,0],[44,2,7,0],[44,6,7,0,"NavigationBuilderContext"],[44,30,7,0],[44,33,7,0,"_interopDefault"],[44,48,7,0],[44,49,7,0,"_NavigationBuilderContext"],[44,74,7,0],[45,2,10,0],[45,6,10,0,"_NavigationRouteContext"],[45,29,10,0],[45,32,10,0,"require"],[45,39,10,0],[45,40,10,0,"_dependencyMap"],[45,54,10,0],[46,2,10,0],[46,6,10,0,"NavigationRouteContext"],[46,28,10,0],[46,31,10,0,"_interopDefault"],[46,46,10,0],[46,47,10,0,"_NavigationRouteContext"],[46,70,10,0],[47,2,20,0],[47,6,20,6,"VISITED_ROUTE_KEYS"],[47,24,20,24],[47,27,20,27,"Symbol"],[47,33,20,33],[47,34,20,34],[47,54,20,54],[47,55,20,55],[48,2,22,7],[48,6,22,13,"shouldPreventRemove"],[48,25,22,32],[48,28,22,35],[48,37,22,13,"shouldPreventRemove"],[48,56,22,32,"shouldPreventRemove"],[48,57,23,2,"emitter"],[48,64,23,52],[48,66,24,2,"beforeRemoveListeners"],[48,87,24,78],[48,89,25,2,"currentRoutes"],[48,102,25,34],[48,104,26,2,"nextRoutes"],[48,114,26,44],[48,116,27,2,"action"],[48,122,27,26],[48,124,28,5],[49,4,28,5],[49,8,28,5,"_action$VISITED_ROUTE"],[49,29,28,5],[50,4,29,2],[50,8,29,8,"nextRouteKeys"],[50,21,29,21],[50,24,29,24,"nextRoutes"],[50,34,29,34],[50,35,29,35,"map"],[50,38,29,38],[50,39,29,39],[50,49,29,40,"route"],[50,54,29,45],[51,6,29,45],[51,13,29,50,"route"],[51,18,29,55],[51,19,29,56,"key"],[51,22,29,59],[52,4,29,59],[52,6,29,60],[54,4,31,2],[55,4,32,2],[55,8,32,8,"removedRoutes"],[55,21,32,21],[55,24,32,24,"currentRoutes"],[55,37,32,37],[55,38,33,5,"filter"],[55,44,33,11],[55,45,33,12],[55,55,33,13,"route"],[55,60,33,18],[56,6,33,18],[56,13,33,23],[56,14,33,24,"nextRouteKeys"],[56,27,33,37],[56,28,33,38,"includes"],[56,36,33,46],[56,37,33,47,"route"],[56,42,33,52],[56,43,33,53,"key"],[56,46,33,56],[56,47,33,57],[57,4,33,57],[57,6,33,58],[57,7,34,5,"reverse"],[57,14,34,12],[57,15,34,13],[57,16,34,14],[58,4,36,2],[58,8,36,8,"visitedRouteKeys"],[58,24,36,37],[58,27,37,4],[59,4,37,4],[59,5,37,4,"_action$VISITED_ROUTE"],[59,26,37,4],[59,29,38,4,"action"],[59,35,38,10],[59,36,38,11,"VISITED_ROUTE_KEYS"],[59,54,38,29],[59,55,38,30],[59,67,38,30,"_action$VISITED_ROUTE"],[59,88,38,30],[59,91,38,34],[59,95,38,38,"Set"],[59,98,38,41],[59,99,38,50],[59,100,38,51],[60,4,40,2],[60,8,40,8,"beforeRemoveAction"],[60,26,40,26],[60,29,40,26,"Object"],[60,35,40,26],[60,36,40,26,"assign"],[60,42,40,26],[60,47,41,7,"action"],[60,53,41,13],[60,59,41,13,"_defineProperty"],[60,74,41,13],[60,75,41,13,"default"],[60,82,41,13],[60,88,42,5,"VISITED_ROUTE_KEYS"],[60,106,42,23],[60,108,42,26,"visitedRouteKeys"],[60,124,42,42],[60,126,43,3],[61,4,45,2],[61,9,45,7],[61,13,45,13,"route"],[61,18,45,18],[61,22,45,22,"removedRoutes"],[61,35,45,35],[61,37,45,37],[62,6,45,37],[62,10,45,37,"_beforeRemoveListener"],[62,31,45,37],[63,6,46,4],[63,10,46,8,"visitedRouteKeys"],[63,26,46,24],[63,27,46,25,"has"],[63,30,46,28],[63,31,46,29,"route"],[63,36,46,34],[63,37,46,35,"key"],[63,40,46,38],[63,41,46,39],[63,43,46,41],[64,8,47,6],[65,8,48,6],[66,6,49,4],[68,6,51,4],[69,6,52,4],[69,10,52,10,"isPrevented"],[69,21,52,21],[69,25,52,21,"_beforeRemoveListener"],[69,46,52,21],[69,49,52,24,"beforeRemoveListeners"],[69,70,52,45],[69,71,52,46,"route"],[69,76,52,51],[69,77,52,52,"key"],[69,80,52,55],[69,81,52,56],[69,102,52,24,"_beforeRemoveListener"],[69,123,52,24],[69,124,52,24,"call"],[69,128,52,24],[69,129,52,24,"beforeRemoveListeners"],[69,150,52,45],[69,152,52,59,"beforeRemoveAction"],[69,170,52,77],[69,171,52,78],[70,6,54,4],[70,10,54,8,"isPrevented"],[70,21,54,19],[70,23,54,21],[71,8,55,6],[71,15,55,13],[71,19,55,17],[72,6,56,4],[73,6,58,4,"visitedRouteKeys"],[73,22,58,20],[73,23,58,21,"add"],[73,26,58,24],[73,27,58,25,"route"],[73,32,58,30],[73,33,58,31,"key"],[73,36,58,34],[73,37,58,35],[74,6,60,4],[74,10,60,10,"event"],[74,15,60,15],[74,18,60,18,"emitter"],[74,25,60,25],[74,26,60,26,"emit"],[74,30,60,30],[74,31,60,31],[75,8,61,6,"type"],[75,12,61,10],[75,14,61,12],[75,28,61,26],[76,8,62,6,"target"],[76,14,62,12],[76,16,62,14,"route"],[76,21,62,19],[76,22,62,20,"key"],[76,25,62,23],[77,8,63,6,"data"],[77,12,63,10],[77,14,63,12],[78,10,63,14,"action"],[78,16,63,20],[78,18,63,22,"beforeRemoveAction"],[79,8,63,41],[79,9,63,42],[80,8,64,6,"canPreventDefault"],[80,25,64,23],[80,27,64,25],[81,6,65,4],[81,7,65,5],[81,8,65,6],[82,6,67,4],[82,10,67,8,"event"],[82,15,67,13],[82,16,67,14,"defaultPrevented"],[82,32,67,30],[82,34,67,32],[83,8,68,6],[83,15,68,13],[83,19,68,17],[84,6,69,4],[85,4,70,2],[86,4,72,2],[86,11,72,9],[86,16,72,14],[87,2,73,0],[87,3,73,1],[88,2,75,15],[88,11,75,24,"useOnPreventRemove"],[88,29,75,42,"useOnPreventRemove"],[88,30,75,42,"_ref"],[88,34,75,42],[88,36,79,12],[89,4,79,12],[89,8,76,2,"getState"],[89,16,76,10],[89,19,76,10,"_ref"],[89,23,76,10],[89,24,76,2,"getState"],[89,32,76,10],[90,6,77,2,"emitter"],[90,13,77,9],[90,16,77,9,"_ref"],[90,20,77,9],[90,21,77,2,"emitter"],[90,28,77,9],[91,6,78,2,"beforeRemoveListeners"],[91,27,78,23],[91,30,78,23,"_ref"],[91,34,78,23],[91,35,78,2,"beforeRemoveListeners"],[91,56,78,23],[92,4,80,2],[92,8,80,2,"_React$useContext"],[92,25,80,2],[92,28,80,31,"React"],[92,33,80,36],[92,34,80,37,"useContext"],[92,44,80,47],[92,45,80,48,"NavigationBuilderContext"],[92,69,80,72],[92,70,80,72,"default"],[92,77,80,72],[92,78,80,73],[93,6,80,10,"addKeyedListener"],[93,22,80,26],[93,25,80,26,"_React$useContext"],[93,42,80,26],[93,43,80,10,"addKeyedListener"],[93,59,80,26],[94,4,81,2],[94,8,81,8,"route"],[94,13,81,13],[94,16,81,16,"React"],[94,21,81,21],[94,22,81,22,"useContext"],[94,32,81,32],[94,33,81,33,"NavigationRouteContext"],[94,55,81,55],[94,56,81,55,"default"],[94,63,81,55],[94,64,81,56],[95,4,82,2],[95,8,82,8,"routeKey"],[95,16,82,16],[95,19,82,19,"route"],[95,24,82,24],[95,44,82,19,"route"],[95,49,82,24],[95,50,82,26,"key"],[95,53,82,29],[96,4,84,2,"React"],[96,9,84,7],[96,10,84,8,"useEffect"],[96,19,84,17],[96,20,84,18],[96,32,84,24],[97,6,85,4],[97,10,85,8,"routeKey"],[97,18,85,16],[97,20,85,18],[98,8,86,6],[98,15,86,13,"addKeyedListener"],[98,31,86,29],[98,51,86,13,"addKeyedListener"],[98,67,86,29],[98,68,86,32],[98,82,86,46],[98,84,86,48,"routeKey"],[98,92,86,56],[98,94,86,58],[98,104,86,59,"action"],[98,110,86,65],[98,112,86,70],[99,10,87,8],[99,14,87,14,"state"],[99,19,87,19],[99,22,87,22,"getState"],[99,30,87,30],[99,31,87,31],[99,32,87,32],[100,10,89,8],[100,17,89,15,"shouldPreventRemove"],[100,36,89,34],[100,37,90,10,"emitter"],[100,44,90,17],[100,46,91,10,"beforeRemoveListeners"],[100,67,91,31],[100,69,92,10,"state"],[100,74,92,15],[100,75,92,16,"routes"],[100,81,92,22],[100,83,93,10],[100,85,93,12],[100,87,94,10,"action"],[100,93,95,8],[100,94,95,9],[101,8,96,6],[101,9,96,7],[101,10,96,8],[102,6,97,4],[103,4,98,2],[103,5,98,3],[103,7,98,5],[103,8,98,6,"addKeyedListener"],[103,24,98,22],[103,26,98,24,"beforeRemoveListeners"],[103,47,98,45],[103,49,98,47,"emitter"],[103,56,98,54],[103,58,98,56,"getState"],[103,66,98,64],[103,68,98,66,"routeKey"],[103,76,98,74],[103,77,98,75],[103,78,98,76],[104,2,99,0],[105,0,99,1],[105,3]],"functionMap":{"names":["<global>","shouldPreventRemove","nextRoutes.map$argument_0","currentRoutes.filter$argument_0","useOnPreventRemove","React.useEffect$argument_0","addKeyedListener$argument_2"],"mappings":"AAA;mCCqB;uCCO,oBD;YEI,6CF;CDwC;eIE;kBCS;0DCE;ODU;GDE;CJC"},"hasCjsExports":false},"type":"js/module"}]}