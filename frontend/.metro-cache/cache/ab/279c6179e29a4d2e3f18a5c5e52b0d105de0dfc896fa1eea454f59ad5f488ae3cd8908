{"dependencies":[{"name":"./storage","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":57,"index":57}}],"key":"dkq9sfvDyrGcbIAsF1EmLCvdhOw="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.addJob = addJob;\n  exports.clearJobs = clearJobs;\n  exports.deleteJob = deleteJob;\n  exports.getAllJobs = getAllJobs;\n  exports.getEmployerAuftraege = getEmployerAuftraege;\n  exports.getEmployerAuftr√§ge = getEmployerAuftr√§ge;\n  exports.getEmployerJobs = getEmployerJobs;\n  exports.getJobById = getJobById;\n  exports.getJobs = getJobs;\n  exports.getOpenJobs = getOpenJobs;\n  exports.saveJob = saveJob;\n  exports.updateJob = updateJob;\n  var _storage = require(_dependencyMap[0], \"./storage\");\n  const JOBS_KEY = '@shiftmatch:jobs';\n\n  // Internal helper: Load all jobs from storage\n  async function loadJobs() {\n    const stored = await (0, _storage.getItem)(JOBS_KEY);\n    return stored ?? [];\n  }\n\n  // Internal helper: Save all jobs to storage\n  async function saveJobsInternal(jobs) {\n    await (0, _storage.setItem)(JOBS_KEY, jobs);\n  }\n  async function addJob(job) {\n    const jobs = await loadJobs();\n    await saveJobsInternal([...jobs, job]);\n  }\n  async function getJobs() {\n    return await loadJobs();\n  }\n  async function updateJob(id, patch) {\n    const jobs = await loadJobs();\n    const next = jobs.map(j => j.id === id ? {\n      ...j,\n      ...patch\n    } : j);\n    await saveJobsInternal(next);\n  }\n  async function clearJobs() {\n    await (0, _storage.removeItem)(JOBS_KEY);\n  }\n\n  // Legacy/convenience functions\n  async function getAllJobs() {\n    return await getJobs();\n  }\n  async function saveJob(job) {\n    const all = await loadJobs();\n    const existing = all.findIndex(j => j.id === job.id);\n    if (existing >= 0) {\n      await updateJob(job.id, job);\n    } else {\n      await addJob(job);\n    }\n  }\n  async function getEmployerJobs(employerId) {\n    const all = await loadJobs();\n    let needsSave = false;\n\n    // Migration: Fix jobs without employerId\n    const fixed = all.map(job => {\n      // Check if job has no employerId or employerId is undefined\n      if (!job.employerId || job.employerId === 'undefined') {\n        // Check if there's an old ownerId field\n        const legacyOwnerId = job.ownerId;\n        if (legacyOwnerId) {\n          console.log(`üîß Migrating job ${job.id}: ownerId ‚Üí employerId`);\n          job.employerId = legacyOwnerId;\n          needsSave = true;\n        } else if (job.status === 'open' || job.status === 'draft') {\n          // For open/draft jobs without any owner info, assign to current employer\n          console.log(`üîß Assigning job ${job.id} to employer ${employerId}`);\n          job.employerId = employerId;\n          needsSave = true;\n        }\n      }\n      return job;\n    });\n\n    // Save back if we made changes\n    if (needsSave) {\n      console.log('üíæ Saving migrated jobs to storage');\n      await saveJobsInternal(fixed);\n    }\n\n    // Filter jobs for this employer\n    const mine = fixed.filter(j => j.employerId === employerId);\n    console.log(`üìã getEmployerJobs: Found ${mine.length} jobs for employer ${employerId}`);\n    return mine;\n  }\n  async function getOpenJobs() {\n    const all = await loadJobs();\n    return all.filter(j => j.status === 'open');\n  }\n  async function getJobById(id) {\n    const all = await loadJobs();\n    return all.find(j => j.id === id) || null;\n  }\n  async function deleteJob(id) {\n    const jobs = await loadJobs();\n    const next = jobs.filter(j => j.id !== id);\n    await saveJobsInternal(next);\n  }\n\n  // COMPATIBILITY ALIASES - For backwards compatibility\n  // (in case old code or sed replacements created these function calls)\n  async function getEmployerAuftr√§ge(employerId) {\n    console.warn('‚ö†Ô∏è Deprecated: getEmployerAuftr√§ge() is deprecated. Use getEmployerJobs() instead.');\n    return await getEmployerJobs(employerId);\n  }\n  async function getEmployerAuftraege(employerId) {\n    console.warn('‚ö†Ô∏è Deprecated: getEmployerAuftraege() is deprecated. Use getEmployerJobs() instead.');\n    return await getEmployerJobs(employerId);\n  }\n});","lineCount":121,"map":[[17,2,1,0],[17,6,1,0,"_storage"],[17,14,1,0],[17,17,1,0,"require"],[17,24,1,0],[17,25,1,0,"_dependencyMap"],[17,39,1,0],[18,2,4,0],[18,8,4,6,"JOBS_KEY"],[18,16,4,14],[18,19,4,17],[18,37,4,35],[20,2,6,0],[21,2,7,0],[21,17,7,15,"loadJobs"],[21,25,7,23,"loadJobs"],[21,26,7,23],[21,28,7,42],[22,4,8,2],[22,10,8,8,"stored"],[22,16,8,14],[22,19,8,17],[22,25,8,23],[22,29,8,23,"getItem"],[22,45,8,30],[22,47,8,38,"JOBS_KEY"],[22,55,8,46],[22,56,8,47],[23,4,9,2],[23,11,9,9,"stored"],[23,17,9,15],[23,21,9,19],[23,23,9,21],[24,2,10,0],[26,2,12,0],[27,2,13,0],[27,17,13,15,"saveJobsInternal"],[27,33,13,31,"saveJobsInternal"],[27,34,13,32,"jobs"],[27,38,13,43],[27,40,13,60],[28,4,14,2],[28,10,14,8],[28,14,14,8,"setItem"],[28,30,14,15],[28,32,14,23,"JOBS_KEY"],[28,40,14,31],[28,42,14,33,"jobs"],[28,46,14,37],[28,47,14,38],[29,2,15,0],[30,2,17,7],[30,17,17,22,"addJob"],[30,23,17,28,"addJob"],[30,24,17,29,"job"],[30,27,17,37],[30,29,17,54],[31,4,18,2],[31,10,18,8,"jobs"],[31,14,18,12],[31,17,18,15],[31,23,18,21,"loadJobs"],[31,31,18,29],[31,32,18,30],[31,33,18,31],[32,4,19,2],[32,10,19,8,"saveJobsInternal"],[32,26,19,24],[32,27,19,25],[32,28,19,26],[32,31,19,29,"jobs"],[32,35,19,33],[32,37,19,35,"job"],[32,40,19,38],[32,41,19,39],[32,42,19,40],[33,2,20,0],[34,2,22,7],[34,17,22,22,"getJobs"],[34,24,22,29,"getJobs"],[34,25,22,29],[34,27,22,48],[35,4,23,2],[35,11,23,9],[35,17,23,15,"loadJobs"],[35,25,23,23],[35,26,23,24],[35,27,23,25],[36,2,24,0],[37,2,26,7],[37,17,26,22,"updateJob"],[37,26,26,31,"updateJob"],[37,27,26,32,"id"],[37,29,26,42],[37,31,26,44,"patch"],[37,36,26,63],[37,38,26,80],[38,4,27,2],[38,10,27,8,"jobs"],[38,14,27,12],[38,17,27,15],[38,23,27,21,"loadJobs"],[38,31,27,29],[38,32,27,30],[38,33,27,31],[39,4,28,2],[39,10,28,8,"next"],[39,14,28,12],[39,17,28,15,"jobs"],[39,21,28,19],[39,22,28,20,"map"],[39,25,28,23],[39,26,28,24,"j"],[39,27,28,25],[39,31,28,30,"j"],[39,32,28,31],[39,33,28,32,"id"],[39,35,28,34],[39,40,28,39,"id"],[39,42,28,41],[39,45,28,44],[40,6,28,46],[40,9,28,49,"j"],[40,10,28,50],[41,6,28,52],[41,9,28,55,"patch"],[42,4,28,61],[42,5,28,62],[42,8,28,65,"j"],[42,9,28,67],[42,10,28,68],[43,4,29,2],[43,10,29,8,"saveJobsInternal"],[43,26,29,24],[43,27,29,25,"next"],[43,31,29,29],[43,32,29,30],[44,2,30,0],[45,2,32,7],[45,17,32,22,"clearJobs"],[45,26,32,31,"clearJobs"],[45,27,32,31],[45,29,32,49],[46,4,33,2],[46,10,33,8],[46,14,33,8,"removeItem"],[46,33,33,18],[46,35,33,19,"JOBS_KEY"],[46,43,33,27],[46,44,33,28],[47,2,34,0],[49,2,36,0],[50,2,37,7],[50,17,37,22,"getAllJobs"],[50,27,37,32,"getAllJobs"],[50,28,37,32],[50,30,37,51],[51,4,38,2],[51,11,38,9],[51,17,38,15,"getJobs"],[51,24,38,22],[51,25,38,23],[51,26,38,24],[52,2,39,0],[53,2,41,7],[53,17,41,22,"saveJob"],[53,24,41,29,"saveJob"],[53,25,41,30,"job"],[53,28,41,38],[53,30,41,55],[54,4,42,2],[54,10,42,8,"all"],[54,13,42,11],[54,16,42,14],[54,22,42,20,"loadJobs"],[54,30,42,28],[54,31,42,29],[54,32,42,30],[55,4,43,2],[55,10,43,8,"existing"],[55,18,43,16],[55,21,43,19,"all"],[55,24,43,22],[55,25,43,23,"findIndex"],[55,34,43,32],[55,35,43,33,"j"],[55,36,43,34],[55,40,43,38,"j"],[55,41,43,39],[55,42,43,40,"id"],[55,44,43,42],[55,49,43,47,"job"],[55,52,43,50],[55,53,43,51,"id"],[55,55,43,53],[55,56,43,54],[56,4,44,2],[56,8,44,6,"existing"],[56,16,44,14],[56,20,44,18],[56,21,44,19],[56,23,44,21],[57,6,45,4],[57,12,45,10,"updateJob"],[57,21,45,19],[57,22,45,20,"job"],[57,25,45,23],[57,26,45,24,"id"],[57,28,45,26],[57,30,45,28,"job"],[57,33,45,31],[57,34,45,32],[58,4,46,2],[58,5,46,3],[58,11,46,9],[59,6,47,4],[59,12,47,10,"addJob"],[59,18,47,16],[59,19,47,17,"job"],[59,22,47,20],[59,23,47,21],[60,4,48,2],[61,2,49,0],[62,2,51,7],[62,17,51,22,"getEmployerJobs"],[62,32,51,37,"getEmployerJobs"],[62,33,51,38,"employerId"],[62,43,51,56],[62,45,51,74],[63,4,52,2],[63,10,52,8,"all"],[63,13,52,11],[63,16,52,14],[63,22,52,20,"loadJobs"],[63,30,52,28],[63,31,52,29],[63,32,52,30],[64,4,53,2],[64,8,53,6,"needsSave"],[64,17,53,15],[64,20,53,18],[64,25,53,23],[66,4,55,2],[67,4,56,2],[67,10,56,8,"fixed"],[67,15,56,13],[67,18,56,16,"all"],[67,21,56,19],[67,22,56,20,"map"],[67,25,56,23],[67,26,56,24,"job"],[67,29,56,27],[67,33,56,31],[68,6,57,4],[69,6,58,4],[69,10,58,8],[69,11,58,9,"job"],[69,14,58,12],[69,15,58,13,"employerId"],[69,25,58,23],[69,29,58,27,"job"],[69,32,58,30],[69,33,58,31,"employerId"],[69,43,58,41],[69,48,58,46],[69,59,58,57],[69,61,58,59],[70,8,59,6],[71,8,60,6],[71,14,60,12,"legacyOwnerId"],[71,27,60,25],[71,30,60,29,"job"],[71,33,60,32],[71,34,60,41,"ownerId"],[71,41,60,48],[72,8,62,6],[72,12,62,10,"legacyOwnerId"],[72,25,62,23],[72,27,62,25],[73,10,63,8,"console"],[73,17,63,15],[73,18,63,16,"log"],[73,21,63,19],[73,22,63,20],[73,42,63,40,"job"],[73,45,63,43],[73,46,63,44,"id"],[73,48,63,46],[73,72,63,70],[73,73,63,71],[74,10,64,8,"job"],[74,13,64,11],[74,14,64,12,"employerId"],[74,24,64,22],[74,27,64,25,"legacyOwnerId"],[74,40,64,38],[75,10,65,8,"needsSave"],[75,19,65,17],[75,22,65,20],[75,26,65,24],[76,8,66,6],[76,9,66,7],[76,15,66,13],[76,19,66,17,"job"],[76,22,66,20],[76,23,66,21,"status"],[76,29,66,27],[76,34,66,32],[76,40,66,38],[76,44,66,42,"job"],[76,47,66,45],[76,48,66,46,"status"],[76,54,66,52],[76,59,66,57],[76,66,66,64],[76,68,66,66],[77,10,67,8],[78,10,68,8,"console"],[78,17,68,15],[78,18,68,16,"log"],[78,21,68,19],[78,22,68,20],[78,42,68,40,"job"],[78,45,68,43],[78,46,68,44,"id"],[78,48,68,46],[78,64,68,62,"employerId"],[78,74,68,72],[78,76,68,74],[78,77,68,75],[79,10,69,8,"job"],[79,13,69,11],[79,14,69,12,"employerId"],[79,24,69,22],[79,27,69,25,"employerId"],[79,37,69,35],[80,10,70,8,"needsSave"],[80,19,70,17],[80,22,70,20],[80,26,70,24],[81,8,71,6],[82,6,72,4],[83,6,73,4],[83,13,73,11,"job"],[83,16,73,14],[84,4,74,2],[84,5,74,3],[84,6,74,4],[86,4,76,2],[87,4,77,2],[87,8,77,6,"needsSave"],[87,17,77,15],[87,19,77,17],[88,6,78,4,"console"],[88,13,78,11],[88,14,78,12,"log"],[88,17,78,15],[88,18,78,16],[88,54,78,52],[88,55,78,53],[89,6,79,4],[89,12,79,10,"saveJobsInternal"],[89,28,79,26],[89,29,79,27,"fixed"],[89,34,79,32],[89,35,79,33],[90,4,80,2],[92,4,82,2],[93,4,83,2],[93,10,83,8,"mine"],[93,14,83,12],[93,17,83,15,"fixed"],[93,22,83,20],[93,23,83,21,"filter"],[93,29,83,27],[93,30,83,28,"j"],[93,31,83,29],[93,35,83,33,"j"],[93,36,83,34],[93,37,83,35,"employerId"],[93,47,83,45],[93,52,83,50,"employerId"],[93,62,83,60],[93,63,83,61],[94,4,84,2,"console"],[94,11,84,9],[94,12,84,10,"log"],[94,15,84,13],[94,16,84,14],[94,45,84,43,"mine"],[94,49,84,47],[94,50,84,48,"length"],[94,56,84,54],[94,78,84,76,"employerId"],[94,88,84,86],[94,90,84,88],[94,91,84,89],[95,4,86,2],[95,11,86,9,"mine"],[95,15,86,13],[96,2,87,0],[97,2,89,7],[97,17,89,22,"getOpenJobs"],[97,28,89,33,"getOpenJobs"],[97,29,89,33],[97,31,89,52],[98,4,90,2],[98,10,90,8,"all"],[98,13,90,11],[98,16,90,14],[98,22,90,20,"loadJobs"],[98,30,90,28],[98,31,90,29],[98,32,90,30],[99,4,91,2],[99,11,91,9,"all"],[99,14,91,12],[99,15,91,13,"filter"],[99,21,91,19],[99,22,91,20,"j"],[99,23,91,21],[99,27,91,25,"j"],[99,28,91,26],[99,29,91,27,"status"],[99,35,91,33],[99,40,91,38],[99,46,91,44],[99,47,91,45],[100,2,92,0],[101,2,94,7],[101,17,94,22,"getJobById"],[101,27,94,32,"getJobById"],[101,28,94,33,"id"],[101,30,94,43],[101,32,94,66],[102,4,95,2],[102,10,95,8,"all"],[102,13,95,11],[102,16,95,14],[102,22,95,20,"loadJobs"],[102,30,95,28],[102,31,95,29],[102,32,95,30],[103,4,96,2],[103,11,96,9,"all"],[103,14,96,12],[103,15,96,13,"find"],[103,19,96,17],[103,20,96,18,"j"],[103,21,96,19],[103,25,96,23,"j"],[103,26,96,24],[103,27,96,25,"id"],[103,29,96,27],[103,34,96,32,"id"],[103,36,96,34],[103,37,96,35],[103,41,96,39],[103,45,96,43],[104,2,97,0],[105,2,99,7],[105,17,99,22,"deleteJob"],[105,26,99,31,"deleteJob"],[105,27,99,32,"id"],[105,29,99,42],[105,31,99,59],[106,4,100,2],[106,10,100,8,"jobs"],[106,14,100,12],[106,17,100,15],[106,23,100,21,"loadJobs"],[106,31,100,29],[106,32,100,30],[106,33,100,31],[107,4,101,2],[107,10,101,8,"next"],[107,14,101,12],[107,17,101,15,"jobs"],[107,21,101,19],[107,22,101,20,"filter"],[107,28,101,26],[107,29,101,27,"j"],[107,30,101,28],[107,34,101,32,"j"],[107,35,101,33],[107,36,101,34,"id"],[107,38,101,36],[107,43,101,41,"id"],[107,45,101,43],[107,46,101,44],[108,4,102,2],[108,10,102,8,"saveJobsInternal"],[108,26,102,24],[108,27,102,25,"next"],[108,31,102,29],[108,32,102,30],[109,2,103,0],[111,2,105,0],[112,2,106,0],[113,2,107,7],[113,17,107,22,"getEmployerAuftr√§ge"],[113,36,107,41,"getEmployerAuftr√§ge"],[113,37,107,42,"employerId"],[113,47,107,60],[113,49,107,78],[114,4,108,2,"console"],[114,11,108,9],[114,12,108,10,"warn"],[114,16,108,14],[114,17,108,15],[114,101,108,99],[114,102,108,100],[115,4,109,2],[115,11,109,9],[115,17,109,15,"getEmployerJobs"],[115,32,109,30],[115,33,109,31,"employerId"],[115,43,109,41],[115,44,109,42],[116,2,110,0],[117,2,112,7],[117,17,112,22,"getEmployerAuftraege"],[117,37,112,42,"getEmployerAuftraege"],[117,38,112,43,"employerId"],[117,48,112,61],[117,50,112,79],[118,4,113,2,"console"],[118,11,113,9],[118,12,113,10,"warn"],[118,16,113,14],[118,17,113,15],[118,102,113,100],[118,103,113,101],[119,4,114,2],[119,11,114,9],[119,17,114,15,"getEmployerJobs"],[119,32,114,30],[119,33,114,31,"employerId"],[119,43,114,41],[119,44,114,42],[120,2,115,0],[121,0,115,1]],"functionMap":{"names":["<global>","loadJobs","saveJobsInternal","addJob","getJobs","updateJob","jobs.map$argument_0","clearJobs","getAllJobs","saveJob","all.findIndex$argument_0","getEmployerJobs","all.map$argument_0","fixed.filter$argument_0","getOpenJobs","all.filter$argument_0","getJobById","all.find$argument_0","deleteJob","jobs.filter$argument_0","getEmployerAuftr√§ge","getEmployerAuftraege"],"mappings":"AAA;ACM;CDG;AEG;CFE;OGE;CHG;OIE;CJE;OKE;wBCE,2CD;CLE;OOE;CPE;OQG;CRE;OSE;iCCE,oBD;CTM;OWE;wBCK;GDkB;4BES,gCF;CXI;OcE;oBCE,wBD;CdC;OgBE;kBCE,gBD;ChBC;OkBE;2BCE,gBD;ClBE;OoBI;CpBG;OqBE;CrBG"}},"type":"js/module"}]}