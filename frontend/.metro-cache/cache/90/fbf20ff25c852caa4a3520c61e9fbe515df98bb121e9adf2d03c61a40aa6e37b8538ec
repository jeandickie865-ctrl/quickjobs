{"dependencies":[{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":39,"index":39}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}},{"name":"expo-modules-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":40},"end":{"line":2,"column":77,"index":117}}],"key":"fU8WLIPqoAGygnPbZ/QJiQQfXEY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return getDevicePushTokenAsync;\n    }\n  });\n  var _expoConstants = require(_dependencyMap[0], \"expo-constants\");\n  var Constants = _interopDefault(_expoConstants);\n  var _expoModulesCore = require(_dependencyMap[1], \"expo-modules-core\");\n  async function getDevicePushTokenAsync() {\n    const data = await _subscribeDeviceToPushNotificationsAsync();\n    _expoModulesCore.DeviceEventEmitter.emit('onDevicePushToken', {\n      devicePushToken: data\n    });\n    return {\n      type: _expoModulesCore.Platform.OS,\n      data\n    };\n  }\n  function guardPermission() {\n    if (!('Notification' in window)) {\n      throw new _expoModulesCore.CodedError('ERR_UNAVAILABLE', 'The Web Notifications API is not available on this device.');\n    }\n    if (!navigator.serviceWorker) {\n      throw new _expoModulesCore.CodedError('ERR_UNAVAILABLE', 'Notifications cannot be used because the service worker API is not supported on this device. This might also happen because your web page does not support HTTPS.');\n    }\n    if (Notification.permission !== 'granted') {\n      throw new _expoModulesCore.CodedError('ERR_NOTIFICATIONS_PERMISSION_DENIED', `Cannot use web notifications without permissions granted. Request permissions with \"expo-permissions\".`);\n    }\n  }\n  async function _subscribeDeviceToPushNotificationsAsync() {\n    // @ts-expect-error: TODO: not on the schema\n    const vapidPublicKey = Constants.default.expoConfig?.notification?.vapidPublicKey;\n    if (!vapidPublicKey) {\n      throw new _expoModulesCore.CodedError('ERR_NOTIFICATIONS_PUSH_WEB_MISSING_CONFIG', 'You must provide `notification.vapidPublicKey` in `app.json` to use push notifications on web. Learn more: https://docs.expo.dev/versions/latest/guides/using-vapid/.');\n    }\n    // @ts-expect-error: TODO: not on the schema\n    const serviceWorkerPath = Constants.default.expoConfig?.notification?.serviceWorkerPath;\n    if (!serviceWorkerPath) {\n      throw new _expoModulesCore.CodedError('ERR_NOTIFICATIONS_PUSH_MISSING_CONFIGURATION', 'You must specify `notification.serviceWorkerPath` in `app.json` to use push notifications on the web. Please provide the path to the service worker that will handle notifications.');\n    }\n    guardPermission();\n    let registration = null;\n    try {\n      registration = await navigator.serviceWorker.register(serviceWorkerPath);\n    } catch (error) {\n      throw new _expoModulesCore.CodedError('ERR_NOTIFICATIONS_PUSH_REGISTRATION_FAILED', `Could not register this device for push notifications because the service worker (${serviceWorkerPath}) could not be registered: ${error}`);\n    }\n    await navigator.serviceWorker.ready;\n    if (!registration.active) {\n      throw new _expoModulesCore.CodedError('ERR_NOTIFICATIONS_PUSH_REGISTRATION_FAILED', 'Could not register this device for push notifications because the service worker is not active.');\n    }\n    const subscribeOptions = {\n      userVisibleOnly: true,\n      applicationServerKey: _urlBase64ToUint8Array(vapidPublicKey)\n    };\n    let pushSubscription = null;\n    try {\n      pushSubscription = await registration.pushManager.subscribe(subscribeOptions);\n    } catch (error) {\n      throw new _expoModulesCore.CodedError('ERR_NOTIFICATIONS_PUSH_REGISTRATION_FAILED', 'The device was unable to register for remote notifications with the browser endpoint. (' + error + ')');\n    }\n    const pushSubscriptionJson = pushSubscription.toJSON();\n    const subscriptionObject = {\n      endpoint: pushSubscriptionJson.endpoint,\n      keys: {\n        p256dh: pushSubscriptionJson.keys.p256dh,\n        auth: pushSubscriptionJson.keys.auth\n      }\n    };\n    // Store notification icon string in service worker.\n    // This message is received by `/expo-service-worker.js`.\n    // We wrap it with `fromExpoWebClient` to make sure other message\n    // will not override content such as `notificationIcon`.\n    // https://stackoverflow.com/a/35729334/2603230\n    const notificationIcon = (Constants.default.expoConfig?.notification ?? {}).icon;\n    await registration.active.postMessage(JSON.stringify({\n      fromExpoWebClient: {\n        notificationIcon\n      }\n    }));\n    return subscriptionObject;\n  }\n  // https://github.com/web-push-libs/web-push#using-vapid-key-for-applicationserverkey\n  function _urlBase64ToUint8Array(base64String) {\n    const padding = '='.repeat((4 - base64String.length % 4) % 4);\n    const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');\n    const rawData = window.atob(base64);\n    const outputArray = new Uint8Array(rawData.length);\n    for (let i = 0; i < rawData.length; ++i) {\n      outputArray[i] = rawData.charCodeAt(i);\n    }\n    return outputArray;\n  }\n});","lineCount":106,"map":[[12,2,3,15,"Object"],[12,8,3,15],[12,9,3,15,"defineProperty"],[12,23,3,15],[12,24,3,15,"exports"],[12,31,3,15],[13,4,3,15,"enumerable"],[13,14,3,15],[14,4,3,15,"get"],[14,7,3,15],[14,18,3,15,"get"],[14,19,3,15],[15,6,3,15],[15,13,3,15,"getDevicePushTokenAsync"],[15,36,3,15],[16,4,3,15],[17,2,3,15],[18,2,1,0],[18,6,1,0,"_expoConstants"],[18,20,1,0],[18,23,1,0,"require"],[18,30,1,0],[18,31,1,0,"_dependencyMap"],[18,45,1,0],[19,2,1,0],[19,6,1,0,"Constants"],[19,15,1,0],[19,18,1,0,"_interopDefault"],[19,33,1,0],[19,34,1,0,"_expoConstants"],[19,48,1,0],[20,2,2,0],[20,6,2,0,"_expoModulesCore"],[20,22,2,0],[20,25,2,0,"require"],[20,32,2,0],[20,33,2,0,"_dependencyMap"],[20,47,2,0],[21,2,3,15],[21,17,3,30,"getDevicePushTokenAsync"],[21,40,3,53,"getDevicePushTokenAsync"],[21,41,3,53],[21,43,3,56],[22,4,4,4],[22,10,4,10,"data"],[22,14,4,14],[22,17,4,17],[22,23,4,23,"_subscribeDeviceToPushNotificationsAsync"],[22,63,4,63],[22,64,4,64],[22,65,4,65],[23,4,5,4,"DeviceEventEmitter"],[23,20,5,22],[23,21,5,22,"DeviceEventEmitter"],[23,39,5,22],[23,40,5,23,"emit"],[23,44,5,27],[23,45,5,28],[23,64,5,47],[23,66,5,49],[24,6,5,51,"devicePushToken"],[24,21,5,66],[24,23,5,68,"data"],[25,4,5,73],[25,5,5,74],[25,6,5,75],[26,4,6,4],[26,11,6,11],[27,6,6,13,"type"],[27,10,6,17],[27,12,6,19,"Platform"],[27,28,6,27],[27,29,6,27,"Platform"],[27,37,6,27],[27,38,6,28,"OS"],[27,40,6,30],[28,6,6,32,"data"],[29,4,6,37],[29,5,6,38],[30,2,7,0],[31,2,8,0],[31,11,8,9,"guardPermission"],[31,26,8,24,"guardPermission"],[31,27,8,24],[31,29,8,27],[32,4,9,4],[32,8,9,8],[32,10,9,10],[32,24,9,24],[32,28,9,28,"window"],[32,34,9,34],[32,35,9,35],[32,37,9,37],[33,6,10,8],[33,12,10,14],[33,16,10,18,"CodedError"],[33,32,10,28],[33,33,10,28,"CodedError"],[33,43,10,28],[33,44,10,29],[33,61,10,46],[33,63,10,48],[33,123,10,108],[33,124,10,109],[34,4,11,4],[35,4,12,4],[35,8,12,8],[35,9,12,9,"navigator"],[35,18,12,18],[35,19,12,19,"serviceWorker"],[35,32,12,32],[35,34,12,34],[36,6,13,8],[36,12,13,14],[36,16,13,18,"CodedError"],[36,32,13,28],[36,33,13,28,"CodedError"],[36,43,13,28],[36,44,13,29],[36,61,13,46],[36,63,13,48],[36,226,13,211],[36,227,13,212],[37,4,14,4],[38,4,15,4],[38,8,15,8,"Notification"],[38,20,15,20],[38,21,15,21,"permission"],[38,31,15,31],[38,36,15,36],[38,45,15,45],[38,47,15,47],[39,6,16,8],[39,12,16,14],[39,16,16,18,"CodedError"],[39,32,16,28],[39,33,16,28,"CodedError"],[39,43,16,28],[39,44,16,29],[39,81,16,66],[39,83,16,68],[39,187,16,172],[39,188,16,173],[40,4,17,4],[41,2,18,0],[42,2,19,0],[42,17,19,15,"_subscribeDeviceToPushNotificationsAsync"],[42,57,19,55,"_subscribeDeviceToPushNotificationsAsync"],[42,58,19,55],[42,60,19,58],[43,4,20,4],[44,4,21,4],[44,10,21,10,"vapidPublicKey"],[44,24,21,24],[44,27,21,27,"Constants"],[44,36,21,36],[44,37,21,36,"default"],[44,44,21,36],[44,45,21,37,"expoConfig"],[44,55,21,47],[44,57,21,49,"notification"],[44,69,21,61],[44,71,21,63,"vapidPublicKey"],[44,85,21,77],[45,4,22,4],[45,8,22,8],[45,9,22,9,"vapidPublicKey"],[45,23,22,23],[45,25,22,25],[46,6,23,8],[46,12,23,14],[46,16,23,18,"CodedError"],[46,32,23,28],[46,33,23,28,"CodedError"],[46,43,23,28],[46,44,23,29],[46,87,23,72],[46,89,23,74],[46,256,23,241],[46,257,23,242],[47,4,24,4],[48,4,25,4],[49,4,26,4],[49,10,26,10,"serviceWorkerPath"],[49,27,26,27],[49,30,26,30,"Constants"],[49,39,26,39],[49,40,26,39,"default"],[49,47,26,39],[49,48,26,40,"expoConfig"],[49,58,26,50],[49,60,26,52,"notification"],[49,72,26,64],[49,74,26,66,"serviceWorkerPath"],[49,91,26,83],[50,4,27,4],[50,8,27,8],[50,9,27,9,"serviceWorkerPath"],[50,26,27,26],[50,28,27,28],[51,6,28,8],[51,12,28,14],[51,16,28,18,"CodedError"],[51,32,28,28],[51,33,28,28,"CodedError"],[51,43,28,28],[51,44,28,29],[51,90,28,75],[51,92,28,77],[51,273,28,258],[51,274,28,259],[52,4,29,4],[53,4,30,4,"guardPermission"],[53,19,30,19],[53,20,30,20],[53,21,30,21],[54,4,31,4],[54,8,31,8,"registration"],[54,20,31,20],[54,23,31,23],[54,27,31,27],[55,4,32,4],[55,8,32,8],[56,6,33,8,"registration"],[56,18,33,20],[56,21,33,23],[56,27,33,29,"navigator"],[56,36,33,38],[56,37,33,39,"serviceWorker"],[56,50,33,52],[56,51,33,53,"register"],[56,59,33,61],[56,60,33,62,"serviceWorkerPath"],[56,77,33,79],[56,78,33,80],[57,4,34,4],[57,5,34,5],[57,6,35,4],[57,13,35,11,"error"],[57,18,35,16],[57,20,35,18],[58,6,36,8],[58,12,36,14],[58,16,36,18,"CodedError"],[58,32,36,28],[58,33,36,28,"CodedError"],[58,43,36,28],[58,44,36,29],[58,88,36,73],[58,90,36,75],[58,175,36,160,"serviceWorkerPath"],[58,192,36,177],[58,222,36,207,"error"],[58,227,36,212],[58,229,36,214],[58,230,36,215],[59,4,37,4],[60,4,38,4],[60,10,38,10,"navigator"],[60,19,38,19],[60,20,38,20,"serviceWorker"],[60,33,38,33],[60,34,38,34,"ready"],[60,39,38,39],[61,4,39,4],[61,8,39,8],[61,9,39,9,"registration"],[61,21,39,21],[61,22,39,22,"active"],[61,28,39,28],[61,30,39,30],[62,6,40,8],[62,12,40,14],[62,16,40,18,"CodedError"],[62,32,40,28],[62,33,40,28,"CodedError"],[62,43,40,28],[62,44,40,29],[62,88,40,73],[62,90,40,75],[62,187,40,172],[62,188,40,173],[63,4,41,4],[64,4,42,4],[64,10,42,10,"subscribeOptions"],[64,26,42,26],[64,29,42,29],[65,6,43,8,"userVisibleOnly"],[65,21,43,23],[65,23,43,25],[65,27,43,29],[66,6,44,8,"applicationServerKey"],[66,26,44,28],[66,28,44,30,"_urlBase64ToUint8Array"],[66,50,44,52],[66,51,44,53,"vapidPublicKey"],[66,65,44,67],[67,4,45,4],[67,5,45,5],[68,4,46,4],[68,8,46,8,"pushSubscription"],[68,24,46,24],[68,27,46,27],[68,31,46,31],[69,4,47,4],[69,8,47,8],[70,6,48,8,"pushSubscription"],[70,22,48,24],[70,25,48,27],[70,31,48,33,"registration"],[70,43,48,45],[70,44,48,46,"pushManager"],[70,55,48,57],[70,56,48,58,"subscribe"],[70,65,48,67],[70,66,48,68,"subscribeOptions"],[70,82,48,84],[70,83,48,85],[71,4,49,4],[71,5,49,5],[71,6,50,4],[71,13,50,11,"error"],[71,18,50,16],[71,20,50,18],[72,6,51,8],[72,12,51,14],[72,16,51,18,"CodedError"],[72,32,51,28],[72,33,51,28,"CodedError"],[72,43,51,28],[72,44,51,29],[72,88,51,73],[72,90,51,75],[72,179,51,164],[72,182,52,12,"error"],[72,187,52,17],[72,190,53,12],[72,193,53,15],[72,194,53,16],[73,4,54,4],[74,4,55,4],[74,10,55,10,"pushSubscriptionJson"],[74,30,55,30],[74,33,55,33,"pushSubscription"],[74,49,55,49],[74,50,55,50,"toJSON"],[74,56,55,56],[74,57,55,57],[74,58,55,58],[75,4,56,4],[75,10,56,10,"subscriptionObject"],[75,28,56,28],[75,31,56,31],[76,6,57,8,"endpoint"],[76,14,57,16],[76,16,57,18,"pushSubscriptionJson"],[76,36,57,38],[76,37,57,39,"endpoint"],[76,45,57,47],[77,6,58,8,"keys"],[77,10,58,12],[77,12,58,14],[78,8,59,12,"p256dh"],[78,14,59,18],[78,16,59,20,"pushSubscriptionJson"],[78,36,59,40],[78,37,59,41,"keys"],[78,41,59,45],[78,42,59,46,"p256dh"],[78,48,59,52],[79,8,60,12,"auth"],[79,12,60,16],[79,14,60,18,"pushSubscriptionJson"],[79,34,60,38],[79,35,60,39,"keys"],[79,39,60,43],[79,40,60,44,"auth"],[80,6,61,8],[81,4,62,4],[81,5,62,5],[82,4,63,4],[83,4,64,4],[84,4,65,4],[85,4,66,4],[86,4,67,4],[87,4,68,4],[87,10,68,10,"notificationIcon"],[87,26,68,26],[87,29,68,29],[87,30,68,30,"Constants"],[87,39,68,39],[87,40,68,39,"default"],[87,47,68,39],[87,48,68,40,"expoConfig"],[87,58,68,50],[87,60,68,52,"notification"],[87,72,68,64],[87,76,68,68],[87,77,68,69],[87,78,68,70],[87,80,68,72,"icon"],[87,84,68,76],[88,4,69,4],[88,10,69,10,"registration"],[88,22,69,22],[88,23,69,23,"active"],[88,29,69,29],[88,30,69,30,"postMessage"],[88,41,69,41],[88,42,69,42,"JSON"],[88,46,69,46],[88,47,69,47,"stringify"],[88,56,69,56],[88,57,69,57],[89,6,69,59,"fromExpoWebClient"],[89,23,69,76],[89,25,69,78],[90,8,69,80,"notificationIcon"],[91,6,69,97],[92,4,69,99],[92,5,69,100],[92,6,69,101],[92,7,69,102],[93,4,70,4],[93,11,70,11,"subscriptionObject"],[93,29,70,29],[94,2,71,0],[95,2,72,0],[96,2,73,0],[96,11,73,9,"_urlBase64ToUint8Array"],[96,33,73,31,"_urlBase64ToUint8Array"],[96,34,73,32,"base64String"],[96,46,73,44],[96,48,73,46],[97,4,74,4],[97,10,74,10,"padding"],[97,17,74,17],[97,20,74,20],[97,23,74,23],[97,24,74,24,"repeat"],[97,30,74,30],[97,31,74,31],[97,32,74,32],[97,33,74,33],[97,36,74,37,"base64String"],[97,48,74,49],[97,49,74,50,"length"],[97,55,74,56],[97,58,74,59],[97,59,74,61],[97,63,74,65],[97,64,74,66],[97,65,74,67],[98,4,75,4],[98,10,75,10,"base64"],[98,16,75,16],[98,19,75,19],[98,20,75,20,"base64String"],[98,32,75,32],[98,35,75,35,"padding"],[98,42,75,42],[98,44,75,44,"replace"],[98,51,75,51],[98,52,75,52],[98,56,75,56],[98,58,75,58],[98,61,75,61],[98,62,75,62],[98,63,75,63,"replace"],[98,70,75,70],[98,71,75,71],[98,75,75,75],[98,77,75,77],[98,80,75,80],[98,81,75,81],[99,4,76,4],[99,10,76,10,"rawData"],[99,17,76,17],[99,20,76,20,"window"],[99,26,76,26],[99,27,76,27,"atob"],[99,31,76,31],[99,32,76,32,"base64"],[99,38,76,38],[99,39,76,39],[100,4,77,4],[100,10,77,10,"outputArray"],[100,21,77,21],[100,24,77,24],[100,28,77,28,"Uint8Array"],[100,38,77,38],[100,39,77,39,"rawData"],[100,46,77,46],[100,47,77,47,"length"],[100,53,77,53],[100,54,77,54],[101,4,78,4],[101,9,78,9],[101,13,78,13,"i"],[101,14,78,14],[101,17,78,17],[101,18,78,18],[101,20,78,20,"i"],[101,21,78,21],[101,24,78,24,"rawData"],[101,31,78,31],[101,32,78,32,"length"],[101,38,78,38],[101,40,78,40],[101,42,78,42,"i"],[101,43,78,43],[101,45,78,45],[102,6,79,8,"outputArray"],[102,17,79,19],[102,18,79,20,"i"],[102,19,79,21],[102,20,79,22],[102,23,79,25,"rawData"],[102,30,79,32],[102,31,79,33,"charCodeAt"],[102,41,79,43],[102,42,79,44,"i"],[102,43,79,45],[102,44,79,46],[103,4,80,4],[104,4,81,4],[104,11,81,11,"outputArray"],[104,22,81,22],[105,2,82,0],[106,0,82,1],[106,3]],"functionMap":{"names":["<global>","getDevicePushTokenAsync","guardPermission","_subscribeDeviceToPushNotificationsAsync","_urlBase64ToUint8Array"],"mappings":"AAA;eCE;CDI;AEC;CFU;AGC;CHoD;AIE;CJS"},"hasCjsExports":false},"type":"js/module"}]}