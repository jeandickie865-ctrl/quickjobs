{"dependencies":[{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":57,"index":57}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.addJob = addJob;\n  exports.getJobs = getJobs;\n  exports.updateJob = updateJob;\n  exports.clearJobs = clearJobs;\n  exports.getAllJobs = getAllJobs;\n  exports.saveJob = saveJob;\n  exports.getEmployerJobs = getEmployerJobs;\n  exports.getOpenJobs = getOpenJobs;\n  exports.getJobById = getJobById;\n  exports.deleteJob = deleteJob;\n  exports.getEmployerAuftr√§ge = getEmployerAuftr√§ge;\n  exports.getEmployerAuftraege = getEmployerAuftraege;\n  var _storage = require(_dependencyMap[0], \"./storage\");\n  const JOBS_KEY = '@shiftmatch:jobs';\n\n  // Internal helper: Load all jobs from storage\n  async function loadJobs() {\n    const stored = await (0, _storage.getItem)(JOBS_KEY);\n    return stored ?? [];\n  }\n\n  // Internal helper: Save all jobs to storage\n  async function saveJobsInternal(jobs) {\n    await (0, _storage.setItem)(JOBS_KEY, jobs);\n  }\n  async function addJob(job) {\n    const jobs = await loadJobs();\n    await saveJobsInternal([...jobs, job]);\n  }\n  async function getJobs() {\n    return await loadJobs();\n  }\n  async function updateJob(id, patch) {\n    const jobs = await loadJobs();\n    const next = jobs.map(j => j.id === id ? Object.assign({}, j, patch) : j);\n    await saveJobsInternal(next);\n  }\n  async function clearJobs() {\n    await (0, _storage.removeItem)(JOBS_KEY);\n  }\n\n  // Legacy/convenience functions\n  async function getAllJobs() {\n    return await getJobs();\n  }\n  async function saveJob(job) {\n    const all = await loadJobs();\n    const existing = all.findIndex(j => j.id === job.id);\n    if (existing >= 0) {\n      await updateJob(job.id, job);\n    } else {\n      await addJob(job);\n    }\n  }\n  async function getEmployerJobs(employerId) {\n    const all = await loadJobs();\n    let needsSave = false;\n\n    // Migration: Fix jobs without employerId\n    const fixed = all.map(job => {\n      // Check if job has no employerId or employerId is undefined\n      if (!job.employerId || job.employerId === 'undefined') {\n        // Check if there's an old ownerId field\n        const legacyOwnerId = job.ownerId;\n        if (legacyOwnerId) {\n          console.log(`üîß Migrating job ${job.id}: ownerId ‚Üí employerId`);\n          job.employerId = legacyOwnerId;\n          needsSave = true;\n        } else if (job.status === 'open' || job.status === 'draft') {\n          // For open/draft jobs without any owner info, assign to current employer\n          console.log(`üîß Assigning job ${job.id} to employer ${employerId}`);\n          job.employerId = employerId;\n          needsSave = true;\n        }\n      }\n      return job;\n    });\n\n    // Save back if we made changes\n    if (needsSave) {\n      console.log('üíæ Saving migrated jobs to storage');\n      await saveJobsInternal(fixed);\n    }\n\n    // Filter jobs for this employer\n    const mine = fixed.filter(j => j.employerId === employerId);\n    console.log(`üìã getEmployerJobs: Found ${mine.length} jobs for employer ${employerId}`);\n    return mine;\n  }\n  async function getOpenJobs() {\n    const all = await loadJobs();\n    return all.filter(j => j.status === 'open');\n  }\n  async function getJobById(id) {\n    const all = await loadJobs();\n    return all.find(j => j.id === id) || null;\n  }\n  async function deleteJob(id) {\n    const jobs = await loadJobs();\n    const next = jobs.filter(j => j.id !== id);\n    await saveJobsInternal(next);\n  }\n\n  // COMPATIBILITY ALIASES - For backwards compatibility\n  // (in case old code or sed replacements created these function calls)\n  async function getEmployerAuftr√§ge(employerId) {\n    console.warn('‚ö†Ô∏è Deprecated: getEmployerAuftr√§ge() is deprecated. Use getEmployerJobs() instead.');\n    return await getEmployerJobs(employerId);\n  }\n  async function getEmployerAuftraege(employerId) {\n    console.warn('‚ö†Ô∏è Deprecated: getEmployerAuftraege() is deprecated. Use getEmployerJobs() instead.');\n    return await getEmployerJobs(employerId);\n  }\n});","lineCount":120,"map":[[7,2,17,0,"exports"],[7,9,17,0],[7,10,17,0,"addJob"],[7,16,17,0],[7,19,17,0,"addJob"],[7,25,17,0],[8,2,22,0,"exports"],[8,9,22,0],[8,10,22,0,"getJobs"],[8,17,22,0],[8,20,22,0,"getJobs"],[8,27,22,0],[9,2,26,0,"exports"],[9,9,26,0],[9,10,26,0,"updateJob"],[9,19,26,0],[9,22,26,0,"updateJob"],[9,31,26,0],[10,2,32,0,"exports"],[10,9,32,0],[10,10,32,0,"clearJobs"],[10,19,32,0],[10,22,32,0,"clearJobs"],[10,31,32,0],[11,2,37,0,"exports"],[11,9,37,0],[11,10,37,0,"getAllJobs"],[11,20,37,0],[11,23,37,0,"getAllJobs"],[11,33,37,0],[12,2,41,0,"exports"],[12,9,41,0],[12,10,41,0,"saveJob"],[12,17,41,0],[12,20,41,0,"saveJob"],[12,27,41,0],[13,2,51,0,"exports"],[13,9,51,0],[13,10,51,0,"getEmployerJobs"],[13,25,51,0],[13,28,51,0,"getEmployerJobs"],[13,43,51,0],[14,2,89,0,"exports"],[14,9,89,0],[14,10,89,0,"getOpenJobs"],[14,21,89,0],[14,24,89,0,"getOpenJobs"],[14,35,89,0],[15,2,94,0,"exports"],[15,9,94,0],[15,10,94,0,"getJobById"],[15,20,94,0],[15,23,94,0,"getJobById"],[15,33,94,0],[16,2,99,0,"exports"],[16,9,99,0],[16,10,99,0,"deleteJob"],[16,19,99,0],[16,22,99,0,"deleteJob"],[16,31,99,0],[17,2,107,0,"exports"],[17,9,107,0],[17,10,107,0,"getEmployerAuftr√§ge"],[17,29,107,0],[17,32,107,0,"getEmployerAuftr√§ge"],[17,51,107,0],[18,2,112,0,"exports"],[18,9,112,0],[18,10,112,0,"getEmployerAuftraege"],[18,30,112,0],[18,33,112,0,"getEmployerAuftraege"],[18,53,112,0],[19,2,1,0],[19,6,1,0,"_storage"],[19,14,1,0],[19,17,1,0,"require"],[19,24,1,0],[19,25,1,0,"_dependencyMap"],[19,39,1,0],[20,2,4,0],[20,8,4,6,"JOBS_KEY"],[20,16,4,14],[20,19,4,17],[20,37,4,35],[22,2,6,0],[23,2,7,0],[23,17,7,15,"loadJobs"],[23,25,7,23,"loadJobs"],[23,26,7,23],[23,28,7,42],[24,4,8,2],[24,10,8,8,"stored"],[24,16,8,14],[24,19,8,17],[24,25,8,23],[24,29,8,23,"getItem"],[24,37,8,30],[24,38,8,30,"getItem"],[24,45,8,30],[24,47,8,38,"JOBS_KEY"],[24,55,8,46],[24,56,8,47],[25,4,9,2],[25,11,9,9,"stored"],[25,17,9,15],[25,21,9,19],[25,23,9,21],[26,2,10,0],[28,2,12,0],[29,2,13,0],[29,17,13,15,"saveJobsInternal"],[29,33,13,31,"saveJobsInternal"],[29,34,13,32,"jobs"],[29,38,13,43],[29,40,13,60],[30,4,14,2],[30,10,14,8],[30,14,14,8,"setItem"],[30,22,14,15],[30,23,14,15,"setItem"],[30,30,14,15],[30,32,14,23,"JOBS_KEY"],[30,40,14,31],[30,42,14,33,"jobs"],[30,46,14,37],[30,47,14,38],[31,2,15,0],[32,2,17,7],[32,17,17,22,"addJob"],[32,23,17,28,"addJob"],[32,24,17,29,"job"],[32,27,17,37],[32,29,17,54],[33,4,18,2],[33,10,18,8,"jobs"],[33,14,18,12],[33,17,18,15],[33,23,18,21,"loadJobs"],[33,31,18,29],[33,32,18,30],[33,33,18,31],[34,4,19,2],[34,10,19,8,"saveJobsInternal"],[34,26,19,24],[34,27,19,25],[34,28,19,26],[34,31,19,29,"jobs"],[34,35,19,33],[34,37,19,35,"job"],[34,40,19,38],[34,41,19,39],[34,42,19,40],[35,2,20,0],[36,2,22,7],[36,17,22,22,"getJobs"],[36,24,22,29,"getJobs"],[36,25,22,29],[36,27,22,48],[37,4,23,2],[37,11,23,9],[37,17,23,15,"loadJobs"],[37,25,23,23],[37,26,23,24],[37,27,23,25],[38,2,24,0],[39,2,26,7],[39,17,26,22,"updateJob"],[39,26,26,31,"updateJob"],[39,27,26,32,"id"],[39,29,26,42],[39,31,26,44,"patch"],[39,36,26,63],[39,38,26,80],[40,4,27,2],[40,10,27,8,"jobs"],[40,14,27,12],[40,17,27,15],[40,23,27,21,"loadJobs"],[40,31,27,29],[40,32,27,30],[40,33,27,31],[41,4,28,2],[41,10,28,8,"next"],[41,14,28,12],[41,17,28,15,"jobs"],[41,21,28,19],[41,22,28,20,"map"],[41,25,28,23],[41,26,28,24,"j"],[41,27,28,25],[41,31,28,30,"j"],[41,32,28,31],[41,33,28,32,"id"],[41,35,28,34],[41,40,28,39,"id"],[41,42,28,41],[41,45,28,41,"Object"],[41,51,28,41],[41,52,28,41,"assign"],[41,58,28,41],[41,63,28,49,"j"],[41,64,28,50],[41,66,28,55,"patch"],[41,71,28,60],[41,75,28,65,"j"],[41,76,28,67],[41,77,28,68],[42,4,29,2],[42,10,29,8,"saveJobsInternal"],[42,26,29,24],[42,27,29,25,"next"],[42,31,29,29],[42,32,29,30],[43,2,30,0],[44,2,32,7],[44,17,32,22,"clearJobs"],[44,26,32,31,"clearJobs"],[44,27,32,31],[44,29,32,49],[45,4,33,2],[45,10,33,8],[45,14,33,8,"removeItem"],[45,22,33,18],[45,23,33,18,"removeItem"],[45,33,33,18],[45,35,33,19,"JOBS_KEY"],[45,43,33,27],[45,44,33,28],[46,2,34,0],[48,2,36,0],[49,2,37,7],[49,17,37,22,"getAllJobs"],[49,27,37,32,"getAllJobs"],[49,28,37,32],[49,30,37,51],[50,4,38,2],[50,11,38,9],[50,17,38,15,"getJobs"],[50,24,38,22],[50,25,38,23],[50,26,38,24],[51,2,39,0],[52,2,41,7],[52,17,41,22,"saveJob"],[52,24,41,29,"saveJob"],[52,25,41,30,"job"],[52,28,41,38],[52,30,41,55],[53,4,42,2],[53,10,42,8,"all"],[53,13,42,11],[53,16,42,14],[53,22,42,20,"loadJobs"],[53,30,42,28],[53,31,42,29],[53,32,42,30],[54,4,43,2],[54,10,43,8,"existing"],[54,18,43,16],[54,21,43,19,"all"],[54,24,43,22],[54,25,43,23,"findIndex"],[54,34,43,32],[54,35,43,33,"j"],[54,36,43,34],[54,40,43,38,"j"],[54,41,43,39],[54,42,43,40,"id"],[54,44,43,42],[54,49,43,47,"job"],[54,52,43,50],[54,53,43,51,"id"],[54,55,43,53],[54,56,43,54],[55,4,44,2],[55,8,44,6,"existing"],[55,16,44,14],[55,20,44,18],[55,21,44,19],[55,23,44,21],[56,6,45,4],[56,12,45,10,"updateJob"],[56,21,45,19],[56,22,45,20,"job"],[56,25,45,23],[56,26,45,24,"id"],[56,28,45,26],[56,30,45,28,"job"],[56,33,45,31],[56,34,45,32],[57,4,46,2],[57,5,46,3],[57,11,46,9],[58,6,47,4],[58,12,47,10,"addJob"],[58,18,47,16],[58,19,47,17,"job"],[58,22,47,20],[58,23,47,21],[59,4,48,2],[60,2,49,0],[61,2,51,7],[61,17,51,22,"getEmployerJobs"],[61,32,51,37,"getEmployerJobs"],[61,33,51,38,"employerId"],[61,43,51,56],[61,45,51,74],[62,4,52,2],[62,10,52,8,"all"],[62,13,52,11],[62,16,52,14],[62,22,52,20,"loadJobs"],[62,30,52,28],[62,31,52,29],[62,32,52,30],[63,4,53,2],[63,8,53,6,"needsSave"],[63,17,53,15],[63,20,53,18],[63,25,53,23],[65,4,55,2],[66,4,56,2],[66,10,56,8,"fixed"],[66,15,56,13],[66,18,56,16,"all"],[66,21,56,19],[66,22,56,20,"map"],[66,25,56,23],[66,26,56,24,"job"],[66,29,56,27],[66,33,56,31],[67,6,57,4],[68,6,58,4],[68,10,58,8],[68,11,58,9,"job"],[68,14,58,12],[68,15,58,13,"employerId"],[68,25,58,23],[68,29,58,27,"job"],[68,32,58,30],[68,33,58,31,"employerId"],[68,43,58,41],[68,48,58,46],[68,59,58,57],[68,61,58,59],[69,8,59,6],[70,8,60,6],[70,14,60,12,"legacyOwnerId"],[70,27,60,25],[70,30,60,29,"job"],[70,33,60,32],[70,34,60,41,"ownerId"],[70,41,60,48],[71,8,62,6],[71,12,62,10,"legacyOwnerId"],[71,25,62,23],[71,27,62,25],[72,10,63,8,"console"],[72,17,63,15],[72,18,63,16,"log"],[72,21,63,19],[72,22,63,20],[72,42,63,40,"job"],[72,45,63,43],[72,46,63,44,"id"],[72,48,63,46],[72,72,63,70],[72,73,63,71],[73,10,64,8,"job"],[73,13,64,11],[73,14,64,12,"employerId"],[73,24,64,22],[73,27,64,25,"legacyOwnerId"],[73,40,64,38],[74,10,65,8,"needsSave"],[74,19,65,17],[74,22,65,20],[74,26,65,24],[75,8,66,6],[75,9,66,7],[75,15,66,13],[75,19,66,17,"job"],[75,22,66,20],[75,23,66,21,"status"],[75,29,66,27],[75,34,66,32],[75,40,66,38],[75,44,66,42,"job"],[75,47,66,45],[75,48,66,46,"status"],[75,54,66,52],[75,59,66,57],[75,66,66,64],[75,68,66,66],[76,10,67,8],[77,10,68,8,"console"],[77,17,68,15],[77,18,68,16,"log"],[77,21,68,19],[77,22,68,20],[77,42,68,40,"job"],[77,45,68,43],[77,46,68,44,"id"],[77,48,68,46],[77,64,68,62,"employerId"],[77,74,68,72],[77,76,68,74],[77,77,68,75],[78,10,69,8,"job"],[78,13,69,11],[78,14,69,12,"employerId"],[78,24,69,22],[78,27,69,25,"employerId"],[78,37,69,35],[79,10,70,8,"needsSave"],[79,19,70,17],[79,22,70,20],[79,26,70,24],[80,8,71,6],[81,6,72,4],[82,6,73,4],[82,13,73,11,"job"],[82,16,73,14],[83,4,74,2],[83,5,74,3],[83,6,74,4],[85,4,76,2],[86,4,77,2],[86,8,77,6,"needsSave"],[86,17,77,15],[86,19,77,17],[87,6,78,4,"console"],[87,13,78,11],[87,14,78,12,"log"],[87,17,78,15],[87,18,78,16],[87,54,78,52],[87,55,78,53],[88,6,79,4],[88,12,79,10,"saveJobsInternal"],[88,28,79,26],[88,29,79,27,"fixed"],[88,34,79,32],[88,35,79,33],[89,4,80,2],[91,4,82,2],[92,4,83,2],[92,10,83,8,"mine"],[92,14,83,12],[92,17,83,15,"fixed"],[92,22,83,20],[92,23,83,21,"filter"],[92,29,83,27],[92,30,83,28,"j"],[92,31,83,29],[92,35,83,33,"j"],[92,36,83,34],[92,37,83,35,"employerId"],[92,47,83,45],[92,52,83,50,"employerId"],[92,62,83,60],[92,63,83,61],[93,4,84,2,"console"],[93,11,84,9],[93,12,84,10,"log"],[93,15,84,13],[93,16,84,14],[93,45,84,43,"mine"],[93,49,84,47],[93,50,84,48,"length"],[93,56,84,54],[93,78,84,76,"employerId"],[93,88,84,86],[93,90,84,88],[93,91,84,89],[94,4,86,2],[94,11,86,9,"mine"],[94,15,86,13],[95,2,87,0],[96,2,89,7],[96,17,89,22,"getOpenJobs"],[96,28,89,33,"getOpenJobs"],[96,29,89,33],[96,31,89,52],[97,4,90,2],[97,10,90,8,"all"],[97,13,90,11],[97,16,90,14],[97,22,90,20,"loadJobs"],[97,30,90,28],[97,31,90,29],[97,32,90,30],[98,4,91,2],[98,11,91,9,"all"],[98,14,91,12],[98,15,91,13,"filter"],[98,21,91,19],[98,22,91,20,"j"],[98,23,91,21],[98,27,91,25,"j"],[98,28,91,26],[98,29,91,27,"status"],[98,35,91,33],[98,40,91,38],[98,46,91,44],[98,47,91,45],[99,2,92,0],[100,2,94,7],[100,17,94,22,"getJobById"],[100,27,94,32,"getJobById"],[100,28,94,33,"id"],[100,30,94,43],[100,32,94,66],[101,4,95,2],[101,10,95,8,"all"],[101,13,95,11],[101,16,95,14],[101,22,95,20,"loadJobs"],[101,30,95,28],[101,31,95,29],[101,32,95,30],[102,4,96,2],[102,11,96,9,"all"],[102,14,96,12],[102,15,96,13,"find"],[102,19,96,17],[102,20,96,18,"j"],[102,21,96,19],[102,25,96,23,"j"],[102,26,96,24],[102,27,96,25,"id"],[102,29,96,27],[102,34,96,32,"id"],[102,36,96,34],[102,37,96,35],[102,41,96,39],[102,45,96,43],[103,2,97,0],[104,2,99,7],[104,17,99,22,"deleteJob"],[104,26,99,31,"deleteJob"],[104,27,99,32,"id"],[104,29,99,42],[104,31,99,59],[105,4,100,2],[105,10,100,8,"jobs"],[105,14,100,12],[105,17,100,15],[105,23,100,21,"loadJobs"],[105,31,100,29],[105,32,100,30],[105,33,100,31],[106,4,101,2],[106,10,101,8,"next"],[106,14,101,12],[106,17,101,15,"jobs"],[106,21,101,19],[106,22,101,20,"filter"],[106,28,101,26],[106,29,101,27,"j"],[106,30,101,28],[106,34,101,32,"j"],[106,35,101,33],[106,36,101,34,"id"],[106,38,101,36],[106,43,101,41,"id"],[106,45,101,43],[106,46,101,44],[107,4,102,2],[107,10,102,8,"saveJobsInternal"],[107,26,102,24],[107,27,102,25,"next"],[107,31,102,29],[107,32,102,30],[108,2,103,0],[110,2,105,0],[111,2,106,0],[112,2,107,7],[112,17,107,22,"getEmployerAuftr√§ge"],[112,36,107,41,"getEmployerAuftr√§ge"],[112,37,107,42,"employerId"],[112,47,107,60],[112,49,107,78],[113,4,108,2,"console"],[113,11,108,9],[113,12,108,10,"warn"],[113,16,108,14],[113,17,108,15],[113,101,108,99],[113,102,108,100],[114,4,109,2],[114,11,109,9],[114,17,109,15,"getEmployerJobs"],[114,32,109,30],[114,33,109,31,"employerId"],[114,43,109,41],[114,44,109,42],[115,2,110,0],[116,2,112,7],[116,17,112,22,"getEmployerAuftraege"],[116,37,112,42,"getEmployerAuftraege"],[116,38,112,43,"employerId"],[116,48,112,61],[116,50,112,79],[117,4,113,2,"console"],[117,11,113,9],[117,12,113,10,"warn"],[117,16,113,14],[117,17,113,15],[117,102,113,100],[117,103,113,101],[118,4,114,2],[118,11,114,9],[118,17,114,15,"getEmployerJobs"],[118,32,114,30],[118,33,114,31,"employerId"],[118,43,114,41],[118,44,114,42],[119,2,115,0],[120,0,115,1],[120,3]],"functionMap":{"names":["<global>","loadJobs","saveJobsInternal","addJob","getJobs","updateJob","jobs.map$argument_0","clearJobs","getAllJobs","saveJob","all.findIndex$argument_0","getEmployerJobs","all.map$argument_0","fixed.filter$argument_0","getOpenJobs","all.filter$argument_0","getJobById","all.find$argument_0","deleteJob","jobs.filter$argument_0","getEmployerAuftr√§ge","getEmployerAuftraege"],"mappings":"AAA;ACM;CDG;AEG;CFE;OGE;CHG;OIE;CJE;OKE;wBCE,2CD;CLE;OOE;CPE;OQG;CRE;OSE;iCCE,oBD;CTM;OWE;wBCK;GDkB;4BES,gCF;CXI;OcE;oBCE,wBD;CdC;OgBE;kBCE,gBD;ChBC;OkBE;2BCE,gBD;ClBE;OoBI;CpBG;OqBE;CrBG"},"hasCjsExports":false},"type":"js/module"}]}