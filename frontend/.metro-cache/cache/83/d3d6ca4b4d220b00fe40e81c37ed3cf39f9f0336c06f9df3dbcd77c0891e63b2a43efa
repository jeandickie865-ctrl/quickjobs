{"dependencies":[{"name":"./storage","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":75},"end":{"line":3,"column":36,"index":111}}],"key":"dkq9sfvDyrGcbIAsF1EmLCvdhOw="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getWorkerProfile = getWorkerProfile;\n  exports.saveWorkerProfile = saveWorkerProfile;\n  var _storage = require(_dependencyMap[0], \"./storage\");\n  // utils/profileStore.ts\n\n  const PROFILE_KEY = '@shiftmatch:worker_profile';\n  async function getWorkerProfile(userId) {\n    console.log('üîç getWorkerProfile: Loading profile for user', userId);\n    const stored = await _storage.storage.getItem(PROFILE_KEY);\n    if (!stored) {\n      console.log('‚ö†Ô∏è getWorkerProfile: No profile found');\n      return null;\n    }\n    if (stored.userId !== userId) {\n      console.log('‚ö†Ô∏è getWorkerProfile: Profile userId mismatch', {\n        stored: stored.userId,\n        requested: userId\n      });\n      return null;\n    }\n\n    // MIGRATION: Altes Format ‚Üí Neues Format\n    let profile;\n\n    // Check if old format (has street, postalCode, city fields directly)\n    if ('street' in stored || 'postalCode' in stored || 'city' in stored) {\n      console.log('üîÑ Migrating old profile format to new format');\n      profile = {\n        userId: stored.userId,\n        categories: stored.categories ?? [],\n        selectedTags: stored.selectedTags ?? [],\n        radiusKm: stored.radiusKm ?? 15,\n        homeAddress: {\n          street: stored.street || '',\n          postalCode: stored.postalCode || '',\n          city: stored.city || '',\n          country: 'DE'\n        },\n        homeLat: stored.homeLat ?? stored.lat ?? null,\n        homeLon: stored.homeLon ?? stored.lon ?? null,\n        firstName: stored.name || stored.firstName,\n        profilePhotoUri: stored.photoUrl || stored.profilePhotoUri,\n        pushToken: stored.pushToken\n      };\n\n      // Save migrated version\n      await _storage.storage.setItem(PROFILE_KEY, profile);\n      console.log('‚úÖ Profile migrated and saved');\n    } else {\n      // Already new format\n      profile = Object.assign({}, stored, {\n        categories: stored.categories ?? [],\n        selectedTags: stored.selectedTags ?? [],\n        homeLat: stored.homeLat ?? null,\n        homeLon: stored.homeLon ?? null\n      });\n    }\n    console.log('‚úÖ getWorkerProfile: Profile loaded', {\n      userId: profile.userId,\n      categories: profile.categories.length,\n      tags: profile.selectedTags.length\n    });\n    return profile;\n  }\n  async function saveWorkerProfile(profile) {\n    console.log('üíæ saveWorkerProfile: Saving profile for user', profile.userId);\n    console.log('üíæ saveWorkerProfile: Categories:', profile.categories);\n    console.log('üíæ saveWorkerProfile: SelectedTags:', profile.selectedTags);\n\n    // Normalize profile to ensure arrays are never undefined\n    const normalized = Object.assign({}, profile, {\n      categories: profile.categories ?? [],\n      selectedTags: profile.selectedTags ?? []\n    });\n    console.log('üíæ saveWorkerProfile: Normalized tags:', normalized.selectedTags);\n    await _storage.storage.setItem(PROFILE_KEY, normalized);\n    console.log('‚úÖ saveWorkerProfile: Profile saved successfully', {\n      userId: normalized.userId,\n      categories: normalized.categories.length,\n      tags: normalized.selectedTags.length,\n      pushToken: normalized.pushToken ? '‚úì' : '‚úó'\n    });\n  }\n});","lineCount":88,"map":[[7,2,3,0],[7,6,3,0,"_storage"],[7,14,3,0],[7,17,3,0,"require"],[7,24,3,0],[7,25,3,0,"_dependencyMap"],[7,39,3,0],[8,2,1,0],[10,2,5,0],[10,8,5,6,"PROFILE_KEY"],[10,19,5,17],[10,22,5,20],[10,50,5,48],[11,2,7,7],[11,17,7,22,"getWorkerProfile"],[11,33,7,38,"getWorkerProfile"],[11,34,7,39,"userId"],[11,40,7,53],[11,42,7,86],[12,4,8,2,"console"],[12,11,8,9],[12,12,8,10,"log"],[12,15,8,13],[12,16,8,14],[12,63,8,61],[12,65,8,63,"userId"],[12,71,8,69],[12,72,8,70],[13,4,9,2],[13,10,9,8,"stored"],[13,16,9,14],[13,19,9,17],[13,25,9,23,"storage"],[13,41,9,30],[13,42,9,31,"getItem"],[13,49,9,38],[13,50,9,44,"PROFILE_KEY"],[13,61,9,55],[13,62,9,56],[14,4,11,2],[14,8,11,6],[14,9,11,7,"stored"],[14,15,11,13],[14,17,11,15],[15,6,12,4,"console"],[15,13,12,11],[15,14,12,12,"log"],[15,17,12,15],[15,18,12,16],[15,57,12,55],[15,58,12,56],[16,6,13,4],[16,13,13,11],[16,17,13,15],[17,4,14,2],[18,4,16,2],[18,8,16,6,"stored"],[18,14,16,12],[18,15,16,13,"userId"],[18,21,16,19],[18,26,16,24,"userId"],[18,32,16,30],[18,34,16,32],[19,6,17,4,"console"],[19,13,17,11],[19,14,17,12,"log"],[19,17,17,15],[19,18,17,16],[19,64,17,62],[19,66,17,64],[20,8,17,66,"stored"],[20,14,17,72],[20,16,17,74,"stored"],[20,22,17,80],[20,23,17,81,"userId"],[20,29,17,87],[21,8,17,89,"requested"],[21,17,17,98],[21,19,17,100,"userId"],[22,6,17,107],[22,7,17,108],[22,8,17,109],[23,6,18,4],[23,13,18,11],[23,17,18,15],[24,4,19,2],[26,4,21,2],[27,4,22,2],[27,8,22,6,"profile"],[27,15,22,28],[29,4,24,2],[30,4,25,2],[30,8,25,6],[30,16,25,14],[30,20,25,18,"stored"],[30,26,25,24],[30,30,25,28],[30,42,25,40],[30,46,25,44,"stored"],[30,52,25,50],[30,56,25,54],[30,62,25,60],[30,66,25,64,"stored"],[30,72,25,70],[30,74,25,72],[31,6,26,4,"console"],[31,13,26,11],[31,14,26,12,"log"],[31,17,26,15],[31,18,26,16],[31,65,26,63],[31,66,26,64],[32,6,27,4,"profile"],[32,13,27,11],[32,16,27,14],[33,8,28,6,"userId"],[33,14,28,12],[33,16,28,14,"stored"],[33,22,28,20],[33,23,28,21,"userId"],[33,29,28,27],[34,8,29,6,"categories"],[34,18,29,16],[34,20,29,18,"stored"],[34,26,29,24],[34,27,29,25,"categories"],[34,37,29,35],[34,41,29,39],[34,43,29,41],[35,8,30,6,"selectedTags"],[35,20,30,18],[35,22,30,20,"stored"],[35,28,30,26],[35,29,30,27,"selectedTags"],[35,41,30,39],[35,45,30,43],[35,47,30,45],[36,8,31,6,"radiusKm"],[36,16,31,14],[36,18,31,16,"stored"],[36,24,31,22],[36,25,31,23,"radiusKm"],[36,33,31,31],[36,37,31,35],[36,39,31,37],[37,8,32,6,"homeAddress"],[37,19,32,17],[37,21,32,19],[38,10,33,8,"street"],[38,16,33,14],[38,18,33,16,"stored"],[38,24,33,22],[38,25,33,23,"street"],[38,31,33,29],[38,35,33,33],[38,37,33,35],[39,10,34,8,"postalCode"],[39,20,34,18],[39,22,34,20,"stored"],[39,28,34,26],[39,29,34,27,"postalCode"],[39,39,34,37],[39,43,34,41],[39,45,34,43],[40,10,35,8,"city"],[40,14,35,12],[40,16,35,14,"stored"],[40,22,35,20],[40,23,35,21,"city"],[40,27,35,25],[40,31,35,29],[40,33,35,31],[41,10,36,8,"country"],[41,17,36,15],[41,19,36,17],[42,8,37,6],[42,9,37,7],[43,8,38,6,"homeLat"],[43,15,38,13],[43,17,38,15,"stored"],[43,23,38,21],[43,24,38,22,"homeLat"],[43,31,38,29],[43,35,38,33,"stored"],[43,41,38,39],[43,42,38,40,"lat"],[43,45,38,43],[43,49,38,47],[43,53,38,51],[44,8,39,6,"homeLon"],[44,15,39,13],[44,17,39,15,"stored"],[44,23,39,21],[44,24,39,22,"homeLon"],[44,31,39,29],[44,35,39,33,"stored"],[44,41,39,39],[44,42,39,40,"lon"],[44,45,39,43],[44,49,39,47],[44,53,39,51],[45,8,40,6,"firstName"],[45,17,40,15],[45,19,40,17,"stored"],[45,25,40,23],[45,26,40,24,"name"],[45,30,40,28],[45,34,40,32,"stored"],[45,40,40,38],[45,41,40,39,"firstName"],[45,50,40,48],[46,8,41,6,"profilePhotoUri"],[46,23,41,21],[46,25,41,23,"stored"],[46,31,41,29],[46,32,41,30,"photoUrl"],[46,40,41,38],[46,44,41,42,"stored"],[46,50,41,48],[46,51,41,49,"profilePhotoUri"],[46,66,41,64],[47,8,42,6,"pushToken"],[47,17,42,15],[47,19,42,17,"stored"],[47,25,42,23],[47,26,42,24,"pushToken"],[48,6,43,4],[48,7,43,5],[50,6,45,4],[51,6,46,4],[51,12,46,10,"storage"],[51,28,46,17],[51,29,46,18,"setItem"],[51,36,46,25],[51,37,46,26,"PROFILE_KEY"],[51,48,46,37],[51,50,46,39,"profile"],[51,57,46,46],[51,58,46,47],[52,6,47,4,"console"],[52,13,47,11],[52,14,47,12,"log"],[52,17,47,15],[52,18,47,16],[52,48,47,46],[52,49,47,47],[53,4,48,2],[53,5,48,3],[53,11,48,9],[54,6,49,4],[55,6,50,4,"profile"],[55,13,50,11],[55,16,50,11,"Object"],[55,22,50,11],[55,23,50,11,"assign"],[55,29,50,11],[55,34,51,9,"stored"],[55,40,51,15],[56,8,52,6,"categories"],[56,18,52,16],[56,20,52,18,"stored"],[56,26,52,24],[56,27,52,25,"categories"],[56,37,52,35],[56,41,52,39],[56,43,52,41],[57,8,53,6,"selectedTags"],[57,20,53,18],[57,22,53,20,"stored"],[57,28,53,26],[57,29,53,27,"selectedTags"],[57,41,53,39],[57,45,53,43],[57,47,53,45],[58,8,54,6,"homeLat"],[58,15,54,13],[58,17,54,15,"stored"],[58,23,54,21],[58,24,54,22,"homeLat"],[58,31,54,29],[58,35,54,33],[58,39,54,37],[59,8,55,6,"homeLon"],[59,15,55,13],[59,17,55,15,"stored"],[59,23,55,21],[59,24,55,22,"homeLon"],[59,31,55,29],[59,35,55,33],[60,6,55,37],[60,8,56,5],[61,4,57,2],[62,4,59,2,"console"],[62,11,59,9],[62,12,59,10,"log"],[62,15,59,13],[62,16,59,14],[62,52,59,50],[62,54,59,52],[63,6,60,4,"userId"],[63,12,60,10],[63,14,60,12,"profile"],[63,21,60,19],[63,22,60,20,"userId"],[63,28,60,26],[64,6,61,4,"categories"],[64,16,61,14],[64,18,61,16,"profile"],[64,25,61,23],[64,26,61,24,"categories"],[64,36,61,34],[64,37,61,35,"length"],[64,43,61,41],[65,6,62,4,"tags"],[65,10,62,8],[65,12,62,10,"profile"],[65,19,62,17],[65,20,62,18,"selectedTags"],[65,32,62,30],[65,33,62,31,"length"],[66,4,63,2],[66,5,63,3],[66,6,63,4],[67,4,65,2],[67,11,65,9,"profile"],[67,18,65,16],[68,2,66,0],[69,2,68,7],[69,17,68,22,"saveWorkerProfile"],[69,34,68,39,"saveWorkerProfile"],[69,35,68,40,"profile"],[69,42,68,62],[69,44,68,79],[70,4,69,2,"console"],[70,11,69,9],[70,12,69,10,"log"],[70,15,69,13],[70,16,69,14],[70,63,69,61],[70,65,69,63,"profile"],[70,72,69,70],[70,73,69,71,"userId"],[70,79,69,77],[70,80,69,78],[71,4,70,2,"console"],[71,11,70,9],[71,12,70,10,"log"],[71,15,70,13],[71,16,70,14],[71,51,70,49],[71,53,70,51,"profile"],[71,60,70,58],[71,61,70,59,"categories"],[71,71,70,69],[71,72,70,70],[72,4,71,2,"console"],[72,11,71,9],[72,12,71,10,"log"],[72,15,71,13],[72,16,71,14],[72,53,71,51],[72,55,71,53,"profile"],[72,62,71,60],[72,63,71,61,"selectedTags"],[72,75,71,73],[72,76,71,74],[74,4,73,2],[75,4,74,2],[75,10,74,8,"normalized"],[75,20,74,33],[75,23,74,33,"Object"],[75,29,74,33],[75,30,74,33,"assign"],[75,36,74,33],[75,41,75,7,"profile"],[75,48,75,14],[76,6,76,4,"categories"],[76,16,76,14],[76,18,76,16,"profile"],[76,25,76,23],[76,26,76,24,"categories"],[76,36,76,34],[76,40,76,38],[76,42,76,40],[77,6,77,4,"selectedTags"],[77,18,77,16],[77,20,77,18,"profile"],[77,27,77,25],[77,28,77,26,"selectedTags"],[77,40,77,38],[77,44,77,42],[78,4,77,44],[78,6,78,3],[79,4,80,2,"console"],[79,11,80,9],[79,12,80,10,"log"],[79,15,80,13],[79,16,80,14],[79,56,80,54],[79,58,80,56,"normalized"],[79,68,80,66],[79,69,80,67,"selectedTags"],[79,81,80,79],[79,82,80,80],[80,4,82,2],[80,10,82,8,"storage"],[80,26,82,15],[80,27,82,16,"setItem"],[80,34,82,23],[80,35,82,24,"PROFILE_KEY"],[80,46,82,35],[80,48,82,37,"normalized"],[80,58,82,47],[80,59,82,48],[81,4,83,2,"console"],[81,11,83,9],[81,12,83,10,"log"],[81,15,83,13],[81,16,83,14],[81,65,83,63],[81,67,83,65],[82,6,84,4,"userId"],[82,12,84,10],[82,14,84,12,"normalized"],[82,24,84,22],[82,25,84,23,"userId"],[82,31,84,29],[83,6,85,4,"categories"],[83,16,85,14],[83,18,85,16,"normalized"],[83,28,85,26],[83,29,85,27,"categories"],[83,39,85,37],[83,40,85,38,"length"],[83,46,85,44],[84,6,86,4,"tags"],[84,10,86,8],[84,12,86,10,"normalized"],[84,22,86,20],[84,23,86,21,"selectedTags"],[84,35,86,33],[84,36,86,34,"length"],[84,42,86,40],[85,6,87,4,"pushToken"],[85,15,87,13],[85,17,87,15,"normalized"],[85,27,87,25],[85,28,87,26,"pushToken"],[85,37,87,35],[85,40,87,38],[85,43,87,41],[85,46,87,44],[86,4,88,2],[86,5,88,3],[86,6,88,4],[87,2,89,0],[88,0,89,1]],"functionMap":{"names":["<global>","getWorkerProfile","saveWorkerProfile"],"mappings":"AAA;OCM;CD2D;OEE"}},"type":"js/module"}]}