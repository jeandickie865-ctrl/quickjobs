{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":242,"column":0,"index":5994}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":19},"end":{"line":2,"column":69,"index":88}}],"key":"6eZFbfKht0uO2NEVT/d8+i8B0s8="}},{"name":"expo-constants","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":89},"end":{"line":3,"column":39,"index":128}}],"key":"2TquPknmjb1g5OMuvQ0eTuioYjU="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.applyForJob = applyForJob;\n  exports.getApplicationsForJob = getApplicationsForJob;\n  exports.getJobById = getJobById;\n  exports.getMyApplications = getMyApplications;\n  exports.getWorkerProfile = getWorkerProfile;\n  exports.getWorkerProfileById = getWorkerProfileById;\n  exports.selectWorker = selectWorker;\n  exports.updateWorkerProfile = updateWorkerProfile;\n  exports.uploadProfilePhoto = uploadProfilePhoto;\n  var _asyncStorage = _interopRequireDefault(require(_dependencyMap[1], \"@react-native-async-storage/async-storage\"));\n  var _expoConstants = _interopRequireDefault(require(_dependencyMap[2], \"expo-constants\"));\n  // services/api.ts\n\n  // Get API base URL from environment\n  // In Kubernetes, all /api/* requests are automatically routed to backend (port 8001)\n  // So we use an empty base URL (relative paths)\n  const API_BASE_URL = _expoConstants.default.expoConfig?.extra?.backendUrl || '';\n\n  /**\n   * Get auth token from AsyncStorage\n   */\n  async function getAuthToken() {\n    try {\n      const token = await _asyncStorage.default.getItem('@backup:token');\n      return token;\n    } catch (error) {\n      console.error('Error getting auth token:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Make authenticated API request\n   */\n  async function apiRequest(endpoint, options = {}) {\n    const token = await getAuthToken();\n    const headers = Object.assign({\n      'Content-Type': 'application/json'\n    }, options.headers);\n    if (token) {\n      headers['Authorization'] = `Bearer ${token}`;\n    }\n    const url = `${API_BASE_URL}${endpoint}`;\n    try {\n      const response = await fetch(url, Object.assign({}, options, {\n        headers\n      }));\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({\n          detail: 'Unknown error'\n        }));\n        throw new Error(errorData.detail || `HTTP ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error(`API Error [${endpoint}]:`, error);\n      throw error;\n    }\n  }\n\n  // ============================================\n  // APPLICATIONS API\n  // ============================================\n\n  /**\n   * Worker bewirbt sich auf einen Job\n   */\n  async function applyForJob(jobId) {\n    return apiRequest('/api/applications', {\n      method: 'POST',\n      body: JSON.stringify({\n        job_id: jobId\n      })\n    });\n  }\n\n  /**\n   * Worker lädt eigene Bewerbungen\n   */\n  async function getMyApplications() {\n    return apiRequest('/api/applications/me');\n  }\n\n  /**\n   * Employer lädt Bewerbungen für einen Job\n   */\n  async function getApplicationsForJob(jobId) {\n    return apiRequest(`/api/applications/job/${jobId}`);\n  }\n\n  // ============================================\n  // MATCHES API\n  // ============================================\n\n  /**\n   * Employer wählt einen Worker aus\n   */\n  async function selectWorker(applicationId) {\n    return apiRequest(`/api/matches/select/${applicationId}`, {\n      method: 'POST'\n    });\n  }\n\n  // ============================================\n  // JOBS API\n  // ============================================\n\n  /**\n   * Get job by ID\n   */\n  async function getJobById(jobId) {\n    return apiRequest(`/api/jobs/${jobId}`);\n  }\n\n  // ============================================\n  // PROFILES API\n  // ============================================\n\n  /**\n   * Worker Profile laden (eigenes)\n   */\n  async function getWorkerProfile() {\n    return apiRequest('/api/profiles/worker/me');\n  }\n\n  /**\n   * Worker Profile laden (by ID, für Employers)\n   */\n  async function getWorkerProfileById(userId) {\n    return apiRequest(`/api/profiles/worker/${userId}`);\n  }\n\n  /**\n   * Worker Profile aktualisieren\n   */\n  async function updateWorkerProfile(data) {\n    return apiRequest('/api/profiles/worker/me', {\n      method: 'PATCH',\n      body: JSON.stringify(data)\n    });\n  }\n\n  // ============================================\n  // UPLOAD API\n  // ============================================\n\n  /**\n   * Upload profile photo\n   */\n  async function uploadProfilePhoto(uri) {\n    const token = await getAuthToken();\n\n    // Create form data\n    const formData = new FormData();\n    const filename = uri.split('/').pop() || 'photo.jpg';\n    const fileType = filename.split('.').pop() || 'jpg';\n\n    // @ts-ignore - React Native FormData accepts this format\n    formData.append('file', {\n      uri,\n      name: filename,\n      type: `image/${fileType}`\n    });\n    const url = `${API_BASE_URL}/api/upload/profile-photo`;\n    try {\n      const response = await fetch(url, {\n        method: 'POST',\n        headers: {\n          'Authorization': token ? `Bearer ${token}` : ''\n        },\n        body: formData\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({\n          detail: 'Upload failed'\n        }));\n        throw new Error(errorData.detail || `HTTP ${response.status}`);\n      }\n      const result = await response.json();\n      // Backend returns { photo_url, message }, map to { url, message }\n      return {\n        url: result.photo_url,\n        message: result.message\n      };\n    } catch (error) {\n      console.error('Photo upload error:', error);\n      throw error;\n    }\n  }\n});","lineCount":195,"map":[[15,2,2,0],[15,6,2,0,"_asyncStorage"],[15,19,2,0],[15,22,2,0,"_interopRequireDefault"],[15,44,2,0],[15,45,2,0,"require"],[15,52,2,0],[15,53,2,0,"_dependencyMap"],[15,67,2,0],[16,2,3,0],[16,6,3,0,"_expoConstants"],[16,20,3,0],[16,23,3,0,"_interopRequireDefault"],[16,45,3,0],[16,46,3,0,"require"],[16,53,3,0],[16,54,3,0,"_dependencyMap"],[16,68,3,0],[17,2,1,0],[19,2,5,0],[20,2,6,0],[21,2,7,0],[22,2,8,0],[22,8,8,6,"API_BASE_URL"],[22,20,8,18],[22,23,8,21,"Constants"],[22,45,8,30],[22,46,8,31,"expoConfig"],[22,56,8,41],[22,58,8,43,"extra"],[22,63,8,48],[22,65,8,50,"backendUrl"],[22,75,8,60],[22,79,8,64],[22,81,8,66],[24,2,10,0],[25,0,11,0],[26,0,12,0],[27,2,13,0],[27,17,13,15,"getAuthToken"],[27,29,13,27,"getAuthToken"],[27,30,13,27],[27,32,13,54],[28,4,14,2],[28,8,14,6],[29,6,15,4],[29,12,15,10,"token"],[29,17,15,15],[29,20,15,18],[29,26,15,24,"AsyncStorage"],[29,47,15,36],[29,48,15,37,"getItem"],[29,55,15,44],[29,56,15,45],[29,71,15,60],[29,72,15,61],[30,6,16,4],[30,13,16,11,"token"],[30,18,16,16],[31,4,17,2],[31,5,17,3],[31,6,17,4],[31,13,17,11,"error"],[31,18,17,16],[31,20,17,18],[32,6,18,4,"console"],[32,13,18,11],[32,14,18,12,"error"],[32,19,18,17],[32,20,18,18],[32,47,18,45],[32,49,18,47,"error"],[32,54,18,52],[32,55,18,53],[33,6,19,4],[33,13,19,11],[33,17,19,15],[34,4,20,2],[35,2,21,0],[37,2,23,0],[38,0,24,0],[39,0,25,0],[40,2,26,0],[40,17,26,15,"apiRequest"],[40,27,26,25,"apiRequest"],[40,28,27,2,"endpoint"],[40,36,27,18],[40,38,28,2,"options"],[40,45,28,22],[40,48,28,25],[40,49,28,26],[40,50,28,27],[40,52,29,14],[41,4,30,2],[41,10,30,8,"token"],[41,15,30,13],[41,18,30,16],[41,24,30,22,"getAuthToken"],[41,36,30,34],[41,37,30,35],[41,38,30,36],[42,4,32,2],[42,10,32,8,"headers"],[42,17,32,28],[42,20,32,28,"Object"],[42,26,32,28],[42,27,32,28,"assign"],[42,33,32,28],[43,6,33,4],[43,20,33,18],[43,22,33,20],[44,4,33,38],[44,7,34,7,"options"],[44,14,34,14],[44,15,34,15,"headers"],[44,22,34,22],[44,23,35,3],[45,4,37,2],[45,8,37,6,"token"],[45,13,37,11],[45,15,37,13],[46,6,38,4,"headers"],[46,13,38,11],[46,14,38,12],[46,29,38,27],[46,30,38,28],[46,33,38,31],[46,43,38,41,"token"],[46,48,38,46],[46,50,38,48],[47,4,39,2],[48,4,41,2],[48,10,41,8,"url"],[48,13,41,11],[48,16,41,14],[48,19,41,17,"API_BASE_URL"],[48,31,41,29],[48,34,41,32,"endpoint"],[48,42,41,40],[48,44,41,42],[49,4,43,2],[49,8,43,6],[50,6,44,4],[50,12,44,10,"response"],[50,20,44,18],[50,23,44,21],[50,29,44,27,"fetch"],[50,34,44,32],[50,35,44,33,"url"],[50,38,44,36],[50,40,44,36,"Object"],[50,46,44,36],[50,47,44,36,"assign"],[50,53,44,36],[50,58,45,9,"options"],[50,65,45,16],[51,8,46,6,"headers"],[52,6,46,13],[52,8,47,5],[52,9,47,6],[53,6,49,4],[53,10,49,8],[53,11,49,9,"response"],[53,19,49,17],[53,20,49,18,"ok"],[53,22,49,20],[53,24,49,22],[54,8,50,6],[54,14,50,12,"errorData"],[54,23,50,21],[54,26,50,24],[54,32,50,30,"response"],[54,40,50,38],[54,41,50,39,"json"],[54,45,50,43],[54,46,50,44],[54,47,50,45],[54,48,50,46,"catch"],[54,53,50,51],[54,54,50,52],[54,61,50,59],[55,10,50,61,"detail"],[55,16,50,67],[55,18,50,69],[56,8,50,85],[56,9,50,86],[56,10,50,87],[56,11,50,88],[57,8,51,6],[57,14,51,12],[57,18,51,16,"Error"],[57,23,51,21],[57,24,51,22,"errorData"],[57,33,51,31],[57,34,51,32,"detail"],[57,40,51,38],[57,44,51,42],[57,52,51,50,"response"],[57,60,51,58],[57,61,51,59,"status"],[57,67,51,65],[57,69,51,67],[57,70,51,68],[58,6,52,4],[59,6,54,4],[59,13,54,11],[59,19,54,17,"response"],[59,27,54,25],[59,28,54,26,"json"],[59,32,54,30],[59,33,54,31],[59,34,54,32],[60,4,55,2],[60,5,55,3],[60,6,55,4],[60,13,55,11,"error"],[60,18,55,16],[60,20,55,18],[61,6,56,4,"console"],[61,13,56,11],[61,14,56,12,"error"],[61,19,56,17],[61,20,56,18],[61,34,56,32,"endpoint"],[61,42,56,40],[61,46,56,44],[61,48,56,46,"error"],[61,53,56,51],[61,54,56,52],[62,6,57,4],[62,12,57,10,"error"],[62,17,57,15],[63,4,58,2],[64,2,59,0],[66,2,61,0],[67,2,62,0],[68,2,63,0],[70,2,73,0],[71,0,74,0],[72,0,75,0],[73,2,76,7],[73,17,76,22,"applyForJob"],[73,28,76,33,"applyForJob"],[73,29,76,34,"jobId"],[73,34,76,47],[73,36,76,71],[74,4,77,2],[74,11,77,9,"apiRequest"],[74,21,77,19],[74,22,77,33],[74,41,77,52],[74,43,77,54],[75,6,78,4,"method"],[75,12,78,10],[75,14,78,12],[75,20,78,18],[76,6,79,4,"body"],[76,10,79,8],[76,12,79,10,"JSON"],[76,16,79,14],[76,17,79,15,"stringify"],[76,26,79,24],[76,27,79,25],[77,8,79,27,"job_id"],[77,14,79,33],[77,16,79,35,"jobId"],[78,6,79,41],[78,7,79,42],[79,4,80,2],[79,5,80,3],[79,6,80,4],[80,2,81,0],[82,2,83,0],[83,0,84,0],[84,0,85,0],[85,2,86,7],[85,17,86,22,"getMyApplications"],[85,34,86,39,"getMyApplications"],[85,35,86,39],[85,37,86,66],[86,4,87,2],[86,11,87,9,"apiRequest"],[86,21,87,19],[86,22,87,35],[86,44,87,57],[86,45,87,58],[87,2,88,0],[89,2,90,0],[90,0,91,0],[91,0,92,0],[92,2,93,7],[92,17,93,22,"getApplicationsForJob"],[92,38,93,43,"getApplicationsForJob"],[92,39,93,44,"jobId"],[92,44,93,57],[92,46,93,83],[93,4,94,2],[93,11,94,9,"apiRequest"],[93,21,94,19],[93,22,94,35],[93,47,94,60,"jobId"],[93,52,94,65],[93,54,94,67],[93,55,94,68],[94,2,95,0],[96,2,97,0],[97,2,98,0],[98,2,99,0],[100,2,106,0],[101,0,107,0],[102,0,108,0],[103,2,109,7],[103,17,109,22,"selectWorker"],[103,29,109,34,"selectWorker"],[103,30,109,35,"applicationId"],[103,43,109,56],[103,45,109,89],[104,4,110,2],[104,11,110,9,"apiRequest"],[104,21,110,19],[104,22,110,42],[104,45,110,65,"applicationId"],[104,58,110,78],[104,60,110,80],[104,62,110,82],[105,6,111,4,"method"],[105,12,111,10],[105,14,111,12],[106,4,112,2],[106,5,112,3],[106,6,112,4],[107,2,113,0],[109,2,115,0],[110,2,116,0],[111,2,117,0],[113,2,135,0],[114,0,136,0],[115,0,137,0],[116,2,138,7],[116,17,138,22,"getJobById"],[116,27,138,32,"getJobById"],[116,28,138,33,"jobId"],[116,33,138,46],[116,35,138,62],[117,4,139,2],[117,11,139,9,"apiRequest"],[117,21,139,19],[117,22,139,25],[117,35,139,38,"jobId"],[117,40,139,43],[117,42,139,45],[117,43,139,46],[118,2,140,0],[120,2,142,0],[121,2,143,0],[122,2,144,0],[124,2,164,0],[125,0,165,0],[126,0,166,0],[127,2,167,7],[127,17,167,22,"getWorkerProfile"],[127,33,167,38,"getWorkerProfile"],[127,34,167,38],[127,36,167,65],[128,4,168,2],[128,11,168,9,"apiRequest"],[128,21,168,19],[128,22,168,35],[128,47,168,60],[128,48,168,61],[129,2,169,0],[131,2,171,0],[132,0,172,0],[133,0,173,0],[134,2,174,7],[134,17,174,22,"getWorkerProfileById"],[134,37,174,42,"getWorkerProfileById"],[134,38,174,43,"userId"],[134,44,174,57],[134,46,174,83],[135,4,175,2],[135,11,175,9,"apiRequest"],[135,21,175,19],[135,22,175,35],[135,46,175,59,"userId"],[135,52,175,65],[135,54,175,67],[135,55,175,68],[136,2,176,0],[138,2,178,0],[139,0,179,0],[140,0,180,0],[141,2,181,7],[141,17,181,22,"updateWorkerProfile"],[141,36,181,41,"updateWorkerProfile"],[141,37,181,42,"data"],[141,41,181,70],[141,43,181,96],[142,4,182,2],[142,11,182,9,"apiRequest"],[142,21,182,19],[142,22,182,35],[142,47,182,60],[142,49,182,62],[143,6,183,4,"method"],[143,12,183,10],[143,14,183,12],[143,21,183,19],[144,6,184,4,"body"],[144,10,184,8],[144,12,184,10,"JSON"],[144,16,184,14],[144,17,184,15,"stringify"],[144,26,184,24],[144,27,184,25,"data"],[144,31,184,29],[145,4,185,2],[145,5,185,3],[145,6,185,4],[146,2,186,0],[148,2,188,0],[149,2,189,0],[150,2,190,0],[152,2,197,0],[153,0,198,0],[154,0,199,0],[155,2,200,7],[155,17,200,22,"uploadProfilePhoto"],[155,35,200,40,"uploadProfilePhoto"],[155,36,200,41,"uri"],[155,39,200,52],[155,41,200,97],[156,4,201,2],[156,10,201,8,"token"],[156,15,201,13],[156,18,201,16],[156,24,201,22,"getAuthToken"],[156,36,201,34],[156,37,201,35],[156,38,201,36],[158,4,203,2],[159,4,204,2],[159,10,204,8,"formData"],[159,18,204,16],[159,21,204,19],[159,25,204,23,"FormData"],[159,33,204,31],[159,34,204,32],[159,35,204,33],[160,4,205,2],[160,10,205,8,"filename"],[160,18,205,16],[160,21,205,19,"uri"],[160,24,205,22],[160,25,205,23,"split"],[160,30,205,28],[160,31,205,29],[160,34,205,32],[160,35,205,33],[160,36,205,34,"pop"],[160,39,205,37],[160,40,205,38],[160,41,205,39],[160,45,205,43],[160,56,205,54],[161,4,206,2],[161,10,206,8,"fileType"],[161,18,206,16],[161,21,206,19,"filename"],[161,29,206,27],[161,30,206,28,"split"],[161,35,206,33],[161,36,206,34],[161,39,206,37],[161,40,206,38],[161,41,206,39,"pop"],[161,44,206,42],[161,45,206,43],[161,46,206,44],[161,50,206,48],[161,55,206,53],[163,4,208,2],[164,4,209,2,"formData"],[164,12,209,10],[164,13,209,11,"append"],[164,19,209,17],[164,20,209,18],[164,26,209,24],[164,28,209,26],[165,6,210,4,"uri"],[165,9,210,7],[166,6,211,4,"name"],[166,10,211,8],[166,12,211,10,"filename"],[166,20,211,18],[167,6,212,4,"type"],[167,10,212,8],[167,12,212,10],[167,21,212,19,"fileType"],[167,29,212,27],[168,4,213,2],[168,5,213,3],[168,6,213,4],[169,4,215,2],[169,10,215,8,"url"],[169,13,215,11],[169,16,215,14],[169,19,215,17,"API_BASE_URL"],[169,31,215,29],[169,58,215,56],[170,4,217,2],[170,8,217,6],[171,6,218,4],[171,12,218,10,"response"],[171,20,218,18],[171,23,218,21],[171,29,218,27,"fetch"],[171,34,218,32],[171,35,218,33,"url"],[171,38,218,36],[171,40,218,38],[172,8,219,6,"method"],[172,14,219,12],[172,16,219,14],[172,22,219,20],[173,8,220,6,"headers"],[173,15,220,13],[173,17,220,15],[174,10,221,8],[174,25,221,23],[174,27,221,25,"token"],[174,32,221,30],[174,35,221,33],[174,45,221,43,"token"],[174,50,221,48],[174,52,221,50],[174,55,221,53],[175,8,222,6],[175,9,222,7],[176,8,223,6,"body"],[176,12,223,10],[176,14,223,12,"formData"],[177,6,224,4],[177,7,224,5],[177,8,224,6],[178,6,226,4],[178,10,226,8],[178,11,226,9,"response"],[178,19,226,17],[178,20,226,18,"ok"],[178,22,226,20],[178,24,226,22],[179,8,227,6],[179,14,227,12,"errorData"],[179,23,227,21],[179,26,227,24],[179,32,227,30,"response"],[179,40,227,38],[179,41,227,39,"json"],[179,45,227,43],[179,46,227,44],[179,47,227,45],[179,48,227,46,"catch"],[179,53,227,51],[179,54,227,52],[179,61,227,59],[180,10,227,61,"detail"],[180,16,227,67],[180,18,227,69],[181,8,227,85],[181,9,227,86],[181,10,227,87],[181,11,227,88],[182,8,228,6],[182,14,228,12],[182,18,228,16,"Error"],[182,23,228,21],[182,24,228,22,"errorData"],[182,33,228,31],[182,34,228,32,"detail"],[182,40,228,38],[182,44,228,42],[182,52,228,50,"response"],[182,60,228,58],[182,61,228,59,"status"],[182,67,228,65],[182,69,228,67],[182,70,228,68],[183,6,229,4],[184,6,231,4],[184,12,231,10,"result"],[184,18,231,16],[184,21,231,19],[184,27,231,25,"response"],[184,35,231,33],[184,36,231,34,"json"],[184,40,231,38],[184,41,231,39],[184,42,231,40],[185,6,232,4],[186,6,233,4],[186,13,233,11],[187,8,234,6,"url"],[187,11,234,9],[187,13,234,11,"result"],[187,19,234,17],[187,20,234,18,"photo_url"],[187,29,234,27],[188,8,235,6,"message"],[188,15,235,13],[188,17,235,15,"result"],[188,23,235,21],[188,24,235,22,"message"],[189,6,236,4],[189,7,236,5],[190,4,237,2],[190,5,237,3],[190,6,237,4],[190,13,237,11,"error"],[190,18,237,16],[190,20,237,18],[191,6,238,4,"console"],[191,13,238,11],[191,14,238,12,"error"],[191,19,238,17],[191,20,238,18],[191,41,238,39],[191,43,238,41,"error"],[191,48,238,46],[191,49,238,47],[192,6,239,4],[192,12,239,10,"error"],[192,17,239,15],[193,4,240,2],[194,2,241,0],[195,0,241,1]],"functionMap":{"names":["<global>","getAuthToken","apiRequest","response.json._catch$argument_0","applyForJob","getMyApplications","getApplicationsForJob","selectWorker","getJobById","getWorkerProfile","getWorkerProfileById","updateWorkerProfile","uploadProfilePhoto"],"mappings":"AAA;ACY;CDQ;AEK;oDCwB,mCD;CFS;OIiB;CJK;OKK;CLE;OMK;CNE;OOc;CPI;OQyB;CRE;OS2B;CTE;OUK;CVE;OWK;CXK;OYc;oDT2B,mCS;CZc"}},"type":"js/module"}]}