{"dependencies":[{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":45,"index":45}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getMessagesForApplication = getMessagesForApplication;\n  exports.addMessage = addMessage;\n  var _storage = require(_dependencyMap[0], \"./storage\");\n  const CHAT_KEY = '@shiftmatch:chatMessages';\n  async function loadAll() {\n    return (await (0, _storage.getItem)(CHAT_KEY)) ?? [];\n  }\n  async function saveAll(messages) {\n    await (0, _storage.setItem)(CHAT_KEY, messages);\n  }\n  async function getMessagesForApplication(applicationId) {\n    const all = await loadAll();\n    return all.filter(m => m.applicationId === applicationId).sort((a, b) => a.createdAt.localeCompare(b.createdAt));\n  }\n  async function addMessage(applicationId, senderRole, text) {\n    const all = await loadAll();\n    const msg = {\n      id: 'msg-' + Date.now().toString() + '-' + Math.random().toString(36).slice(2),\n      applicationId,\n      senderRole,\n      text,\n      createdAt: new Date().toISOString()\n    };\n    const next = [...all, msg];\n    await saveAll(next);\n    return msg;\n  }\n});","lineCount":34,"map":[[7,2,14,0,"exports"],[7,9,14,0],[7,10,14,0,"getMessagesForApplication"],[7,35,14,0],[7,38,14,0,"getMessagesForApplication"],[7,63,14,0],[8,2,21,0,"exports"],[8,9,21,0],[8,10,21,0,"addMessage"],[8,20,21,0],[8,23,21,0,"addMessage"],[8,33,21,0],[9,2,1,0],[9,6,1,0,"_storage"],[9,14,1,0],[9,17,1,0,"require"],[9,24,1,0],[9,25,1,0,"_dependencyMap"],[9,39,1,0],[10,2,4,0],[10,8,4,6,"CHAT_KEY"],[10,16,4,14],[10,19,4,17],[10,45,4,43],[11,2,6,0],[11,17,6,15,"loadAll"],[11,24,6,22,"loadAll"],[11,25,6,22],[11,27,6,49],[12,4,7,2],[12,11,7,9],[12,12,7,10],[12,18,7,16],[12,22,7,16,"getItem"],[12,30,7,23],[12,31,7,23,"getItem"],[12,38,7,23],[12,40,7,39,"CHAT_KEY"],[12,48,7,47],[12,49,7,48],[12,54,7,53],[12,56,7,55],[13,2,8,0],[14,2,10,0],[14,17,10,15,"saveAll"],[14,24,10,22,"saveAll"],[14,25,10,23,"messages"],[14,33,10,46],[14,35,10,63],[15,4,11,2],[15,10,11,8],[15,14,11,8,"setItem"],[15,22,11,15],[15,23,11,15,"setItem"],[15,30,11,15],[15,32,11,16,"CHAT_KEY"],[15,40,11,24],[15,42,11,26,"messages"],[15,50,11,34],[15,51,11,35],[16,2,12,0],[17,2,14,7],[17,17,14,22,"getMessagesForApplication"],[17,42,14,47,"getMessagesForApplication"],[17,43,14,48,"applicationId"],[17,56,14,69],[17,58,14,95],[18,4,15,2],[18,10,15,8,"all"],[18,13,15,11],[18,16,15,14],[18,22,15,20,"loadAll"],[18,29,15,27],[18,30,15,28],[18,31,15,29],[19,4,16,2],[19,11,16,9,"all"],[19,14,16,12],[19,15,17,5,"filter"],[19,21,17,11],[19,22,17,12,"m"],[19,23,17,13],[19,27,17,17,"m"],[19,28,17,18],[19,29,17,19,"applicationId"],[19,42,17,32],[19,47,17,37,"applicationId"],[19,60,17,50],[19,61,17,51],[19,62,18,5,"sort"],[19,66,18,9],[19,67,18,10],[19,68,18,11,"a"],[19,69,18,12],[19,71,18,14,"b"],[19,72,18,15],[19,77,18,20,"a"],[19,78,18,21],[19,79,18,22,"createdAt"],[19,88,18,31],[19,89,18,32,"localeCompare"],[19,102,18,45],[19,103,18,46,"b"],[19,104,18,47],[19,105,18,48,"createdAt"],[19,114,18,57],[19,115,18,58],[19,116,18,59],[20,2,19,0],[21,2,21,7],[21,17,21,22,"addMessage"],[21,27,21,32,"addMessage"],[21,28,22,2,"applicationId"],[21,41,22,23],[21,43,23,2,"senderRole"],[21,53,23,28],[21,55,24,2,"text"],[21,59,24,14],[21,61,25,24],[22,4,26,2],[22,10,26,8,"all"],[22,13,26,11],[22,16,26,14],[22,22,26,20,"loadAll"],[22,29,26,27],[22,30,26,28],[22,31,26,29],[23,4,27,2],[23,10,27,8,"msg"],[23,13,27,24],[23,16,27,27],[24,6,28,4,"id"],[24,8,28,6],[24,10,28,8],[24,16,28,14],[24,19,28,17,"Date"],[24,23,28,21],[24,24,28,22,"now"],[24,27,28,25],[24,28,28,26],[24,29,28,27],[24,30,28,28,"toString"],[24,38,28,36],[24,39,28,37],[24,40,28,38],[24,43,28,41],[24,46,28,44],[24,49,28,47,"Math"],[24,53,28,51],[24,54,28,52,"random"],[24,60,28,58],[24,61,28,59],[24,62,28,60],[24,63,28,61,"toString"],[24,71,28,69],[24,72,28,70],[24,74,28,72],[24,75,28,73],[24,76,28,74,"slice"],[24,81,28,79],[24,82,28,80],[24,83,28,81],[24,84,28,82],[25,6,29,4,"applicationId"],[25,19,29,17],[26,6,30,4,"senderRole"],[26,16,30,14],[27,6,31,4,"text"],[27,10,31,8],[28,6,32,4,"createdAt"],[28,15,32,13],[28,17,32,15],[28,21,32,19,"Date"],[28,25,32,23],[28,26,32,24],[28,27,32,25],[28,28,32,26,"toISOString"],[28,39,32,37],[28,40,32,38],[29,4,33,2],[29,5,33,3],[30,4,34,2],[30,10,34,8,"next"],[30,14,34,12],[30,17,34,15],[30,18,34,16],[30,21,34,19,"all"],[30,24,34,22],[30,26,34,24,"msg"],[30,29,34,27],[30,30,34,28],[31,4,35,2],[31,10,35,8,"saveAll"],[31,17,35,15],[31,18,35,16,"next"],[31,22,35,20],[31,23,35,21],[32,4,36,2],[32,11,36,9,"msg"],[32,14,36,12],[33,2,37,0],[34,0,37,1],[34,3]],"functionMap":{"names":["<global>","loadAll","saveAll","getMessagesForApplication","all.filter$argument_0","all.filter.sort$argument_0","addMessage"],"mappings":"AAA;ACK;CDE;AEE;CFE;OGE;YCG,sCD;UEC,gDF;CHC;OME;CNgB"},"hasCjsExports":false},"type":"js/module"}]}