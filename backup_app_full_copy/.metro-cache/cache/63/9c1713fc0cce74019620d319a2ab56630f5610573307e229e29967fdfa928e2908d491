{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":51},"end":{"line":2,"column":69,"index":120}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.migrateUserIdsToEmailBased = migrateUserIdsToEmailBased;\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  // utils/migrateUserIds.ts - Fix f√ºr alte User IDs\n\n  async function migrateUserIdsToEmailBased() {\n    console.log('üîÑ Starting User ID migration...');\n    try {\n      // 1. Get users database\n      const usersDbStr = await AsyncStorage.default.getItem('@shiftmatch:users');\n      if (!usersDbStr) {\n        console.log('‚ö†Ô∏è No users database found');\n        return;\n      }\n      const usersDb = JSON.parse(usersDbStr);\n      const emails = Object.keys(usersDb);\n      console.log(`üìã Found ${emails.length} users`);\n\n      // 2. Get all jobs\n      const jobsStr = await AsyncStorage.default.getItem('@shiftmatch:jobs');\n      const jobs = jobsStr ? JSON.parse(jobsStr) : [];\n      console.log(`üì¶ Found ${jobs.length} jobs`);\n\n      // 3. Get all applications\n      const appsStr = await AsyncStorage.default.getItem('@shiftmatch:applications');\n      const applications = appsStr ? JSON.parse(appsStr) : [];\n      console.log(`üì® Found ${applications.length} applications`);\n\n      // 4. Create old ID ‚Üí new ID mapping\n      const oldToNewIdMap = {};\n      for (const email of emails) {\n        const newId = `user_${email.toLowerCase().replace(/[^a-z0-9]/g, '_')}`;\n\n        // Check if there are jobs with old employer IDs\n        const jobsForEmail = jobs.filter(j => j.employerId && j.employerId.includes('1763920'));\n        if (jobsForEmail.length > 0) {\n          // This is an employer with old ID\n          const oldId = jobsForEmail[0].employerId;\n          oldToNewIdMap[oldId] = newId;\n          console.log(`üîÑ Mapping: ${oldId} ‚Üí ${newId} (${email})`);\n        }\n      }\n\n      // 5. Update job employer IDs\n      let jobsUpdated = false;\n      const updatedJobs = jobs.map(job => {\n        if (job.employerId && oldToNewIdMap[job.employerId]) {\n          console.log(`üì¶ Updating job ${job.id}: ${job.employerId} ‚Üí ${oldToNewIdMap[job.employerId]}`);\n          jobsUpdated = true;\n          return Object.assign({}, job, {\n            employerId: oldToNewIdMap[job.employerId]\n          });\n        }\n        return job;\n      });\n      if (jobsUpdated) {\n        await AsyncStorage.default.setItem('@shiftmatch:jobs', JSON.stringify(updatedJobs));\n        console.log('‚úÖ Jobs updated');\n      }\n\n      // 6. Update worker profile if needed\n      const profileStr = await AsyncStorage.default.getItem('@shiftmatch:worker_profile');\n      if (profileStr) {\n        const profile = JSON.parse(profileStr);\n\n        // Check if profile has old ID format\n        if (profile.userId && profile.userId.includes('1763917')) {\n          // Find matching email\n          const matchingEmail = emails.find(email => {\n            const newId = `user_${email.toLowerCase().replace(/[^a-z0-9]/g, '_')}`;\n            return usersDb[email].role === 'worker';\n          });\n          if (matchingEmail) {\n            const newId = `user_${matchingEmail.toLowerCase().replace(/[^a-z0-9]/g, '_')}`;\n            profile.userId = newId;\n            await AsyncStorage.default.setItem('@shiftmatch:worker_profile', JSON.stringify(profile));\n            console.log(`‚úÖ Worker profile updated: ${newId}`);\n          }\n        }\n      }\n      console.log('‚úÖ Migration complete!');\n      return {\n        success: true,\n        migratedCount: Object.keys(oldToNewIdMap).length\n      };\n    } catch (error) {\n      console.error('‚ùå Migration error:', error);\n      return {\n        success: false,\n        error\n      };\n    }\n  }\n});","lineCount":105,"map":[[12,2,4,0,"exports"],[12,9,4,0],[12,10,4,0,"migrateUserIdsToEmailBased"],[12,36,4,0],[12,39,4,0,"migrateUserIdsToEmailBased"],[12,65,4,0],[13,2,2,0],[13,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[13,42,2,0],[13,45,2,0,"require"],[13,52,2,0],[13,53,2,0,"_dependencyMap"],[13,67,2,0],[14,2,2,0],[14,6,2,0,"AsyncStorage"],[14,18,2,0],[14,21,2,0,"_interopDefault"],[14,36,2,0],[14,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[14,73,2,0],[15,2,1,0],[17,2,4,7],[17,17,4,22,"migrateUserIdsToEmailBased"],[17,43,4,48,"migrateUserIdsToEmailBased"],[17,44,4,48],[17,46,4,51],[18,4,5,2,"console"],[18,11,5,9],[18,12,5,10,"log"],[18,15,5,13],[18,16,5,14],[18,50,5,48],[18,51,5,49],[19,4,7,2],[19,8,7,6],[20,6,8,4],[21,6,9,4],[21,12,9,10,"usersDbStr"],[21,22,9,20],[21,25,9,23],[21,31,9,29,"AsyncStorage"],[21,43,9,41],[21,44,9,41,"default"],[21,51,9,41],[21,52,9,42,"getItem"],[21,59,9,49],[21,60,9,50],[21,79,9,69],[21,80,9,70],[22,6,10,4],[22,10,10,8],[22,11,10,9,"usersDbStr"],[22,21,10,19],[22,23,10,21],[23,8,11,6,"console"],[23,15,11,13],[23,16,11,14,"log"],[23,19,11,17],[23,20,11,18],[23,48,11,46],[23,49,11,47],[24,8,12,6],[25,6,13,4],[26,6,15,4],[26,12,15,10,"usersDb"],[26,19,15,17],[26,22,15,20,"JSON"],[26,26,15,24],[26,27,15,25,"parse"],[26,32,15,30],[26,33,15,31,"usersDbStr"],[26,43,15,41],[26,44,15,42],[27,6,16,4],[27,12,16,10,"emails"],[27,18,16,16],[27,21,16,19,"Object"],[27,27,16,25],[27,28,16,26,"keys"],[27,32,16,30],[27,33,16,31,"usersDb"],[27,40,16,38],[27,41,16,39],[28,6,18,4,"console"],[28,13,18,11],[28,14,18,12,"log"],[28,17,18,15],[28,18,18,16],[28,30,18,28,"emails"],[28,36,18,34],[28,37,18,35,"length"],[28,43,18,41],[28,51,18,49],[28,52,18,50],[30,6,20,4],[31,6,21,4],[31,12,21,10,"jobsStr"],[31,19,21,17],[31,22,21,20],[31,28,21,26,"AsyncStorage"],[31,40,21,38],[31,41,21,38,"default"],[31,48,21,38],[31,49,21,39,"getItem"],[31,56,21,46],[31,57,21,47],[31,75,21,65],[31,76,21,66],[32,6,22,4],[32,12,22,10,"jobs"],[32,16,22,14],[32,19,22,17,"jobsStr"],[32,26,22,24],[32,29,22,27,"JSON"],[32,33,22,31],[32,34,22,32,"parse"],[32,39,22,37],[32,40,22,38,"jobsStr"],[32,47,22,45],[32,48,22,46],[32,51,22,49],[32,53,22,51],[33,6,24,4,"console"],[33,13,24,11],[33,14,24,12,"log"],[33,17,24,15],[33,18,24,16],[33,30,24,28,"jobs"],[33,34,24,32],[33,35,24,33,"length"],[33,41,24,39],[33,48,24,46],[33,49,24,47],[35,6,26,4],[36,6,27,4],[36,12,27,10,"appsStr"],[36,19,27,17],[36,22,27,20],[36,28,27,26,"AsyncStorage"],[36,40,27,38],[36,41,27,38,"default"],[36,48,27,38],[36,49,27,39,"getItem"],[36,56,27,46],[36,57,27,47],[36,83,27,73],[36,84,27,74],[37,6,28,4],[37,12,28,10,"applications"],[37,24,28,22],[37,27,28,25,"appsStr"],[37,34,28,32],[37,37,28,35,"JSON"],[37,41,28,39],[37,42,28,40,"parse"],[37,47,28,45],[37,48,28,46,"appsStr"],[37,55,28,53],[37,56,28,54],[37,59,28,57],[37,61,28,59],[38,6,30,4,"console"],[38,13,30,11],[38,14,30,12,"log"],[38,17,30,15],[38,18,30,16],[38,30,30,28,"applications"],[38,42,30,40],[38,43,30,41,"length"],[38,49,30,47],[38,64,30,62],[38,65,30,63],[40,6,32,4],[41,6,33,4],[41,12,33,10,"oldToNewIdMap"],[41,25,33,47],[41,28,33,50],[41,29,33,51],[41,30,33,52],[42,6,35,4],[42,11,35,9],[42,17,35,15,"email"],[42,22,35,20],[42,26,35,24,"emails"],[42,32,35,30],[42,34,35,32],[43,8,36,6],[43,14,36,12,"newId"],[43,19,36,17],[43,22,36,20],[43,30,36,28,"email"],[43,35,36,33],[43,36,36,34,"toLowerCase"],[43,47,36,45],[43,48,36,46],[43,49,36,47],[43,50,36,48,"replace"],[43,57,36,55],[43,58,36,56],[43,70,36,68],[43,72,36,70],[43,75,36,73],[43,76,36,74],[43,78,36,76],[45,8,38,6],[46,8,39,6],[46,14,39,12,"jobsForEmail"],[46,26,39,24],[46,29,39,27,"jobs"],[46,33,39,31],[46,34,39,32,"filter"],[46,40,39,38],[46,41,39,40,"j"],[46,42,39,46],[46,46,39,51,"j"],[46,47,39,52],[46,48,39,53,"employerId"],[46,58,39,63],[46,62,39,67,"j"],[46,63,39,68],[46,64,39,69,"employerId"],[46,74,39,79],[46,75,39,80,"includes"],[46,83,39,88],[46,84,39,89],[46,93,39,98],[46,94,39,99],[46,95,39,100],[47,8,41,6],[47,12,41,10,"jobsForEmail"],[47,24,41,22],[47,25,41,23,"length"],[47,31,41,29],[47,34,41,32],[47,35,41,33],[47,37,41,35],[48,10,42,8],[49,10,43,8],[49,16,43,14,"oldId"],[49,21,43,19],[49,24,43,22,"jobsForEmail"],[49,36,43,34],[49,37,43,35],[49,38,43,36],[49,39,43,37],[49,40,43,38,"employerId"],[49,50,43,48],[50,10,44,8,"oldToNewIdMap"],[50,23,44,21],[50,24,44,22,"oldId"],[50,29,44,27],[50,30,44,28],[50,33,44,31,"newId"],[50,38,44,36],[51,10,45,8,"console"],[51,17,45,15],[51,18,45,16,"log"],[51,21,45,19],[51,22,45,20],[51,37,45,35,"oldId"],[51,42,45,40],[51,48,45,46,"newId"],[51,53,45,51],[51,58,45,56,"email"],[51,63,45,61],[51,66,45,64],[51,67,45,65],[52,8,46,6],[53,6,47,4],[55,6,49,4],[56,6,50,4],[56,10,50,8,"jobsUpdated"],[56,21,50,19],[56,24,50,22],[56,29,50,27],[57,6,51,4],[57,12,51,10,"updatedJobs"],[57,23,51,21],[57,26,51,24,"jobs"],[57,30,51,28],[57,31,51,29,"map"],[57,34,51,32],[57,35,51,34,"job"],[57,38,51,42],[57,42,51,47],[58,8,52,6],[58,12,52,10,"job"],[58,15,52,13],[58,16,52,14,"employerId"],[58,26,52,24],[58,30,52,28,"oldToNewIdMap"],[58,43,52,41],[58,44,52,42,"job"],[58,47,52,45],[58,48,52,46,"employerId"],[58,58,52,56],[58,59,52,57],[58,61,52,59],[59,10,53,8,"console"],[59,17,53,15],[59,18,53,16,"log"],[59,21,53,19],[59,22,53,20],[59,41,53,39,"job"],[59,44,53,42],[59,45,53,43,"id"],[59,47,53,45],[59,52,53,50,"job"],[59,55,53,53],[59,56,53,54,"employerId"],[59,66,53,64],[59,72,53,70,"oldToNewIdMap"],[59,85,53,83],[59,86,53,84,"job"],[59,89,53,87],[59,90,53,88,"employerId"],[59,100,53,98],[59,101,53,99],[59,103,53,101],[59,104,53,102],[60,10,54,8,"jobsUpdated"],[60,21,54,19],[60,24,54,22],[60,28,54,26],[61,10,55,8],[61,17,55,8,"Object"],[61,23,55,8],[61,24,55,8,"assign"],[61,30,55,8],[61,35,55,20,"job"],[61,38,55,23],[62,12,55,25,"employerId"],[62,22,55,35],[62,24,55,37,"oldToNewIdMap"],[62,37,55,50],[62,38,55,51,"job"],[62,41,55,54],[62,42,55,55,"employerId"],[62,52,55,65],[63,10,55,66],[64,8,56,6],[65,8,57,6],[65,15,57,13,"job"],[65,18,57,16],[66,6,58,4],[66,7,58,5],[66,8,58,6],[67,6,60,4],[67,10,60,8,"jobsUpdated"],[67,21,60,19],[67,23,60,21],[68,8,61,6],[68,14,61,12,"AsyncStorage"],[68,26,61,24],[68,27,61,24,"default"],[68,34,61,24],[68,35,61,25,"setItem"],[68,42,61,32],[68,43,61,33],[68,61,61,51],[68,63,61,53,"JSON"],[68,67,61,57],[68,68,61,58,"stringify"],[68,77,61,67],[68,78,61,68,"updatedJobs"],[68,89,61,79],[68,90,61,80],[68,91,61,81],[69,8,62,6,"console"],[69,15,62,13],[69,16,62,14,"log"],[69,19,62,17],[69,20,62,18],[69,36,62,34],[69,37,62,35],[70,6,63,4],[72,6,65,4],[73,6,66,4],[73,12,66,10,"profileStr"],[73,22,66,20],[73,25,66,23],[73,31,66,29,"AsyncStorage"],[73,43,66,41],[73,44,66,41,"default"],[73,51,66,41],[73,52,66,42,"getItem"],[73,59,66,49],[73,60,66,50],[73,88,66,78],[73,89,66,79],[74,6,67,4],[74,10,67,8,"profileStr"],[74,20,67,18],[74,22,67,20],[75,8,68,6],[75,14,68,12,"profile"],[75,21,68,19],[75,24,68,22,"JSON"],[75,28,68,26],[75,29,68,27,"parse"],[75,34,68,32],[75,35,68,33,"profileStr"],[75,45,68,43],[75,46,68,44],[77,8,70,6],[78,8,71,6],[78,12,71,10,"profile"],[78,19,71,17],[78,20,71,18,"userId"],[78,26,71,24],[78,30,71,28,"profile"],[78,37,71,35],[78,38,71,36,"userId"],[78,44,71,42],[78,45,71,43,"includes"],[78,53,71,51],[78,54,71,52],[78,63,71,61],[78,64,71,62],[78,66,71,64],[79,10,72,8],[80,10,73,8],[80,16,73,14,"matchingEmail"],[80,29,73,27],[80,32,73,30,"emails"],[80,38,73,36],[80,39,73,37,"find"],[80,43,73,41],[80,44,73,42,"email"],[80,49,73,47],[80,53,73,51],[81,12,74,10],[81,18,74,16,"newId"],[81,23,74,21],[81,26,74,24],[81,34,74,32,"email"],[81,39,74,37],[81,40,74,38,"toLowerCase"],[81,51,74,49],[81,52,74,50],[81,53,74,51],[81,54,74,52,"replace"],[81,61,74,59],[81,62,74,60],[81,74,74,72],[81,76,74,74],[81,79,74,77],[81,80,74,78],[81,82,74,80],[82,12,75,10],[82,19,75,17,"usersDb"],[82,26,75,24],[82,27,75,25,"email"],[82,32,75,30],[82,33,75,31],[82,34,75,32,"role"],[82,38,75,36],[82,43,75,41],[82,51,75,49],[83,10,76,8],[83,11,76,9],[83,12,76,10],[84,10,78,8],[84,14,78,12,"matchingEmail"],[84,27,78,25],[84,29,78,27],[85,12,79,10],[85,18,79,16,"newId"],[85,23,79,21],[85,26,79,24],[85,34,79,32,"matchingEmail"],[85,47,79,45],[85,48,79,46,"toLowerCase"],[85,59,79,57],[85,60,79,58],[85,61,79,59],[85,62,79,60,"replace"],[85,69,79,67],[85,70,79,68],[85,82,79,80],[85,84,79,82],[85,87,79,85],[85,88,79,86],[85,90,79,88],[86,12,80,10,"profile"],[86,19,80,17],[86,20,80,18,"userId"],[86,26,80,24],[86,29,80,27,"newId"],[86,34,80,32],[87,12,81,10],[87,18,81,16,"AsyncStorage"],[87,30,81,28],[87,31,81,28,"default"],[87,38,81,28],[87,39,81,29,"setItem"],[87,46,81,36],[87,47,81,37],[87,75,81,65],[87,77,81,67,"JSON"],[87,81,81,71],[87,82,81,72,"stringify"],[87,91,81,81],[87,92,81,82,"profile"],[87,99,81,89],[87,100,81,90],[87,101,81,91],[88,12,82,10,"console"],[88,19,82,17],[88,20,82,18,"log"],[88,23,82,21],[88,24,82,22],[88,53,82,51,"newId"],[88,58,82,56],[88,60,82,58],[88,61,82,59],[89,10,83,8],[90,8,84,6],[91,6,85,4],[92,6,87,4,"console"],[92,13,87,11],[92,14,87,12,"log"],[92,17,87,15],[92,18,87,16],[92,41,87,39],[92,42,87,40],[93,6,88,4],[93,13,88,11],[94,8,88,13,"success"],[94,15,88,20],[94,17,88,22],[94,21,88,26],[95,8,88,28,"migratedCount"],[95,21,88,41],[95,23,88,43,"Object"],[95,29,88,49],[95,30,88,50,"keys"],[95,34,88,54],[95,35,88,55,"oldToNewIdMap"],[95,48,88,68],[95,49,88,69],[95,50,88,70,"length"],[96,6,88,77],[96,7,88,78],[97,4,90,2],[97,5,90,3],[97,6,90,4],[97,13,90,11,"error"],[97,18,90,16],[97,20,90,18],[98,6,91,4,"console"],[98,13,91,11],[98,14,91,12,"error"],[98,19,91,17],[98,20,91,18],[98,40,91,38],[98,42,91,40,"error"],[98,47,91,45],[98,48,91,46],[99,6,92,4],[99,13,92,11],[100,8,92,13,"success"],[100,15,92,20],[100,17,92,22],[100,22,92,27],[101,8,92,29,"error"],[102,6,92,35],[102,7,92,36],[103,4,93,2],[104,2,94,0],[105,0,94,1],[105,3]],"functionMap":{"names":["<global>","migrateUserIdsToEmailBased","jobs.filter$argument_0","jobs.map$argument_0","emails.find$argument_0"],"mappings":"AAA;OCG;uCCmC,4DD;iCEY;KFO;0CGe;SHG;CDkB"},"hasCjsExports":false},"type":"js/module"}]}